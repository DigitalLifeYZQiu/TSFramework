python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 21:15:21.310889: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 21:15:21.311409: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 21:15:21.313469: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 21:15:21.323245: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 21:15:22.851182: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0563
	speed: 0.020550s/iter; left time: 1955.758718s
	iters: 764, epoch: 1 | train_loss : 0.0029
	speed: 0.012534s/iter; left time: 1188.089884s
	iters: 1146, epoch: 1 | train_loss : 0.0037
	speed: 0.013598s/iter; left time: 1283.695875s
	iters: 1528, epoch: 1 | train_loss : 0.0060
	speed: 0.013477s/iter; left time: 1267.124992s
	iters: 1910, epoch: 1 | train_loss : 0.0009
	speed: 0.015039s/iter; left time: 1408.263337s
data: {'predict': array([163.30901661, 163.2693505 , 163.22021282, ..., 147.12479138,
       147.15052795, 147.17228042]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:19:47] [32mIntermediate result: 0.029946552589535713  (Index 0)[0m
Epoch: 1 | cost time: 256.298734664917 | valid_loss: 0.029946552589535713 | valid_loss_true: 1.7789234407012775
Pretest loss in this epoch: 5.244206917819738
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0013
	speed: 0.616158s/iter; left time: 57461.674623s
	iters: 764, epoch: 2 | train_loss : 0.0046
	speed: 0.015290s/iter; left time: 1420.034859s
	iters: 1146, epoch: 2 | train_loss : 0.0018
	speed: 0.014230s/iter; left time: 1316.150403s
	iters: 1528, epoch: 2 | train_loss : 0.0067
	speed: 0.013196s/iter; left time: 1215.488647s
	iters: 1910, epoch: 2 | train_loss : 0.0006
	speed: 0.014699s/iter; left time: 1348.339358s
data: {'predict': array([162.47040975, 162.43255729, 162.38568738, ..., 147.5212564 ,
       147.54526535, 147.56552714]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:24:45] [32mIntermediate result: 0.028383800759911537  (Index 1)[0m
Epoch: 2 | cost time: 297.7124922275543 | valid_loss: 0.028383800759911537 | valid_loss_true: 1.6045969794101314
Pretest loss in this epoch: 5.2200286774067335
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0010
	speed: 0.726543s/iter; left time: 66367.532678s
	iters: 764, epoch: 3 | train_loss : 0.0245
	speed: 0.018032s/iter; left time: 1640.240657s
	iters: 1146, epoch: 3 | train_loss : 0.0014
	speed: 0.016948s/iter; left time: 1535.245374s
	iters: 1528, epoch: 3 | train_loss : 0.0075
	speed: 0.016669s/iter; left time: 1503.576289s
	iters: 1910, epoch: 3 | train_loss : 0.0007
	speed: 0.017105s/iter; left time: 1536.392524s
data: {'predict': array([162.80730229, 162.76767003, 162.71883133, ..., 147.4802632 ,
       147.50446396, 147.52488792]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:28:49] [32mIntermediate result: 0.028838563710451126  (Index 2)[0m
Epoch: 3 | cost time: 244.10808181762695 | valid_loss: 0.028838563710451126 | valid_loss_true: 1.6383617510561588
Pretest loss in this epoch: 5.275214682423484
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0013
	speed: 0.566582s/iter; left time: 50672.834010s
	iters: 764, epoch: 4 | train_loss : 0.0011
	speed: 0.012580s/iter; left time: 1120.293232s
	iters: 1146, epoch: 4 | train_loss : 0.0012
	speed: 0.013123s/iter; left time: 1163.671145s
	iters: 1528, epoch: 4 | train_loss : 0.0028
	speed: 0.013078s/iter; left time: 1154.645040s
	iters: 1910, epoch: 4 | train_loss : 0.0025
	speed: 0.013768s/iter; left time: 1210.321415s
data: {'predict': array([162.69363208, 162.6549419 , 162.60747684, ..., 147.80989692,
       147.83327829, 147.85301967]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:33:09] [32mIntermediate result: 0.028649454936385155  (Index 3)[0m
Epoch: 4 | cost time: 259.7971839904785 | valid_loss: 0.028649454936385155 | valid_loss_true: 1.6115989795539385
Pretest loss in this epoch: 5.301006400666116
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0009
	speed: 0.628322s/iter; left time: 54993.912300s
	iters: 764, epoch: 5 | train_loss : 0.0015
	speed: 0.014537s/iter; left time: 1266.755795s
	iters: 1146, epoch: 5 | train_loss : 0.0325
	speed: 0.014667s/iter; left time: 1272.543986s
	iters: 1528, epoch: 5 | train_loss : 0.0059
	speed: 0.014739s/iter; left time: 1273.139896s
	iters: 1910, epoch: 5 | train_loss : 0.0056
	speed: 0.014908s/iter; left time: 1282.055122s
data: {'predict': array([162.10397989, 162.0637807 , 162.01470507, ..., 146.9966797 ,
       147.01998914, 147.03968117]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:37:15] [32mIntermediate result: 0.02922377735376358  (Index 4)[0m
Epoch: 5 | cost time: 246.08622121810913 | valid_loss: 0.02922377735376358 | valid_loss_true: 1.7089088515831987
Pretest loss in this epoch: 5.740192537683916
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0012
	speed: 0.582605s/iter; left time: 49879.102519s
	iters: 764, epoch: 6 | train_loss : 0.0097
	speed: 0.014196s/iter; left time: 1209.972957s
	iters: 1146, epoch: 6 | train_loss : 0.0093
	speed: 0.014138s/iter; left time: 1199.627161s
	iters: 1528, epoch: 6 | train_loss : 0.0007
	speed: 0.013114s/iter; left time: 1107.703693s
	iters: 1910, epoch: 6 | train_loss : 0.0011
	speed: 0.014174s/iter; left time: 1191.802175s
data: {'predict': array([162.38536583, 162.34600435, 162.29794131, ..., 147.38392841,
       147.4075185 , 147.42743335]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:40:50] [32mIntermediate result: 0.02845698967576027  (Index 5)[0m
Epoch: 6 | cost time: 215.27956676483154 | valid_loss: 0.02845698967576027 | valid_loss_true: 1.6207242130234192
Pretest loss in this epoch: 5.2113835987882045
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0020
	speed: 0.509263s/iter; left time: 42626.849713s
	iters: 764, epoch: 7 | train_loss : 0.0005
	speed: 0.012448s/iter; left time: 1037.155941s
	iters: 1146, epoch: 7 | train_loss : 0.0011
	speed: 0.013344s/iter; left time: 1106.718616s
	iters: 1528, epoch: 7 | train_loss : 0.0345
	speed: 0.012542s/iter; left time: 1035.445094s
	iters: 1910, epoch: 7 | train_loss : 0.0006
	speed: 0.012081s/iter; left time: 992.732855s
data: {'predict': array([162.65111435, 162.61398961, 162.5686823 , ..., 148.09354356,
       148.11702506, 148.13684542]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:44:36] [32mIntermediate result: 0.02891523577272892  (Index 6)[0m
Epoch: 7 | cost time: 225.74334120750427 | valid_loss: 0.02891523577272892 | valid_loss_true: 1.609404185155002
Pretest loss in this epoch: 5.156344256314971
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0017
	speed: 0.539231s/iter; left time: 44104.777982s
	iters: 764, epoch: 8 | train_loss : 0.0009
	speed: 0.013978s/iter; left time: 1137.959606s
	iters: 1146, epoch: 8 | train_loss : 0.0013
	speed: 0.014013s/iter; left time: 1135.423026s
	iters: 1528, epoch: 8 | train_loss : 0.0059
	speed: 0.013332s/iter; left time: 1075.145993s
	iters: 1910, epoch: 8 | train_loss : 0.0014
	speed: 0.013811s/iter; left time: 1108.516264s
data: {'predict': array([162.27324131, 162.23415061, 162.18666298, ..., 147.40345261,
       147.42686782, 147.446636  ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:48:37] [32mIntermediate result: 0.028462834656238556  (Index 7)[0m
Epoch: 8 | cost time: 241.40231704711914 | valid_loss: 0.028462834656238556 | valid_loss_true: 1.6241478644653145
Pretest loss in this epoch: 5.135957068846171
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0007
	speed: 0.577716s/iter; left time: 46148.565831s
	iters: 764, epoch: 9 | train_loss : 0.0014
	speed: 0.015251s/iter; left time: 1212.461271s
	iters: 1146, epoch: 9 | train_loss : 0.0008
	speed: 0.013831s/iter; left time: 1094.281749s
	iters: 1528, epoch: 9 | train_loss : 0.0008
	speed: 0.014543s/iter; left time: 1145.065735s
	iters: 1910, epoch: 9 | train_loss : 0.0017
	speed: 0.014021s/iter; left time: 1098.580396s
data: {'predict': array([162.49520565, 162.45507415, 162.40643007, ..., 147.39798629,
       147.42161023, 147.44155046]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:52:33] [32mIntermediate result: 0.028509927913546562  (Index 8)[0m
Epoch: 9 | cost time: 236.05310440063477 | valid_loss: 0.028509927913546562 | valid_loss_true: 1.6209423088516057
Pretest loss in this epoch: 5.127478587591761
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0049
	speed: 0.559924s/iter; left time: 43657.292887s
	iters: 764, epoch: 10 | train_loss : 0.0047
	speed: 0.013596s/iter; left time: 1054.903385s
	iters: 1146, epoch: 10 | train_loss : 0.0011
	speed: 0.015585s/iter; left time: 1203.278397s
	iters: 1528, epoch: 10 | train_loss : 0.0013
	speed: 0.015267s/iter; left time: 1172.901699s
	iters: 1910, epoch: 10 | train_loss : 0.0013
	speed: 0.015237s/iter; left time: 1164.756819s
data: {'predict': array([162.36154021, 162.32271747, 162.27575165, ..., 147.59925165,
       147.62252865, 147.64217978]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:56:21] [32mIntermediate result: 0.028320573270320892  (Index 9)[0m
Epoch: 10 | cost time: 227.83703589439392 | valid_loss: 0.028320573270320892 | valid_loss_true: 1.6039000138767092
Pretest loss in this epoch: 5.197584636142205
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0032
	speed: 0.538285s/iter; left time: 40941.411754s
	iters: 764, epoch: 11 | train_loss : 0.0030
	speed: 0.015628s/iter; left time: 1182.668411s
	iters: 1146, epoch: 11 | train_loss : 0.0016
	speed: 0.014841s/iter; left time: 1117.460648s
	iters: 1528, epoch: 11 | train_loss : 0.0006
	speed: 0.017470s/iter; left time: 1308.743739s
	iters: 1910, epoch: 11 | train_loss : 0.0013
	speed: 0.016133s/iter; left time: 1202.438773s
data: {'predict': array([161.8625111 , 161.82306218, 161.77544762, ..., 147.02133034,
       147.04459183, 147.06422885]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:01:12] [32mIntermediate result: 0.029762862250208855  (Index 10)[0m
Epoch: 11 | cost time: 290.9327118396759 | valid_loss: 0.029762862250208855 | valid_loss_true: 1.738890060459442
Pretest loss in this epoch: 5.1687944911666115
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0033
	speed: 0.698004s/iter; left time: 51755.564253s
	iters: 764, epoch: 12 | train_loss : 0.0163
	speed: 0.013995s/iter; left time: 1032.378251s
	iters: 1146, epoch: 12 | train_loss : 0.0014
	speed: 0.014442s/iter; left time: 1059.819292s
	iters: 1528, epoch: 12 | train_loss : 0.0008
	speed: 0.015366s/iter; left time: 1121.780947s
	iters: 1910, epoch: 12 | train_loss : 0.0007
	speed: 0.014207s/iter; left time: 1031.720354s
data: {'predict': array([162.18586757, 162.14634814, 162.09875614, ..., 147.35073417,
       147.37388143, 147.39342819]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:06:31] [32mIntermediate result: 0.028615256771445274  (Index 11)[0m
Epoch: 12 | cost time: 318.8776259422302 | valid_loss: 0.028615256771445274 | valid_loss_true: 1.6427144964687252
Pretest loss in this epoch: 5.145219351853577
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0011
	speed: 0.780244s/iter; left time: 56362.484001s
	iters: 764, epoch: 13 | train_loss : 0.0051
	speed: 0.016983s/iter; left time: 1220.346008s
	iters: 1146, epoch: 13 | train_loss : 0.0008
	speed: 0.018985s/iter; left time: 1356.888003s
	iters: 1528, epoch: 13 | train_loss : 0.0007
	speed: 0.017950s/iter; left time: 1276.076258s
	iters: 1910, epoch: 13 | train_loss : 0.0015
	speed: 0.017241s/iter; left time: 1219.105070s
data: {'predict': array([161.84653522, 161.80697912, 161.75942661, ..., 147.04923454,
       147.07229718, 147.09177484]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:12:17] [32mIntermediate result: 0.02981165237724781  (Index 12)[0m
Epoch: 13 | cost time: 346.2026615142822 | valid_loss: 0.02981165237724781 | valid_loss_true: 1.7436420614888075
Pretest loss in this epoch: 5.173578010212027
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0048
	speed: 0.831685s/iter; left time: 58489.065181s
	iters: 764, epoch: 14 | train_loss : 0.0005
	speed: 0.014857s/iter; left time: 1039.179972s
	iters: 1146, epoch: 14 | train_loss : 0.0127
	speed: 0.013956s/iter; left time: 970.811226s
	iters: 1528, epoch: 14 | train_loss : 0.0010
	speed: 0.012557s/iter; left time: 868.679772s
	iters: 1910, epoch: 14 | train_loss : 0.0023
	speed: 0.015142s/iter; left time: 1041.719747s
data: {'predict': array([162.28229826, 162.2423501 , 162.19434912, ..., 147.33821212,
       147.361554  , 147.38126153]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:16:01] [32mIntermediate result: 0.028603894636034966  (Index 13)[0m
Epoch: 14 | cost time: 223.90289545059204 | valid_loss: 0.028603894636034966 | valid_loss_true: 1.6337881777295205
Pretest loss in this epoch: 5.125509265659641
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0009
	speed: 0.526041s/iter; left time: 35989.103704s
	iters: 764, epoch: 15 | train_loss : 0.0238
	speed: 0.012315s/iter; left time: 837.796369s
	iters: 1146, epoch: 15 | train_loss : 0.0027
	speed: 0.013171s/iter; left time: 891.013883s
	iters: 1528, epoch: 15 | train_loss : 0.0191
	speed: 0.011437s/iter; left time: 769.347015s
	iters: 1910, epoch: 15 | train_loss : 0.0093
	speed: 0.012913s/iter; left time: 863.698758s
data: {'predict': array([162.35369048, 162.31507928, 162.26878194, ..., 147.77637549,
       147.79922095, 147.81851808]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:20:02] [32mIntermediate result: 0.028261732310056686  (Index 14)[0m
Epoch: 15 | cost time: 240.89213919639587 | valid_loss: 0.028261732310056686 | valid_loss_true: 1.5940566852193947
Pretest loss in this epoch: 5.148737099056469
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0114
	speed: 0.582218s/iter; left time: 38719.798753s
	iters: 764, epoch: 16 | train_loss : 0.0040
	speed: 0.014084s/iter; left time: 931.279597s
	iters: 1146, epoch: 16 | train_loss : 0.0007
	speed: 0.013298s/iter; left time: 874.193433s
	iters: 1528, epoch: 16 | train_loss : 0.0018
	speed: 0.012099s/iter; left time: 790.764699s
	iters: 1910, epoch: 16 | train_loss : 0.0012
	speed: 0.011508s/iter; left time: 747.744811s
data: {'predict': array([162.49430588, 162.45473286, 162.40731856, ..., 147.66632412,
       147.68947561, 147.70901955]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:23:42] [32mIntermediate result: 0.028420012444257736  (Index 15)[0m
Epoch: 16 | cost time: 220.2422215938568 | valid_loss: 0.028420012444257736 | valid_loss_true: 1.6033384865729348
Pretest loss in this epoch: 5.251208614635553
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0023
	speed: 0.524283s/iter; left time: 33865.009420s
	iters: 764, epoch: 17 | train_loss : 0.0014
	speed: 0.012138s/iter; left time: 779.385004s
	iters: 1146, epoch: 17 | train_loss : 0.0007
	speed: 0.012203s/iter; left time: 778.883096s
	iters: 1528, epoch: 17 | train_loss : 0.0067
	speed: 0.011601s/iter; left time: 736.047178s
	iters: 1910, epoch: 17 | train_loss : 0.0086
	speed: 0.012098s/iter; left time: 762.981605s
data: {'predict': array([162.44461254, 162.40474899, 162.35704418, ..., 147.57279159,
       147.59594167, 147.61548703]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:27:47] [32mIntermediate result: 0.028414083644747734  (Index 16)[0m
Epoch: 17 | cost time: 244.34049320220947 | valid_loss: 0.028414083644747734 | valid_loss_true: 1.6091640402842682
Pretest loss in this epoch: 5.255693930287215
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0019
	speed: 0.594298s/iter; left time: 37251.787869s
	iters: 764, epoch: 18 | train_loss : 0.0136
	speed: 0.013677s/iter; left time: 852.092171s
	iters: 1146, epoch: 18 | train_loss : 0.0036
	speed: 0.013680s/iter; left time: 847.049328s
	iters: 1528, epoch: 18 | train_loss : 0.0045
	speed: 0.013473s/iter; left time: 829.094934s
	iters: 1910, epoch: 18 | train_loss : 0.0040
	speed: 0.013868s/iter; left time: 848.112367s
data: {'predict': array([162.16899192, 162.13045687, 162.0843598 , ..., 147.63563881,
       147.65846875, 147.6777405 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:31:49] [32mIntermediate result: 0.028325211256742477  (Index 17)[0m
Epoch: 18 | cost time: 242.1813714504242 | valid_loss: 0.028325211256742477 | valid_loss_true: 1.6117837434830216
Pretest loss in this epoch: 5.116646905482145
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.1052
	speed: 0.578730s/iter; left time: 35169.981881s
	iters: 764, epoch: 19 | train_loss : 0.0005
	speed: 0.015967s/iter; left time: 964.234116s
	iters: 1146, epoch: 19 | train_loss : 0.0078
	speed: 0.015354s/iter; left time: 921.358254s
	iters: 1528, epoch: 19 | train_loss : 0.0005
	speed: 0.014932s/iter; left time: 890.324978s
	iters: 1910, epoch: 19 | train_loss : 0.0079
	speed: 0.014308s/iter; left time: 847.638460s
data: {'predict': array([162.11622976, 162.07755369, 162.03130994, ..., 147.56264448,
       147.5854843 , 147.60476451]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:37:02] [32mIntermediate result: 0.028430825099349022  (Index 18)[0m
Epoch: 19 | cost time: 312.75165486335754 | valid_loss: 0.028430825099349022 | valid_loss_true: 1.6239115966512787
Pretest loss in this epoch: 5.201381287611423
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0013
	speed: 0.763089s/iter; left time: 44915.430236s
	iters: 764, epoch: 20 | train_loss : 0.0007
	speed: 0.019796s/iter; left time: 1157.649874s
	iters: 1146, epoch: 20 | train_loss : 0.0006
	speed: 0.020810s/iter; left time: 1208.989251s
	iters: 1528, epoch: 20 | train_loss : 0.0004
	speed: 0.018067s/iter; left time: 1042.712883s
	iters: 1910, epoch: 20 | train_loss : 0.0008
	speed: 0.018411s/iter; left time: 1055.552927s
data: {'predict': array([162.0884948 , 162.04936461, 162.00261033, ..., 147.42430672,
       147.44727346, 147.46665522]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:42:12] [32mIntermediate result: 0.028656700626015663  (Index 19)[0m
Epoch: 20 | cost time: 310.5158061981201 | valid_loss: 0.028656700626015663 | valid_loss_true: 1.6420988954707956
Pretest loss in this epoch: 5.103844214829481
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0014
	speed: 0.734637s/iter; left time: 41836.821801s
	iters: 764, epoch: 21 | train_loss : 0.0007
	speed: 0.018154s/iter; left time: 1026.931058s
	iters: 1146, epoch: 21 | train_loss : 0.0023
	speed: 0.018747s/iter; left time: 1053.325803s
	iters: 1528, epoch: 21 | train_loss : 0.0032
	speed: 0.018867s/iter; left time: 1052.834309s
	iters: 1910, epoch: 21 | train_loss : 0.0005
	speed: 0.018788s/iter; left time: 1041.263518s
data: {'predict': array([162.08664448, 162.04827867, 162.00248904, ..., 147.64450818,
       147.66712235, 147.68622205]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:48:08] [32mIntermediate result: 0.028369193896651268  (Index 20)[0m
Epoch: 21 | cost time: 356.06281566619873 | valid_loss: 0.028369193896651268 | valid_loss_true: 1.6205689701157044
Pretest loss in this epoch: 5.119475171073161
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0038
	speed: 0.857066s/iter; left time: 47171.202888s
	iters: 764, epoch: 22 | train_loss : 0.0016
	speed: 0.016457s/iter; left time: 899.471593s
	iters: 1146, epoch: 22 | train_loss : 0.0005
	speed: 0.016026s/iter; left time: 869.811693s
	iters: 1528, epoch: 22 | train_loss : 0.0030
	speed: 0.016284s/iter; left time: 877.585411s
	iters: 1910, epoch: 22 | train_loss : 0.0005
	speed: 0.016475s/iter; left time: 881.577968s
data: {'predict': array([162.14095797, 162.10131725, 162.05398757, ..., 147.3567759 ,
       147.37987521, 147.3993712 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:52:42] [32mIntermediate result: 0.02872411534190178  (Index 21)[0m
Epoch: 22 | cost time: 274.16496872901917 | valid_loss: 0.02872411534190178 | valid_loss_true: 1.6441503444860244
Pretest loss in this epoch: 5.113580112829374
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0009
	speed: 0.649965s/iter; left time: 34530.669189s
	iters: 764, epoch: 23 | train_loss : 0.0017
	speed: 0.014595s/iter; left time: 769.805962s
	iters: 1146, epoch: 23 | train_loss : 0.0029
	speed: 0.015908s/iter; left time: 833.013173s
	iters: 1528, epoch: 23 | train_loss : 0.0021
	speed: 0.014563s/iter; left time: 757.019646s
	iters: 1910, epoch: 23 | train_loss : 0.0008
	speed: 0.015733s/iter; left time: 811.811086s
data: {'predict': array([162.33135979, 162.29146521, 162.24387604, ..., 147.48562234,
       147.50874704, 147.52826559]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:57:22] [32mIntermediate result: 0.02846679463982582  (Index 22)[0m
Epoch: 23 | cost time: 279.7207531929016 | valid_loss: 0.02846679463982582 | valid_loss_true: 1.6175603345272385
Pretest loss in this epoch: 5.103530094002568
Early stop with best valid_loss: 0.02846679463982582
[2024-03-06 22:57:22] [32mFinal result: 0.028261732310056686[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 22:57:30.984232: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 22:57:30.984842: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 22:57:31.001280: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 22:57:31.012375: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 22:57:32.739763: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0091
	speed: 0.022509s/iter; left time: 2142.162888s
	iters: 764, epoch: 1 | train_loss : 0.0099
	speed: 0.015168s/iter; left time: 1437.765743s
	iters: 1146, epoch: 1 | train_loss : 0.0090
	speed: 0.011808s/iter; left time: 1114.751297s
	iters: 1528, epoch: 1 | train_loss : 0.0066
	speed: 0.013088s/iter; left time: 1230.580102s
	iters: 1910, epoch: 1 | train_loss : 0.0097
	speed: 0.012478s/iter; left time: 1168.488419s
data: {'predict': array([0.54959593, 0.54840909, 0.54702368, ..., 0.34469076, 0.34493691,
       0.3451662 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:02:08] [32mIntermediate result: 0.10832197219133377  (Index 0)[0m
Epoch: 1 | cost time: 265.9631485939026 | valid_loss: 0.10832197219133377 | valid_loss_true: 0.024929187411024456
Pretest loss in this epoch: 0.03794723074416356
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0064
	speed: 0.641701s/iter; left time: 59843.777226s
	iters: 764, epoch: 2 | train_loss : 0.0076
	speed: 0.013640s/iter; left time: 1266.790608s
	iters: 1146, epoch: 2 | train_loss : 0.0066
	speed: 0.013119s/iter; left time: 1213.383277s
	iters: 1528, epoch: 2 | train_loss : 0.0092
	speed: 0.014199s/iter; left time: 1307.880616s
	iters: 1910, epoch: 2 | train_loss : 0.0065
	speed: 0.014152s/iter; left time: 1298.126041s
data: {'predict': array([0.54500905, 0.54376854, 0.54231845, ..., 0.33565372, 0.3358998 ,
       0.33612686]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:06:02] [32mIntermediate result: 0.10751615464687347  (Index 1)[0m
Epoch: 2 | cost time: 233.89795923233032 | valid_loss: 0.10751615464687347 | valid_loss_true: 0.025357968626743436
Pretest loss in this epoch: 0.03823163846687639
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0074
	speed: 0.560210s/iter; left time: 51173.492052s
	iters: 764, epoch: 3 | train_loss : 0.0134
	speed: 0.013658s/iter; left time: 1242.431358s
	iters: 1146, epoch: 3 | train_loss : 0.0148
	speed: 0.011999s/iter; left time: 1086.937286s
	iters: 1528, epoch: 3 | train_loss : 0.0178
	speed: 0.012941s/iter; left time: 1167.295620s
	iters: 1910, epoch: 3 | train_loss : 0.0103
	speed: 0.013674s/iter; left time: 1228.221348s
data: {'predict': array([0.55230933, 0.55107703, 0.54963135, ..., 0.33884304, 0.33910093,
       0.3393368 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:09:44] [32mIntermediate result: 0.10965139418840408  (Index 2)[0m
Epoch: 3 | cost time: 221.6644253730774 | valid_loss: 0.10965139418840408 | valid_loss_true: 0.025493159776825994
Pretest loss in this epoch: 0.03884194754250486
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0098
	speed: 0.524259s/iter; left time: 46887.595709s
	iters: 764, epoch: 4 | train_loss : 0.0064
	speed: 0.011868s/iter; left time: 1056.879924s
	iters: 1146, epoch: 4 | train_loss : 0.0112
	speed: 0.011532s/iter; left time: 1022.521637s
	iters: 1528, epoch: 4 | train_loss : 0.0068
	speed: 0.011573s/iter; left time: 1021.812030s
	iters: 1910, epoch: 4 | train_loss : 0.0192
	speed: 0.011512s/iter; left time: 1011.962870s
data: {'predict': array([0.53629029, 0.53511801, 0.53374612, ..., 0.33886233, 0.3391018 ,
       0.33932298]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:13:12] [32mIntermediate result: 0.10844343155622482  (Index 3)[0m
Epoch: 4 | cost time: 208.10034823417664 | valid_loss: 0.10844343155622482 | valid_loss_true: 0.0258259665574086
Pretest loss in this epoch: 0.0381874039501186
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0061
	speed: 0.500097s/iter; left time: 43770.951809s
	iters: 764, epoch: 5 | train_loss : 0.0123
	speed: 0.012869s/iter; left time: 1121.455814s
	iters: 1146, epoch: 5 | train_loss : 0.0101
	speed: 0.012730s/iter; left time: 1104.481601s
	iters: 1528, epoch: 5 | train_loss : 0.0089
	speed: 0.011658s/iter; left time: 1007.022077s
	iters: 1910, epoch: 5 | train_loss : 0.0185
	speed: 0.012246s/iter; left time: 1053.133610s
data: {'predict': array([0.54592187, 0.54478664, 0.54344715, ..., 0.33551894, 0.33579903,
       0.33605227]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:17:03] [32mIntermediate result: 0.10695429146289825  (Index 4)[0m
Epoch: 5 | cost time: 231.17342925071716 | valid_loss: 0.10695429146289825 | valid_loss_true: 0.02474998633033693
Pretest loss in this epoch: 0.03769883064712409
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0132
	speed: 0.554763s/iter; left time: 47495.446143s
	iters: 764, epoch: 6 | train_loss : 0.0101
	speed: 0.012748s/iter; left time: 1086.518801s
	iters: 1146, epoch: 6 | train_loss : 0.0086
	speed: 0.012364s/iter; left time: 1049.103452s
	iters: 1528, epoch: 6 | train_loss : 0.0073
	speed: 0.012733s/iter; left time: 1075.551139s
	iters: 1910, epoch: 6 | train_loss : 0.0114
	speed: 0.012235s/iter; left time: 1028.773149s
data: {'predict': array([0.53880144, 0.5376703 , 0.53633809, ..., 0.335715  , 0.3359819 ,
       0.33622509]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:22:44] [32mIntermediate result: 0.10636508464813232  (Index 5)[0m
Epoch: 6 | cost time: 341.16513681411743 | valid_loss: 0.10636508464813232 | valid_loss_true: 0.02493997119477117
Pretest loss in this epoch: 0.03794824134403918
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0081
	speed: 0.853364s/iter; left time: 71429.116874s
	iters: 764, epoch: 7 | train_loss : 0.0073
	speed: 0.020246s/iter; left time: 1686.883128s
	iters: 1146, epoch: 7 | train_loss : 0.0059
	speed: 0.018909s/iter; left time: 1568.322227s
	iters: 1528, epoch: 7 | train_loss : 0.0260
	speed: 0.020923s/iter; left time: 1727.379610s
	iters: 1910, epoch: 7 | train_loss : 0.0078
	speed: 0.020607s/iter; left time: 1693.381835s
data: {'predict': array([0.5378732 , 0.53671458, 0.5353532 , ..., 0.33895304, 0.33920684,
       0.33943993]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:27:45] [32mIntermediate result: 0.10695148259401321  (Index 6)[0m
Epoch: 7 | cost time: 300.4766845703125 | valid_loss: 0.10695148259401321 | valid_loss_true: 0.02524090697196979
Pretest loss in this epoch: 0.037880512627543286
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0087
	speed: 0.698018s/iter; left time: 57092.286552s
	iters: 764, epoch: 8 | train_loss : 0.0094
	speed: 0.013963s/iter; left time: 1136.740406s
	iters: 1146, epoch: 8 | train_loss : 0.0099
	speed: 0.015337s/iter; left time: 1242.734252s
	iters: 1528, epoch: 8 | train_loss : 0.0180
	speed: 0.015538s/iter; left time: 1253.065845s
	iters: 1910, epoch: 8 | train_loss : 0.0107
	speed: 0.015255s/iter; left time: 1224.461531s
data: {'predict': array([0.5404328 , 0.53927461, 0.53791014, ..., 0.33710477, 0.33737157,
       0.33761516]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:32:28] [32mIntermediate result: 0.10623680055141449  (Index 7)[0m
Epoch: 8 | cost time: 283.9071011543274 | valid_loss: 0.10623680055141449 | valid_loss_true: 0.024885251007596556
Pretest loss in this epoch: 0.03743543780725589
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0071
	speed: 0.687374s/iter; left time: 54908.100320s
	iters: 764, epoch: 9 | train_loss : 0.0144
	speed: 0.017053s/iter; left time: 1355.730482s
	iters: 1146, epoch: 9 | train_loss : 0.0056
	speed: 0.016368s/iter; left time: 1295.002585s
	iters: 1528, epoch: 9 | train_loss : 0.0072
	speed: 0.017566s/iter; left time: 1383.059254s
	iters: 1910, epoch: 9 | train_loss : 0.0143
	speed: 0.017621s/iter; left time: 1380.648806s
data: {'predict': array([0.5403505 , 0.53917229, 0.53778393, ..., 0.33539701, 0.33565562,
       0.33589233]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:37:13] [32mIntermediate result: 0.10707562416791916  (Index 8)[0m
Epoch: 9 | cost time: 285.03590154647827 | valid_loss: 0.10707562416791916 | valid_loss_true: 0.02515512729178014
Pretest loss in this epoch: 0.03907349581390674
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0062
	speed: 0.671286s/iter; left time: 52340.140806s
	iters: 764, epoch: 10 | train_loss : 0.0072
	speed: 0.012327s/iter; left time: 956.413725s
	iters: 1146, epoch: 10 | train_loss : 0.0087
	speed: 0.012758s/iter; left time: 984.998416s
	iters: 1528, epoch: 10 | train_loss : 0.0074
	speed: 0.013452s/iter; left time: 1033.444601s
	iters: 1910, epoch: 10 | train_loss : 0.0106
	speed: 0.013450s/iter; left time: 1028.133377s
data: {'predict': array([0.53483688, 0.53373249, 0.53243072, ..., 0.33888358, 0.33914312,
       0.33938137]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:41:02] [32mIntermediate result: 0.1074024960398674  (Index 9)[0m
Epoch: 10 | cost time: 228.14363932609558 | valid_loss: 0.1074024960398674 | valid_loss_true: 0.025452992650665515
Pretest loss in this epoch: 0.037566404691272474
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0288
	speed: 0.546099s/iter; left time: 41535.714263s
	iters: 764, epoch: 11 | train_loss : 0.0114
	speed: 0.013251s/iter; left time: 1002.787287s
	iters: 1146, epoch: 11 | train_loss : 0.0058
	speed: 0.011714s/iter; left time: 881.984838s
	iters: 1528, epoch: 11 | train_loss : 0.0058
	speed: 0.011897s/iter; left time: 891.225259s
	iters: 1910, epoch: 11 | train_loss : 0.0217
	speed: 0.012195s/iter; left time: 908.921164s
data: {'predict': array([0.53889931, 0.53779468, 0.53648957, ..., 0.33908039, 0.33934372,
       0.33958479]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:44:42] [32mIntermediate result: 0.10581741482019424  (Index 10)[0m
Epoch: 11 | cost time: 220.68819499015808 | valid_loss: 0.10581741482019424 | valid_loss_true: 0.024761203532886772
Pretest loss in this epoch: 0.03749181659804856
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0213
	speed: 0.528297s/iter; left time: 39172.185154s
	iters: 764, epoch: 12 | train_loss : 0.0712
	speed: 0.013518s/iter; left time: 997.159315s
	iters: 1146, epoch: 12 | train_loss : 0.0127
	speed: 0.011624s/iter; left time: 853.041985s
	iters: 1528, epoch: 12 | train_loss : 0.0056
	speed: 0.011871s/iter; left time: 866.611589s
	iters: 1910, epoch: 12 | train_loss : 0.0073
	speed: 0.012419s/iter; left time: 901.854434s
data: {'predict': array([0.54069513, 0.53956961, 0.53823961, ..., 0.33853836, 0.33880554,
       0.33905002]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:47:58] [32mIntermediate result: 0.10583213716745377  (Index 11)[0m
Epoch: 12 | cost time: 195.58305764198303 | valid_loss: 0.10583213716745377 | valid_loss_true: 0.024723292166160017
Pretest loss in this epoch: 0.037619417363456205
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0131
	speed: 0.463108s/iter; left time: 33453.544522s
	iters: 764, epoch: 13 | train_loss : 0.0108
	speed: 0.012236s/iter; left time: 879.199015s
	iters: 1146, epoch: 13 | train_loss : 0.0063
	speed: 0.013533s/iter; left time: 967.274571s
	iters: 1528, epoch: 13 | train_loss : 0.0085
	speed: 0.013152s/iter; left time: 935.021145s
	iters: 1910, epoch: 13 | train_loss : 0.0165
	speed: 0.014064s/iter; left time: 994.472024s
data: {'predict': array([0.53995669, 0.53882466, 0.53748711, ..., 0.33807565, 0.33833967,
       0.33858157]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:51:51] [32mIntermediate result: 0.10611900687217712  (Index 12)[0m
Epoch: 13 | cost time: 232.65433263778687 | valid_loss: 0.10611900687217712 | valid_loss_true: 0.024856798250023012
Pretest loss in this epoch: 0.03727901371144195
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0115
	speed: 0.555893s/iter; left time: 39093.737211s
	iters: 764, epoch: 14 | train_loss : 0.0069
	speed: 0.011920s/iter; left time: 833.745113s
	iters: 1146, epoch: 14 | train_loss : 0.0386
	speed: 0.013956s/iter; left time: 970.820951s
	iters: 1528, epoch: 14 | train_loss : 0.0153
	speed: 0.012258s/iter; left time: 848.011360s
	iters: 1910, epoch: 14 | train_loss : 0.0105
	speed: 0.010951s/iter; left time: 753.431269s
data: {'predict': array([0.54356039, 0.54238224, 0.54099015, ..., 0.33672647, 0.33699419,
       0.33723905]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:55:29] [32mIntermediate result: 0.1064545139670372  (Index 13)[0m
Epoch: 14 | cost time: 218.3139991760254 | valid_loss: 0.1064545139670372 | valid_loss_true: 0.024877112582393363
Pretest loss in this epoch: 0.03738996461060283
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0099
	speed: 0.519623s/iter; left time: 35550.039781s
	iters: 764, epoch: 15 | train_loss : 0.0211
	speed: 0.011440s/iter; left time: 778.331276s
	iters: 1146, epoch: 15 | train_loss : 0.0082
	speed: 0.012079s/iter; left time: 817.187748s
	iters: 1528, epoch: 15 | train_loss : 0.0123
	speed: 0.012697s/iter; left time: 854.127813s
	iters: 1910, epoch: 15 | train_loss : 0.0202
	speed: 0.010696s/iter; left time: 715.447428s
data: {'predict': array([0.54257853, 0.54142072, 0.54005314, ..., 0.33986562, 0.34012689,
       0.34036683]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 23:58:51] [32mIntermediate result: 0.10600096732378006  (Index 14)[0m
Epoch: 15 | cost time: 202.49862432479858 | valid_loss: 0.10600096732378006 | valid_loss_true: 0.0247738186856787
Pretest loss in this epoch: 0.03733301381028626
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0296
	speed: 0.484814s/iter; left time: 32242.050648s
	iters: 764, epoch: 16 | train_loss : 0.0370
	speed: 0.012693s/iter; left time: 839.259892s
	iters: 1146, epoch: 16 | train_loss : 0.0069
	speed: 0.011569s/iter; left time: 760.521280s
	iters: 1528, epoch: 16 | train_loss : 0.0074
	speed: 0.011484s/iter; left time: 750.603176s
	iters: 1910, epoch: 16 | train_loss : 0.0085
	speed: 0.012605s/iter; left time: 819.038899s
data: {'predict': array([0.54408984, 0.54293442, 0.54156728, ..., 0.33774447, 0.33801421,
       0.33826092]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 00:02:41] [32mIntermediate result: 0.10621610283851624  (Index 15)[0m
Epoch: 16 | cost time: 229.20198845863342 | valid_loss: 0.10621610283851624 | valid_loss_true: 0.024753937347924623
Pretest loss in this epoch: 0.037338571231371416
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0232
	speed: 0.551669s/iter; left time: 35633.982991s
	iters: 764, epoch: 17 | train_loss : 0.0080
	speed: 0.012190s/iter; left time: 782.721505s
	iters: 1146, epoch: 17 | train_loss : 0.0055
	speed: 0.011747s/iter; left time: 749.775606s
	iters: 1528, epoch: 17 | train_loss : 0.0091
	speed: 0.012356s/iter; left time: 783.923756s
	iters: 1910, epoch: 17 | train_loss : 0.0053
	speed: 0.013333s/iter; left time: 840.825677s
data: {'predict': array([0.54607766, 0.54489194, 0.54349041, ..., 0.33955994, 0.33982487,
       0.34006784]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 00:07:00] [32mIntermediate result: 0.10657592862844467  (Index 16)[0m
Epoch: 17 | cost time: 259.0391263961792 | valid_loss: 0.10657592862844467 | valid_loss_true: 0.02486362466435972
Pretest loss in this epoch: 0.03755167519246417
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0192
	speed: 0.636379s/iter; left time: 39889.534246s
	iters: 764, epoch: 18 | train_loss : 0.0374
	speed: 0.020062s/iter; left time: 1249.854378s
	iters: 1146, epoch: 18 | train_loss : 0.0087
	speed: 0.024984s/iter; left time: 1546.965819s
	iters: 1528, epoch: 18 | train_loss : 0.0142
	speed: 0.017451s/iter; left time: 1073.886695s
	iters: 1910, epoch: 18 | train_loss : 0.0115
	speed: 0.017106s/iter; left time: 1046.120289s
data: {'predict': array([0.53896786, 0.53784643, 0.53652032, ..., 0.33912408, 0.33938498,
       0.33962487]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 00:12:39] [32mIntermediate result: 0.10624847561120987  (Index 17)[0m
Epoch: 18 | cost time: 338.8985719680786 | valid_loss: 0.10624847561120987 | valid_loss_true: 0.024948020240180085
Pretest loss in this epoch: 0.03724280687819702
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0125
	speed: 0.811059s/iter; left time: 49288.851126s
	iters: 764, epoch: 19 | train_loss : 0.0078
	speed: 0.018274s/iter; left time: 1103.523306s
	iters: 1146, epoch: 19 | train_loss : 0.0127
	speed: 0.016645s/iter; left time: 998.816754s
	iters: 1528, epoch: 19 | train_loss : 0.0075
	speed: 0.015729s/iter; left time: 937.842172s
	iters: 1910, epoch: 19 | train_loss : 0.0503
	speed: 0.018353s/iter; left time: 1087.261102s
data: {'predict': array([0.54218159, 0.54103889, 0.53968658, ..., 0.33814594, 0.33841077,
       0.33865373]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 00:17:13] [32mIntermediate result: 0.1060539036989212  (Index 18)[0m
Epoch: 19 | cost time: 273.9900093078613 | valid_loss: 0.1060539036989212 | valid_loss_true: 0.024782198613994822
Pretest loss in this epoch: 0.037312907081509805
Early stop with best valid_loss: 0.1060539036989212
[2024-03-07 00:17:13] [32mFinal result: 0.10581741482019424[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 00:17:20.711664: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 00:17:20.711753: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 00:17:20.713388: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 00:17:20.722483: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 00:17:22.419146: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0627
	speed: 0.026948s/iter; left time: 2564.596998s
	iters: 764, epoch: 1 | train_loss : 0.0023
	speed: 0.015271s/iter; left time: 1447.458162s
	iters: 1146, epoch: 1 | train_loss : 0.0022
	speed: 0.017693s/iter; left time: 1670.347761s
	iters: 1528, epoch: 1 | train_loss : 0.0016
	speed: 0.020861s/iter; left time: 1961.397634s
	iters: 1910, epoch: 1 | train_loss : 0.0006
	speed: 0.023913s/iter; left time: 2239.220777s
data: {'predict': array([137.28827583, 137.27746497, 137.25414905, ..., 131.49488364,
       131.50771387, 131.51242183]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:22:11] [32mIntermediate result: 0.023727109655737877  (Index 0)[0m
Epoch: 1 | cost time: 278.1848647594452 | valid_loss: 0.023727109655737877 | valid_loss_true: 1.1306813443512789
Pretest loss in this epoch: 3.9810180166996965
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0013
	speed: 0.647555s/iter; left time: 60389.725562s
	iters: 764, epoch: 2 | train_loss : 0.0008
	speed: 0.015793s/iter; left time: 1466.827903s
	iters: 1146, epoch: 2 | train_loss : 0.0012
	speed: 0.016031s/iter; left time: 1482.815303s
	iters: 1528, epoch: 2 | train_loss : 0.0113
	speed: 0.014031s/iter; left time: 1292.413599s
	iters: 1910, epoch: 2 | train_loss : 0.0047
	speed: 0.014483s/iter; left time: 1328.551923s
data: {'predict': array([137.3485744 , 137.33784837, 137.31493303, ..., 131.58975316,
       131.60261874, 131.60735379]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:26:27] [32mIntermediate result: 0.024239933118224144  (Index 1)[0m
Epoch: 2 | cost time: 255.72867822647095 | valid_loss: 0.024239933118224144 | valid_loss_true: 1.1456049877578574
Pretest loss in this epoch: 3.9911720731348717
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0007
	speed: 0.607972s/iter; left time: 55536.462323s
	iters: 764, epoch: 3 | train_loss : 0.0451
	speed: 0.013414s/iter; left time: 1220.203235s
	iters: 1146, epoch: 3 | train_loss : 0.0025
	speed: 0.013393s/iter; left time: 1213.148509s
	iters: 1528, epoch: 3 | train_loss : 0.0058
	speed: 0.014004s/iter; left time: 1263.197003s
	iters: 1910, epoch: 3 | train_loss : 0.0008
	speed: 0.015067s/iter; left time: 1353.277538s
data: {'predict': array([137.2879106 , 137.27709503, 137.25440943, ..., 131.54278907,
       131.55567233, 131.56037557]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:30:26] [32mIntermediate result: 0.024133341386914253  (Index 2)[0m
Epoch: 3 | cost time: 239.67529106140137 | valid_loss: 0.024133341386914253 | valid_loss_true: 1.127900748289687
Pretest loss in this epoch: 3.975248908809735
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0013
	speed: 0.575245s/iter; left time: 51447.571322s
	iters: 764, epoch: 4 | train_loss : 0.0006
	speed: 0.014492s/iter; left time: 1290.604580s
	iters: 1146, epoch: 4 | train_loss : 0.0026
	speed: 0.017993s/iter; left time: 1595.497171s
	iters: 1528, epoch: 4 | train_loss : 0.0071
	speed: 0.016578s/iter; left time: 1463.669218s
	iters: 1910, epoch: 4 | train_loss : 0.0073
	speed: 0.015220s/iter; left time: 1337.919805s
data: {'predict': array([136.4941137 , 136.48484741, 136.46554433, ..., 131.36014024,
       131.37192898, 131.37602429]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:34:21] [32mIntermediate result: 0.02379082329571247  (Index 3)[0m
Epoch: 4 | cost time: 234.84023666381836 | valid_loss: 0.02379082329571247 | valid_loss_true: 1.1432234095816427
Pretest loss in this epoch: 5.160547354451632
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0008
	speed: 0.547390s/iter; left time: 47910.316828s
	iters: 764, epoch: 5 | train_loss : 0.0015
	speed: 0.013962s/iter; left time: 1216.667273s
	iters: 1146, epoch: 5 | train_loss : 0.0397
	speed: 0.013542s/iter; left time: 1174.922653s
	iters: 1528, epoch: 5 | train_loss : 0.0039
	speed: 0.014733s/iter; left time: 1272.621965s
	iters: 1910, epoch: 5 | train_loss : 0.0033
	speed: 0.014117s/iter; left time: 1214.039829s
data: {'predict': array([136.94896263, 136.93868431, 136.91752443, ..., 131.44802912,
       131.46059192, 131.46513611]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:38:18] [32mIntermediate result: 0.02318602427840233  (Index 4)[0m
Epoch: 5 | cost time: 237.13809514045715 | valid_loss: 0.02318602427840233 | valid_loss_true: 1.0699881010460501
Pretest loss in this epoch: 4.046636885461391
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0008
	speed: 0.563368s/iter; left time: 48232.160190s
	iters: 764, epoch: 6 | train_loss : 0.0178
	speed: 0.013291s/iter; left time: 1132.794846s
	iters: 1146, epoch: 6 | train_loss : 0.0323
	speed: 0.013478s/iter; left time: 1143.604816s
	iters: 1528, epoch: 6 | train_loss : 0.0006
	speed: 0.013792s/iter; left time: 1164.993929s
	iters: 1910, epoch: 6 | train_loss : 0.0010
	speed: 0.013565s/iter; left time: 1140.593721s
data: {'predict': array([136.79392767, 136.78347969, 136.76206533, ..., 131.27151029,
       131.28412375, 131.28875866]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:42:23] [32mIntermediate result: 0.023333748802542686  (Index 5)[0m
Epoch: 6 | cost time: 244.4972231388092 | valid_loss: 0.023333748802542686 | valid_loss_true: 1.0852336199790582
Pretest loss in this epoch: 4.052311082591248
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0037
	speed: 0.584733s/iter; left time: 48943.942814s
	iters: 764, epoch: 7 | train_loss : 0.0008
	speed: 0.013820s/iter; left time: 1151.529219s
	iters: 1146, epoch: 7 | train_loss : 0.0017
	speed: 0.013730s/iter; left time: 1138.743190s
	iters: 1528, epoch: 7 | train_loss : 0.0326
	speed: 0.013971s/iter; left time: 1153.365960s
	iters: 1910, epoch: 7 | train_loss : 0.0006
	speed: 0.014357s/iter; left time: 1179.813103s
data: {'predict': array([137.43799726, 137.42759169, 137.40644124, ..., 131.94903628,
       131.96169097, 131.9663895 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:46:39] [32mIntermediate result: 0.025104384869337082  (Index 6)[0m
Epoch: 7 | cost time: 255.65278601646423 | valid_loss: 0.025104384869337082 | valid_loss_true: 1.1688379095249253
Pretest loss in this epoch: 4.198143649848996
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0009
	speed: 0.617222s/iter; left time: 50483.790749s
	iters: 764, epoch: 8 | train_loss : 0.0007
	speed: 0.015119s/iter; left time: 1230.841368s
	iters: 1146, epoch: 8 | train_loss : 0.0043
	speed: 0.015672s/iter; left time: 1269.863658s
	iters: 1528, epoch: 8 | train_loss : 0.0024
	speed: 0.014449s/iter; left time: 1165.289166s
	iters: 1910, epoch: 8 | train_loss : 0.0010
	speed: 0.015058s/iter; left time: 1208.586161s
data: {'predict': array([136.78981352, 136.77911223, 136.75762247, ..., 131.25000875,
       131.26269407, 131.26737611]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:51:08] [32mIntermediate result: 0.02330741472542286  (Index 7)[0m
Epoch: 8 | cost time: 269.0429470539093 | valid_loss: 0.02330741472542286 | valid_loss_true: 1.0867556361321984
Pretest loss in this epoch: 3.878809191589418
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0016
	speed: 0.640799s/iter; left time: 51187.643880s
	iters: 764, epoch: 9 | train_loss : 0.0011
	speed: 0.013947s/iter; left time: 1108.770523s
	iters: 1146, epoch: 9 | train_loss : 0.0017
	speed: 0.014501s/iter; left time: 1147.278033s
	iters: 1528, epoch: 9 | train_loss : 0.0005
	speed: 0.014009s/iter; left time: 1103.035922s
	iters: 1910, epoch: 9 | train_loss : 0.0012
	speed: 0.013347s/iter; left time: 1045.811848s
data: {'predict': array([136.98313183, 136.97237163, 136.9509125 , ..., 131.46217302,
       131.47483831, 131.47955333]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:55:05] [32mIntermediate result: 0.0231622327119112  (Index 8)[0m
Epoch: 9 | cost time: 237.360511302948 | valid_loss: 0.0231622327119112 | valid_loss_true: 1.0714751120796797
Pretest loss in this epoch: 3.869365738749422
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0005
	speed: 0.569895s/iter; left time: 44434.690793s
	iters: 764, epoch: 10 | train_loss : 0.0151
	speed: 0.013567s/iter; left time: 1052.637425s
	iters: 1146, epoch: 10 | train_loss : 0.0021
	speed: 0.014778s/iter; left time: 1140.918071s
	iters: 1528, epoch: 10 | train_loss : 0.0011
	speed: 0.014953s/iter; left time: 1148.781235s
	iters: 1910, epoch: 10 | train_loss : 0.0022
	speed: 0.013639s/iter; left time: 1042.606375s
data: {'predict': array([137.00297333, 136.99235334, 136.97138904, ..., 131.56867222,
       131.58117021, 131.58577213]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 00:59:17] [32mIntermediate result: 0.023215336725115776  (Index 9)[0m
Epoch: 10 | cost time: 252.14923357963562 | valid_loss: 0.023215336725115776 | valid_loss_true: 1.0675847634355862
Pretest loss in this epoch: 3.9118647917203835
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0025
	speed: 0.599471s/iter; left time: 45595.189700s
	iters: 764, epoch: 11 | train_loss : 0.0023
	speed: 0.015019s/iter; left time: 1136.589737s
	iters: 1146, epoch: 11 | train_loss : 0.0017
	speed: 0.015448s/iter; left time: 1163.149954s
	iters: 1528, epoch: 11 | train_loss : 0.0009
	speed: 0.014870s/iter; left time: 1113.991293s
	iters: 1910, epoch: 11 | train_loss : 0.0023
	speed: 0.016425s/iter; left time: 1224.150961s
data: {'predict': array([136.54176583, 136.53099974, 136.50987403, ..., 131.08833482,
       131.10083988, 131.10545712]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:02:58] [32mIntermediate result: 0.02400338463485241  (Index 10)[0m
Epoch: 11 | cost time: 220.6077971458435 | valid_loss: 0.02400338463485241 | valid_loss_true: 1.1450984726116074
Pretest loss in this epoch: 3.8752984249900364
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0045
	speed: 0.515256s/iter; left time: 38205.170174s
	iters: 764, epoch: 12 | train_loss : 0.0054
	speed: 0.011813s/iter; left time: 871.388107s
	iters: 1146, epoch: 12 | train_loss : 0.0019
	speed: 0.015662s/iter; left time: 1149.308866s
	iters: 1528, epoch: 12 | train_loss : 0.0042
	speed: 0.012888s/iter; left time: 940.859774s
	iters: 1910, epoch: 12 | train_loss : 0.0019
	speed: 0.013454s/iter; left time: 977.059919s
data: {'predict': array([136.81824504, 136.80720326, 136.78565694, ..., 131.29356322,
       131.3062344 , 131.31098006]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:06:55] [32mIntermediate result: 0.023228993639349937  (Index 11)[0m
Epoch: 12 | cost time: 237.46151399612427 | valid_loss: 0.023228993639349937 | valid_loss_true: 1.0812596596881259
Pretest loss in this epoch: 3.841973271646504
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0010
	speed: 0.566700s/iter; left time: 40936.689400s
	iters: 764, epoch: 13 | train_loss : 0.0046
	speed: 0.012721s/iter; left time: 914.035339s
	iters: 1146, epoch: 13 | train_loss : 0.0009
	speed: 0.012658s/iter; left time: 904.675970s
	iters: 1528, epoch: 13 | train_loss : 0.0007
	speed: 0.014351s/iter; left time: 1020.220043s
	iters: 1910, epoch: 13 | train_loss : 0.0010
	speed: 0.011934s/iter; left time: 843.859753s
data: {'predict': array([136.60301047, 136.59198047, 136.57059674, ..., 131.11808235,
       131.13065104, 131.1353425 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:10:09] [32mIntermediate result: 0.023809470236301422  (Index 12)[0m
Epoch: 13 | cost time: 194.0837845802307 | valid_loss: 0.023809470236301422 | valid_loss_true: 1.1265259829314085
Pretest loss in this epoch: 3.840388327093144
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0042
	speed: 0.455299s/iter; left time: 32019.349738s
	iters: 764, epoch: 14 | train_loss : 0.0018
	speed: 0.010723s/iter; left time: 749.981559s
	iters: 1146, epoch: 14 | train_loss : 0.0063
	speed: 0.010257s/iter; left time: 713.510507s
	iters: 1528, epoch: 14 | train_loss : 0.0010
	speed: 0.010562s/iter; left time: 730.664685s
	iters: 1910, epoch: 14 | train_loss : 0.0009
	speed: 0.011141s/iter; left time: 766.459410s
data: {'predict': array([136.79962175, 136.78849633, 136.76704662, ..., 131.30997862,
       131.32256851, 131.32730356]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:13:25] [32mIntermediate result: 0.02323390357196331  (Index 13)[0m
Epoch: 14 | cost time: 195.32837176322937 | valid_loss: 0.02323390357196331 | valid_loss_true: 1.0813734705589786
Pretest loss in this epoch: 3.8541225722399917
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0008
	speed: 0.468519s/iter; left time: 32053.697315s
	iters: 764, epoch: 15 | train_loss : 0.0159
	speed: 0.010936s/iter; left time: 744.031857s
	iters: 1146, epoch: 15 | train_loss : 0.0018
	speed: 0.011432s/iter; left time: 773.415567s
	iters: 1528, epoch: 15 | train_loss : 0.0210
	speed: 0.011121s/iter; left time: 748.116874s
	iters: 1910, epoch: 15 | train_loss : 0.0030
	speed: 0.011123s/iter; left time: 744.011070s
data: {'predict': array([136.86710361, 136.85640114, 136.83584802, ..., 131.5398684 ,
       131.55217199, 131.55675624]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:16:37] [32mIntermediate result: 0.023053038865327835  (Index 14)[0m
Epoch: 15 | cost time: 192.81208777427673 | valid_loss: 0.023053038865327835 | valid_loss_true: 1.064568309273302
Pretest loss in this epoch: 3.8417358450659913
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0050
	speed: 0.461216s/iter; left time: 30672.704115s
	iters: 764, epoch: 16 | train_loss : 0.0026
	speed: 0.012412s/iter; left time: 820.696365s
	iters: 1146, epoch: 16 | train_loss : 0.0036
	speed: 0.013284s/iter; left time: 873.262821s
	iters: 1528, epoch: 16 | train_loss : 0.0024
	speed: 0.011995s/iter; left time: 783.967072s
	iters: 1910, epoch: 16 | train_loss : 0.0013
	speed: 0.011865s/iter; left time: 770.924534s
data: {'predict': array([136.91552744, 136.90427948, 136.88278854, ..., 131.42158635,
       131.43420098, 131.4389702 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:20:00] [32mIntermediate result: 0.023144248872995377  (Index 15)[0m
Epoch: 16 | cost time: 202.94688868522644 | valid_loss: 0.023144248872995377 | valid_loss_true: 1.0708657990212922
Pretest loss in this epoch: 3.8903873980841706
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0016
	speed: 0.483189s/iter; left time: 31210.617475s
	iters: 764, epoch: 17 | train_loss : 0.0015
	speed: 0.014039s/iter; left time: 901.453118s
	iters: 1146, epoch: 17 | train_loss : 0.0009
	speed: 0.012710s/iter; left time: 811.243856s
	iters: 1528, epoch: 17 | train_loss : 0.0034
	speed: 0.013098s/iter; left time: 831.007120s
	iters: 1910, epoch: 17 | train_loss : 0.0096
	speed: 0.013036s/iter; left time: 822.138101s
data: {'predict': array([137.0196279 , 137.00824327, 136.98657678, ..., 131.49754394,
       131.51021983, 131.51503854]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:23:31] [32mIntermediate result: 0.023256845772266388  (Index 16)[0m
Epoch: 17 | cost time: 210.51537942886353 | valid_loss: 0.023256845772266388 | valid_loss_true: 1.0734199556619928
Pretest loss in this epoch: 3.816023736021472
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0013
	speed: 0.496355s/iter; left time: 31112.542495s
	iters: 764, epoch: 18 | train_loss : 0.0082
	speed: 0.011127s/iter; left time: 693.211172s
	iters: 1146, epoch: 18 | train_loss : 0.0044
	speed: 0.011069s/iter; left time: 685.384027s
	iters: 1528, epoch: 18 | train_loss : 0.0026
	speed: 0.011999s/iter; left time: 738.376904s
	iters: 1910, epoch: 18 | train_loss : 0.0029
	speed: 0.011435s/iter; left time: 699.269467s
data: {'predict': array([136.8942309 , 136.88307366, 136.86186901, ..., 131.46108086,
       131.47358827, 131.4783245 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:26:41] [32mIntermediate result: 0.023107163608074188  (Index 17)[0m
Epoch: 18 | cost time: 189.9708080291748 | valid_loss: 0.023107163608074188 | valid_loss_true: 1.0683844711337562
Pretest loss in this epoch: 3.816012576059603
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0884
	speed: 0.450837s/iter; left time: 27397.812134s
	iters: 764, epoch: 19 | train_loss : 0.0005
	speed: 0.010883s/iter; left time: 657.241560s
	iters: 1146, epoch: 19 | train_loss : 0.0039
	speed: 0.010750s/iter; left time: 645.065049s
	iters: 1528, epoch: 19 | train_loss : 0.0009
	speed: 0.012159s/iter; left time: 724.954617s
	iters: 1910, epoch: 19 | train_loss : 0.0042
	speed: 0.011422s/iter; left time: 676.653506s
data: {'predict': array([136.79049096, 136.77948453, 136.75859092, ..., 131.41568727,
       131.42807923, 131.43275184]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:29:55] [32mIntermediate result: 0.023119444027543068  (Index 18)[0m
Epoch: 19 | cost time: 194.49449467658997 | valid_loss: 0.023119444027543068 | valid_loss_true: 1.0753793059216834
Pretest loss in this epoch: 3.9685171352477964
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0053
	speed: 0.465790s/iter; left time: 27416.407277s
	iters: 764, epoch: 20 | train_loss : 0.0009
	speed: 0.012444s/iter; left time: 727.713187s
	iters: 1146, epoch: 20 | train_loss : 0.0006
	speed: 0.012136s/iter; left time: 705.064260s
	iters: 1528, epoch: 20 | train_loss : 0.0004
	speed: 0.011953s/iter; left time: 689.857999s
	iters: 1910, epoch: 20 | train_loss : 0.0023
	speed: 0.012133s/iter; left time: 695.592684s
data: {'predict': array([136.77394832, 136.76276045, 136.74162767, ..., 131.35837181,
       131.37082857, 131.37554242]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:32:57] [32mIntermediate result: 0.023179154843091965  (Index 19)[0m
Epoch: 20 | cost time: 181.3823947906494 | valid_loss: 0.023179154843091965 | valid_loss_true: 1.080243454775517
Pretest loss in this epoch: 3.8252411647887365
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0005
	speed: 0.425188s/iter; left time: 24214.032850s
	iters: 764, epoch: 21 | train_loss : 0.0006
	speed: 0.012433s/iter; left time: 703.273447s
	iters: 1146, epoch: 21 | train_loss : 0.0021
	speed: 0.012711s/iter; left time: 714.160455s
	iters: 1528, epoch: 21 | train_loss : 0.0012
	speed: 0.013047s/iter; left time: 728.076641s
	iters: 1910, epoch: 21 | train_loss : 0.0046
	speed: 0.013160s/iter; left time: 729.346464s
data: {'predict': array([136.77622336, 136.76527112, 136.74461551, ..., 131.44627012,
       131.458569  , 131.46319213]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:36:34] [32mIntermediate result: 0.0230928473174572  (Index 20)[0m
Epoch: 21 | cost time: 217.72667050361633 | valid_loss: 0.0230928473174572 | valid_loss_true: 1.0747020893191264
Pretest loss in this epoch: 3.846010531315923
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0034
	speed: 0.518931s/iter; left time: 28560.909402s
	iters: 764, epoch: 22 | train_loss : 0.0009
	speed: 0.012496s/iter; left time: 682.987288s
	iters: 1146, epoch: 22 | train_loss : 0.0005
	speed: 0.011340s/iter; left time: 615.452641s
	iters: 1528, epoch: 22 | train_loss : 0.0003
	speed: 0.011249s/iter; left time: 606.255554s
	iters: 1910, epoch: 22 | train_loss : 0.0004
	speed: 0.011190s/iter; left time: 598.758532s
data: {'predict': array([136.75947337, 136.74808521, 136.72661783, ..., 131.29006642,
       131.30262686, 131.30742082]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:39:47] [32mIntermediate result: 0.023284921422600746  (Index 21)[0m
Epoch: 22 | cost time: 192.34763622283936 | valid_loss: 0.023284921422600746 | valid_loss_true: 1.0863633727737565
Pretest loss in this epoch: 3.820728126183903
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0016
	speed: 0.457481s/iter; left time: 24304.615591s
	iters: 764, epoch: 23 | train_loss : 0.0020
	speed: 0.012872s/iter; left time: 678.939566s
	iters: 1146, epoch: 23 | train_loss : 0.0012
	speed: 0.013023s/iter; left time: 681.937571s
	iters: 1528, epoch: 23 | train_loss : 0.0059
	speed: 0.012640s/iter; left time: 657.052234s
	iters: 1910, epoch: 23 | train_loss : 0.0027
	speed: 0.012873s/iter; left time: 664.226224s
data: {'predict': array([136.78269268, 136.77141998, 136.75021062, ..., 131.35983981,
       131.37231424, 131.37705518]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 01:43:28] [32mIntermediate result: 0.023177137598395348  (Index 22)[0m
Epoch: 23 | cost time: 221.4870982170105 | valid_loss: 0.023177137598395348 | valid_loss_true: 1.0793220292046213
Pretest loss in this epoch: 3.80142286912145
Early stop with best valid_loss: 0.023177137598395348
[2024-03-07 01:43:28] [32mFinal result: 0.023053038865327835[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效出料温度', target_cols='1效出料温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 01:43:34.688235: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 01:43:34.688317: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 01:43:34.689963: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 01:43:34.699214: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:43:36.098248: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0000
	speed: 0.016483s/iter; left time: 1568.674648s
	iters: 764, epoch: 1 | train_loss : 0.0000
	speed: 0.011356s/iter; left time: 1076.414235s
	iters: 1146, epoch: 1 | train_loss : 0.0000
	speed: 0.012383s/iter; left time: 1169.059339s
	iters: 1528, epoch: 1 | train_loss : 0.0000
	speed: 0.011990s/iter; left time: 1127.317209s
	iters: 1910, epoch: 1 | train_loss : 0.0000
	speed: 0.012611s/iter; left time: 1180.951391s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 01:46:48] [32mIntermediate result: 3.5989722313445327e-09  (Index 0)[0m
Epoch: 1 | cost time: 186.57534432411194 | valid_loss: 3.5989722313445327e-09 | valid_loss_true: 0.0
Pretest loss in this epoch: 14.470636344054181
Chepoint Saved at:  ./checkpoints/fullreg/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0000
	speed: 0.441776s/iter; left time: 41199.167781s
	iters: 764, epoch: 2 | train_loss : 0.0000
	speed: 0.012021s/iter; left time: 1116.484467s
	iters: 1146, epoch: 2 | train_loss : 0.0000
	speed: 0.012553s/iter; left time: 1161.105730s
	iters: 1528, epoch: 2 | train_loss : 0.0000
	speed: 0.013218s/iter; left time: 1217.531212s
	iters: 1910, epoch: 2 | train_loss : 0.0000
	speed: 0.012679s/iter; left time: 1163.039533s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 01:50:27] [32mIntermediate result: 3.847463236894555e-09  (Index 1)[0m
Epoch: 2 | cost time: 218.74814248085022 | valid_loss: 3.847463236894555e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343481333
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0000
	speed: 0.521525s/iter; left time: 47639.763026s
	iters: 764, epoch: 3 | train_loss : 0.0000
	speed: 0.012669s/iter; left time: 1152.409271s
	iters: 1146, epoch: 3 | train_loss : 0.0000
	speed: 0.012247s/iter; left time: 1109.360848s
	iters: 1528, epoch: 3 | train_loss : 0.0000
	speed: 0.011810s/iter; left time: 1065.294080s
	iters: 1910, epoch: 3 | train_loss : 0.0000
	speed: 0.011331s/iter; left time: 1017.758620s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 01:53:39] [32mIntermediate result: 3.965874295630556e-09  (Index 2)[0m
Epoch: 3 | cost time: 191.80620789527893 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176954
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0000
	speed: 0.454538s/iter; left time: 40652.048975s
	iters: 764, epoch: 4 | train_loss : 0.0000
	speed: 0.012041s/iter; left time: 1072.268215s
	iters: 1146, epoch: 4 | train_loss : 0.0000
	speed: 0.013017s/iter; left time: 1154.262602s
	iters: 1528, epoch: 4 | train_loss : 0.0000
	speed: 0.012899s/iter; left time: 1138.878442s
	iters: 1910, epoch: 4 | train_loss : 0.0000
	speed: 0.012758s/iter; left time: 1121.571665s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 01:57:24] [32mIntermediate result: 3.965874295630556e-09  (Index 3)[0m
Epoch: 4 | cost time: 225.36478734016418 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176954
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0000
	speed: 0.537943s/iter; left time: 47083.461726s
	iters: 764, epoch: 5 | train_loss : 0.0000
	speed: 0.012257s/iter; left time: 1068.079600s
	iters: 1146, epoch: 5 | train_loss : 0.0000
	speed: 0.010035s/iter; left time: 870.629625s
	iters: 1528, epoch: 5 | train_loss : 0.0000
	speed: 0.010448s/iter; left time: 902.483388s
	iters: 1910, epoch: 5 | train_loss : 0.0000
	speed: 0.010724s/iter; left time: 922.207592s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 02:00:30] [32mIntermediate result: 3.965874295630556e-09  (Index 4)[0m
Epoch: 5 | cost time: 185.4358856678009 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176954
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0000
	speed: 0.442940s/iter; left time: 37921.879093s
	iters: 764, epoch: 6 | train_loss : 0.0000
	speed: 0.011371s/iter; left time: 969.161339s
	iters: 1146, epoch: 6 | train_loss : 0.0000
	speed: 0.011638s/iter; left time: 987.511711s
	iters: 1528, epoch: 6 | train_loss : 0.0000
	speed: 0.011572s/iter; left time: 977.426128s
	iters: 1910, epoch: 6 | train_loss : 0.0000
	speed: 0.011746s/iter; left time: 987.638385s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 02:03:50] [32mIntermediate result: 3.965874295630556e-09  (Index 5)[0m
Epoch: 6 | cost time: 199.9314603805542 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176954
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0000
	speed: 0.477057s/iter; left time: 39931.123603s
	iters: 764, epoch: 7 | train_loss : 0.0000
	speed: 0.012027s/iter; left time: 1002.125246s
	iters: 1146, epoch: 7 | train_loss : 0.0000
	speed: 0.012265s/iter; left time: 1017.219093s
	iters: 1528, epoch: 7 | train_loss : 0.0000
	speed: 0.011940s/iter; left time: 985.766747s
	iters: 1910, epoch: 7 | train_loss : 0.0000
	speed: 0.011942s/iter; left time: 981.337926s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 02:06:59] [32mIntermediate result: 3.965874295630556e-09  (Index 6)[0m
Epoch: 7 | cost time: 189.39965963363647 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343177013
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0000
	speed: 0.446997s/iter; left time: 36560.801313s
	iters: 764, epoch: 8 | train_loss : 0.0000
	speed: 0.010745s/iter; left time: 874.727521s
	iters: 1146, epoch: 8 | train_loss : 0.0000
	speed: 0.011353s/iter; left time: 919.923652s
	iters: 1528, epoch: 8 | train_loss : 0.0000
	speed: 0.011235s/iter; left time: 906.033394s
	iters: 1910, epoch: 8 | train_loss : 0.0000
	speed: 0.011256s/iter; left time: 903.416879s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 02:10:19] [32mIntermediate result: 3.965874295630556e-09  (Index 7)[0m
Epoch: 8 | cost time: 199.43902850151062 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176434
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0000
	speed: 0.477843s/iter; left time: 38170.557688s
	iters: 764, epoch: 9 | train_loss : 0.0000
	speed: 0.012349s/iter; left time: 981.717484s
	iters: 1146, epoch: 9 | train_loss : 0.0000
	speed: 0.011850s/iter; left time: 937.531220s
	iters: 1528, epoch: 9 | train_loss : 0.0000
	speed: 0.011236s/iter; left time: 884.687084s
	iters: 1910, epoch: 9 | train_loss : 0.0000
	speed: 0.011633s/iter; left time: 911.450751s
data: {'predict': array([148.74826   , 148.74826   , 148.74826   , ..., 148.74826009,
       148.74826009, 148.74826009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 02:13:31] [32mIntermediate result: 3.965874295630556e-09  (Index 8)[0m
Epoch: 9 | cost time: 192.32584261894226 | valid_loss: 3.965874295630556e-09 | valid_loss_true: 3.725290298461914e-09
Pretest loss in this epoch: 14.470636343176814
Early stop with best valid_loss: 3.965874295630556e-09
[2024-03-07 02:13:31] [32mFinal result: 3.5989722313445327e-09[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
