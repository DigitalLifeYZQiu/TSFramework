python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 17:24:22.085883: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 17:24:22.086165: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 17:24:22.088419: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 17:24:22.098942: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 17:24:23.596363: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0163
	speed: 0.096704s/iter; left time: 9203.235505s
	iters: 764, epoch: 1 | train_loss : 0.0058
	speed: 0.084906s/iter; left time: 8048.015264s
	iters: 1146, epoch: 1 | train_loss : 0.0065
	speed: 0.063309s/iter; left time: 5976.709164s
	iters: 1528, epoch: 1 | train_loss : 0.0023
	speed: 0.059876s/iter; left time: 5629.760589s
	iters: 1910, epoch: 1 | train_loss : 0.0015
	speed: 0.056753s/iter; left time: 5314.440873s
data: {'predict': array([161.38839071, 161.33563984, 161.21345142, ..., 149.51694271,
       149.65155587, 149.56752454]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:29:05] [32mIntermediate result: 0.05498379096388817  (Index 0)[0m
Epoch: 1 | cost time: 274.4436068534851 | valid_loss: 0.05498379096388817 | valid_loss_true: 2.696360528448402
Pretest loss in this epoch: 22.999014885319014
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0030
	speed: 0.463561s/iter; left time: 43230.749853s
	iters: 764, epoch: 2 | train_loss : 0.0008
	speed: 0.097561s/iter; left time: 9061.078847s
	iters: 1146, epoch: 2 | train_loss : 0.0131
	speed: 0.087117s/iter; left time: 8057.837474s
	iters: 1528, epoch: 2 | train_loss : 0.0044
	speed: 0.082511s/iter; left time: 7600.282321s
	iters: 1910, epoch: 2 | train_loss : 0.0019
	speed: 0.090357s/iter; left time: 8288.453705s
data: {'predict': array([160.57558953, 160.54341494, 160.43630827, ..., 148.93995925,
       149.09719786, 149.00934461]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:34:48] [32mIntermediate result: 0.043599583208560944  (Index 1)[0m
Epoch: 2 | cost time: 342.7322106361389 | valid_loss: 0.043599583208560944 | valid_loss_true: 2.1810382349721387
Pretest loss in this epoch: 25.847542873820174
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0008
	speed: 0.488231s/iter; left time: 44598.401853s
	iters: 764, epoch: 3 | train_loss : 0.0014
	speed: 0.027988s/iter; left time: 2545.947332s
	iters: 1146, epoch: 3 | train_loss : 0.0012
	speed: 0.021475s/iter; left time: 1945.310340s
	iters: 1528, epoch: 3 | train_loss : 0.0010
	speed: 0.026597s/iter; left time: 2399.086123s
	iters: 1910, epoch: 3 | train_loss : 0.0043
	speed: 0.034908s/iter; left time: 3135.429409s
data: {'predict': array([159.22145869, 159.17301488, 159.05537609, ..., 147.38767135,
       147.55600761, 147.45956141]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:38:56] [32mIntermediate result: 0.0490136444568634  (Index 2)[0m
Epoch: 3 | cost time: 248.39802193641663 | valid_loss: 0.0490136444568634 | valid_loss_true: 2.524970360763118
Pretest loss in this epoch: 28.00150387376039
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0013
	speed: 0.554162s/iter; left time: 49562.006496s
	iters: 764, epoch: 4 | train_loss : 0.0009
	speed: 0.018581s/iter; left time: 1654.731910s
	iters: 1146, epoch: 4 | train_loss : 0.0005
	speed: 0.020661s/iter; left time: 1832.089011s
	iters: 1528, epoch: 4 | train_loss : 0.0008
	speed: 0.013726s/iter; left time: 1211.872652s
	iters: 1910, epoch: 4 | train_loss : 0.0010
	speed: 0.013990s/iter; left time: 1229.829653s
data: {'predict': array([158.90970053, 158.84190175, 158.72480734, ..., 147.4487444 ,
       147.63223293, 147.53808975]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:42:27] [32mIntermediate result: 0.042898453772068024  (Index 3)[0m
Epoch: 4 | cost time: 210.52450513839722 | valid_loss: 0.042898453772068024 | valid_loss_true: 2.1666499721194508
Pretest loss in this epoch: 30.724359004876252
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0006
	speed: 0.522652s/iter; left time: 45745.113899s
	iters: 764, epoch: 5 | train_loss : 0.0013
	speed: 0.131380s/iter; left time: 11448.846147s
	iters: 1146, epoch: 5 | train_loss : 0.0011
	speed: 0.134420s/iter; left time: 11662.410897s
	iters: 1528, epoch: 5 | train_loss : 0.0011
	speed: 0.130760s/iter; left time: 11294.932921s
	iters: 1910, epoch: 5 | train_loss : 0.0007
	speed: 0.086430s/iter; left time: 7432.687466s
data: {'predict': array([160.25919995, 160.19442485, 160.08508991, ..., 147.93192597,
       148.12822567, 148.03985343]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:49:03] [32mIntermediate result: 0.03978787362575531  (Index 4)[0m
Epoch: 5 | cost time: 395.8684070110321 | valid_loss: 0.03978787362575531 | valid_loss_true: 1.9836904146666294
Pretest loss in this epoch: 28.32106524527596
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0027
	speed: 0.475352s/iter; left time: 40696.759855s
	iters: 764, epoch: 6 | train_loss : 0.0260
	speed: 0.049425s/iter; left time: 4212.575347s
	iters: 1146, epoch: 6 | train_loss : 0.0008
	speed: 0.047666s/iter; left time: 4044.461780s
	iters: 1528, epoch: 6 | train_loss : 0.0005
	speed: 0.048200s/iter; left time: 4071.379216s
	iters: 1910, epoch: 6 | train_loss : 0.0013
	speed: 0.045154s/iter; left time: 3796.807736s
data: {'predict': array([159.40874657, 159.32733275, 159.2198171 , ..., 147.70878967,
       147.89675167, 147.81766767]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:52:53] [32mIntermediate result: 0.044839829206466675  (Index 5)[0m
Epoch: 6 | cost time: 230.29683637619019 | valid_loss: 0.044839829206466675 | valid_loss_true: 2.2730327045797396
Pretest loss in this epoch: 30.231961652951078
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0010
	speed: 0.445123s/iter; left time: 37258.141882s
	iters: 764, epoch: 7 | train_loss : 0.0006
	speed: 0.037012s/iter; left time: 3083.860449s
	iters: 1146, epoch: 7 | train_loss : 0.0005
	speed: 0.021478s/iter; left time: 1781.397964s
	iters: 1528, epoch: 7 | train_loss : 0.0006
	speed: 0.024083s/iter; left time: 1988.222154s
	iters: 1910, epoch: 7 | train_loss : 0.0021
	speed: 0.059757s/iter; left time: 4910.525771s
data: {'predict': array([159.71499609, 159.62938523, 159.51077897, ..., 148.2581524 ,
       148.45442812, 148.37767394]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:57:11] [32mIntermediate result: 0.044499363750219345  (Index 6)[0m
Epoch: 7 | cost time: 257.89921402931213 | valid_loss: 0.044499363750219345 | valid_loss_true: 2.165634131952238
Pretest loss in this epoch: 28.404166355678715
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0009
	speed: 0.553577s/iter; left time: 45278.176819s
	iters: 764, epoch: 8 | train_loss : 0.0010
	speed: 0.084970s/iter; left time: 6917.401290s
	iters: 1146, epoch: 8 | train_loss : 0.0006
	speed: 0.082183s/iter; left time: 6659.092491s
	iters: 1528, epoch: 8 | train_loss : 0.0006
	speed: 0.086773s/iter; left time: 6997.857846s
	iters: 1910, epoch: 8 | train_loss : 0.0004
	speed: 0.085919s/iter; left time: 6896.169160s
data: {'predict': array([159.0635248 , 158.9670377 , 158.85230977, ..., 148.13625733,
       148.32892973, 148.25298224]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:02:46] [32mIntermediate result: 0.04611290246248245  (Index 7)[0m
Epoch: 8 | cost time: 334.92252492904663 | valid_loss: 0.04611290246248245 | valid_loss_true: 2.2894513324675514
Pretest loss in this epoch: 30.204587920759096
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0007
	speed: 0.476906s/iter; left time: 38095.763136s
	iters: 764, epoch: 9 | train_loss : 0.0004
	speed: 0.013970s/iter; left time: 1110.562275s
	iters: 1146, epoch: 9 | train_loss : 0.0023
	speed: 0.016218s/iter; left time: 1283.096895s
	iters: 1528, epoch: 9 | train_loss : 0.0041
	speed: 0.013848s/iter; left time: 1090.351434s
	iters: 1910, epoch: 9 | train_loss : 0.0005
	speed: 0.015275s/iter; left time: 1196.855154s
data: {'predict': array([159.30846011, 159.20827238, 159.08902303, ..., 148.25919602,
       148.46048959, 148.38559842]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:06:01] [32mIntermediate result: 0.047105442732572556  (Index 8)[0m
Epoch: 9 | cost time: 194.4749619960785 | valid_loss: 0.047105442732572556 | valid_loss_true: 2.3260152572453094
Pretest loss in this epoch: 30.260063026787645
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0005
	speed: 0.541613s/iter; left time: 42229.545578s
	iters: 764, epoch: 10 | train_loss : 0.0005
	speed: 0.106907s/iter; left time: 8294.702066s
	iters: 1146, epoch: 10 | train_loss : 0.0005
	speed: 0.107525s/iter; left time: 8301.602358s
	iters: 1528, epoch: 10 | train_loss : 0.0004
	speed: 0.102642s/iter; left time: 7885.405020s
	iters: 1910, epoch: 10 | train_loss : 0.0005
	speed: 0.090989s/iter; left time: 6955.386139s
data: {'predict': array([158.92589924, 158.81646276, 158.69795241, ..., 148.73080608,
       148.92870929, 148.8577331 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:11:59] [32mIntermediate result: 0.04837258532643318  (Index 9)[0m
Epoch: 10 | cost time: 358.0696773529053 | valid_loss: 0.04837258532643318 | valid_loss_true: 2.363652381205306
Pretest loss in this epoch: 31.433117869002157
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0005
	speed: 0.485082s/iter; left time: 36894.878163s
	iters: 764, epoch: 11 | train_loss : 0.0005
	speed: 0.088510s/iter; left time: 6698.134543s
	iters: 1146, epoch: 11 | train_loss : 0.0005
	speed: 0.088500s/iter; left time: 6663.618669s
	iters: 1528, epoch: 11 | train_loss : 0.0007
	speed: 0.086389s/iter; left time: 6471.657932s
	iters: 1910, epoch: 11 | train_loss : 0.0007
	speed: 0.072419s/iter; left time: 5397.441411s
data: {'predict': array([159.06877676, 158.95460449, 158.84134328, ..., 149.05702264,
       149.25403594, 149.18723002]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:16:57] [32mIntermediate result: 0.04866954684257507  (Index 10)[0m
Epoch: 11 | cost time: 298.5465965270996 | valid_loss: 0.04866954684257507 | valid_loss_true: 2.3745432407379976
Pretest loss in this epoch: 32.2396524794161
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0012
	speed: 0.406937s/iter; left time: 30173.548248s
	iters: 764, epoch: 12 | train_loss : 0.0068
	speed: 0.019748s/iter; left time: 1456.747308s
	iters: 1146, epoch: 12 | train_loss : 0.0004
	speed: 0.017978s/iter; left time: 1319.318008s
	iters: 1528, epoch: 12 | train_loss : 0.0005
	speed: 0.021791s/iter; left time: 1590.753505s
	iters: 1910, epoch: 12 | train_loss : 0.0004
	speed: 0.016253s/iter; left time: 1180.275557s
data: {'predict': array([158.33604679, 158.21860262, 158.10022484, ..., 148.87318576,
       149.07134988, 149.00519551]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:20:26] [32mIntermediate result: 0.052847761660814285  (Index 11)[0m
Epoch: 12 | cost time: 208.82614660263062 | valid_loss: 0.052847761660814285 | valid_loss_true: 2.624007493944534
Pretest loss in this epoch: 33.460958580242995
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0010
	speed: 0.536414s/iter; left time: 38748.965828s
	iters: 764, epoch: 13 | train_loss : 0.0009
	speed: 0.071910s/iter; left time: 5167.091927s
	iters: 1146, epoch: 13 | train_loss : 0.0033
	speed: 0.071016s/iter; left time: 5075.721408s
	iters: 1528, epoch: 13 | train_loss : 0.0008
	speed: 0.062292s/iter; left time: 4428.412713s
	iters: 1910, epoch: 13 | train_loss : 0.0003
	speed: 0.036469s/iter; left time: 2578.678192s
data: {'predict': array([158.54412249, 158.42137278, 158.30352808, ..., 149.01849464,
       149.22152993, 149.15594674]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:25:13] [32mIntermediate result: 0.052031729370355606  (Index 12)[0m
Epoch: 13 | cost time: 287.4918918609619 | valid_loss: 0.052031729370355606 | valid_loss_true: 2.5418126138218478
Pretest loss in this epoch: 33.99251450203338
Early stop with best valid_loss: 0.052031729370355606
[2024-03-06 18:25:13] [32mFinal result: 0.03978787362575531[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 18:25:19.960818: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 18:25:19.960894: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 18:25:19.963372: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 18:25:19.976219: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 18:25:21.466378: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0207
	speed: 0.095528s/iter; left time: 9091.309964s
	iters: 764, epoch: 1 | train_loss : 0.0199
	speed: 0.069060s/iter; left time: 6546.026942s
	iters: 1146, epoch: 1 | train_loss : 0.0159
	speed: 0.059898s/iter; left time: 5654.683781s
	iters: 1528, epoch: 1 | train_loss : 0.0070
	speed: 0.058819s/iter; left time: 5530.322935s
	iters: 1910, epoch: 1 | train_loss : 0.0085
	speed: 0.059109s/iter; left time: 5534.980050s
data: {'predict': array([0.47348481, 0.4726737 , 0.47171626, ..., 0.35523603, 0.35582414,
       0.35520044]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:30:12] [32mIntermediate result: 0.2016192525625229  (Index 0)[0m
Epoch: 1 | cost time: 283.41896653175354 | valid_loss: 0.2016192525625229 | valid_loss_true: 0.04148092368484842
Pretest loss in this epoch: 0.13190203074089915
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0202
	speed: 0.485318s/iter; left time: 45259.802263s
	iters: 764, epoch: 2 | train_loss : 0.0046
	speed: 0.074636s/iter; left time: 6931.932147s
	iters: 1146, epoch: 2 | train_loss : 0.0059
	speed: 0.071067s/iter; left time: 6573.285928s
	iters: 1528, epoch: 2 | train_loss : 0.0118
	speed: 0.072932s/iter; left time: 6717.877079s
	iters: 1910, epoch: 2 | train_loss : 0.0134
	speed: 0.077979s/iter; left time: 7153.050925s
data: {'predict': array([0.48662638, 0.48608647, 0.48537259, ..., 0.36324   , 0.36396542,
       0.36343708]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:35:21] [32mIntermediate result: 0.17707784473896027  (Index 1)[0m
Epoch: 2 | cost time: 309.57333612442017 | valid_loss: 0.17707784473896027 | valid_loss_true: 0.03666824468639206
Pretest loss in this epoch: 0.12730034295020706
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0053
	speed: 0.497963s/iter; left time: 45487.381209s
	iters: 764, epoch: 3 | train_loss : 0.0051
	speed: 0.063750s/iter; left time: 5799.029358s
	iters: 1146, epoch: 3 | train_loss : 0.0055
	speed: 0.065761s/iter; left time: 5956.848796s
	iters: 1528, epoch: 3 | train_loss : 0.0051
	speed: 0.070945s/iter; left time: 6399.353533s
	iters: 1910, epoch: 3 | train_loss : 0.0229
	speed: 0.092925s/iter; left time: 8346.433485s
data: {'predict': array([0.4882038 , 0.48773319, 0.48700234, ..., 0.35658648, 0.35743386,
       0.35705074]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:40:24] [32mIntermediate result: 0.17821824550628662  (Index 2)[0m
Epoch: 3 | cost time: 303.02115082740784 | valid_loss: 0.17821824550628662 | valid_loss_true: 0.03845732603553834
Pretest loss in this epoch: 0.11975767548890155
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0073
	speed: 0.496239s/iter; left time: 44381.652692s
	iters: 764, epoch: 4 | train_loss : 0.0043
	speed: 0.068579s/iter; left time: 6107.224402s
	iters: 1146, epoch: 4 | train_loss : 0.0056
	speed: 0.056456s/iter; left time: 5006.030383s
	iters: 1528, epoch: 4 | train_loss : 0.0062
	speed: 0.098502s/iter; left time: 8696.784669s
	iters: 1910, epoch: 4 | train_loss : 0.0054
	speed: 0.073664s/iter; left time: 6475.673173s
data: {'predict': array([0.50015661, 0.49969669, 0.49901486, ..., 0.35653371, 0.35752321,
       0.35727495]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:45:16] [32mIntermediate result: 0.15119823813438416  (Index 3)[0m
Epoch: 4 | cost time: 291.36661648750305 | valid_loss: 0.15119823813438416 | valid_loss_true: 0.032164076787036866
Pretest loss in this epoch: 0.12146568753955342
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0091
	speed: 0.430898s/iter; left time: 37714.350656s
	iters: 764, epoch: 5 | train_loss : 0.0059
	speed: 0.034884s/iter; left time: 3039.882897s
	iters: 1146, epoch: 5 | train_loss : 0.0058
	speed: 0.054439s/iter; left time: 4723.218939s
	iters: 1528, epoch: 5 | train_loss : 0.0036
	speed: 0.062683s/iter; left time: 5414.505423s
	iters: 1910, epoch: 5 | train_loss : 0.0061
	speed: 0.075241s/iter; left time: 6470.525578s
data: {'predict': array([0.51777304, 0.51731705, 0.51661742, ..., 0.36556676, 0.36665808,
       0.36652582]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:50:12] [32mIntermediate result: 0.13405801355838776  (Index 4)[0m
Epoch: 5 | cost time: 296.560781955719 | valid_loss: 0.13405801355838776 | valid_loss_true: 0.02800399459290332
Pretest loss in this epoch: 0.13433598566863503
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0085
	speed: 0.589009s/iter; left time: 50427.416771s
	iters: 764, epoch: 6 | train_loss : 0.0059
	speed: 0.031014s/iter; left time: 2643.395775s
	iters: 1146, epoch: 6 | train_loss : 0.0118
	speed: 0.033832s/iter; left time: 2870.679585s
	iters: 1528, epoch: 6 | train_loss : 0.0057
	speed: 0.026200s/iter; left time: 2213.027693s
	iters: 1910, epoch: 6 | train_loss : 0.0080
	speed: 0.038018s/iter; left time: 3196.787379s
data: {'predict': array([0.51688757, 0.51638345, 0.51568698, ..., 0.3673843 , 0.3684469 ,
       0.36844094]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:54:06] [32mIntermediate result: 0.14045293629169464  (Index 5)[0m
Epoch: 6 | cost time: 233.34873938560486 | valid_loss: 0.14045293629169464 | valid_loss_true: 0.029469865184996176
Pretest loss in this epoch: 0.1461481755717508
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0101
	speed: 0.490414s/iter; left time: 41049.125836s
	iters: 764, epoch: 7 | train_loss : 0.0060
	speed: 0.081654s/iter; left time: 6803.521539s
	iters: 1146, epoch: 7 | train_loss : 0.0050
	speed: 0.080091s/iter; left time: 6642.663223s
	iters: 1528, epoch: 7 | train_loss : 0.0053
	speed: 0.074965s/iter; left time: 6188.899997s
	iters: 1910, epoch: 7 | train_loss : 0.0173
	speed: 0.048699s/iter; left time: 4001.855926s
data: {'predict': array([0.51014657, 0.50966898, 0.5089809 , ..., 0.3673754 , 0.36846438,
       0.36849837]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:59:00] [32mIntermediate result: 0.15494507551193237  (Index 6)[0m
Epoch: 7 | cost time: 293.9991683959961 | valid_loss: 0.15494507551193237 | valid_loss_true: 0.032649986465178873
Pretest loss in this epoch: 0.15118730964704916
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0060
	speed: 0.480912s/iter; left time: 39334.733127s
	iters: 764, epoch: 8 | train_loss : 0.0055
	speed: 0.096187s/iter; left time: 7830.560135s
	iters: 1146, epoch: 8 | train_loss : 0.0031
	speed: 0.098983s/iter; left time: 8020.416732s
	iters: 1528, epoch: 8 | train_loss : 0.0049
	speed: 0.090912s/iter; left time: 7331.680549s
	iters: 1910, epoch: 8 | train_loss : 0.0034
	speed: 0.093128s/iter; left time: 7474.820402s
data: {'predict': array([0.51826107, 0.5177208 , 0.51704162, ..., 0.36685893, 0.36805548,
       0.36812842]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:04:39] [32mIntermediate result: 0.14056673645973206  (Index 7)[0m
Epoch: 8 | cost time: 339.5470926761627 | valid_loss: 0.14056673645973206 | valid_loss_true: 0.029463629637484445
Pretest loss in this epoch: 0.13897364321986788
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0060
	speed: 0.478988s/iter; left time: 38262.071009s
	iters: 764, epoch: 9 | train_loss : 0.0041
	speed: 0.036066s/iter; left time: 2867.238551s
	iters: 1146, epoch: 9 | train_loss : 0.0046
	speed: 0.022826s/iter; left time: 1805.902325s
	iters: 1528, epoch: 9 | train_loss : 0.0058
	speed: 0.036222s/iter; left time: 2851.912272s
	iters: 1910, epoch: 9 | train_loss : 0.0052
	speed: 0.026848s/iter; left time: 2103.585088s
data: {'predict': array([0.5147748 , 0.51424034, 0.51356065, ..., 0.36712441, 0.36833196,
       0.36844823]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:08:24] [32mIntermediate result: 0.14447253942489624  (Index 8)[0m
Epoch: 9 | cost time: 225.14850783348083 | valid_loss: 0.14447253942489624 | valid_loss_true: 0.030973762370261552
Pretest loss in this epoch: 0.13812833655312867
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0048
	speed: 0.474632s/iter; left time: 37007.094057s
	iters: 764, epoch: 10 | train_loss : 0.0033
	speed: 0.046832s/iter; left time: 3633.578535s
	iters: 1146, epoch: 10 | train_loss : 0.0037
	speed: 0.043037s/iter; left time: 3322.727209s
	iters: 1528, epoch: 10 | train_loss : 0.0052
	speed: 0.045652s/iter; left time: 3507.152232s
	iters: 1910, epoch: 10 | train_loss : 0.0044
	speed: 0.037644s/iter; left time: 2877.609171s
data: {'predict': array([0.51911998, 0.51853523, 0.51780851, ..., 0.36642345, 0.36767982,
       0.36781956]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:12:39] [32mIntermediate result: 0.14620350301265717  (Index 9)[0m
Epoch: 10 | cost time: 254.31937313079834 | valid_loss: 0.14620350301265717 | valid_loss_true: 0.030409892700101204
Pretest loss in this epoch: 0.13781833164406504
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0058
	speed: 0.530532s/iter; left time: 40351.742926s
	iters: 764, epoch: 11 | train_loss : 0.0047
	speed: 0.109957s/iter; left time: 8321.204391s
	iters: 1146, epoch: 11 | train_loss : 0.0043
	speed: 0.109119s/iter; left time: 8216.143695s
	iters: 1528, epoch: 11 | train_loss : 0.0039
	speed: 0.082827s/iter; left time: 6204.818731s
	iters: 1910, epoch: 11 | train_loss : 0.0080
	speed: 0.075595s/iter; left time: 5634.155596s
data: {'predict': array([0.52491153, 0.52427417, 0.52356724, ..., 0.36989767, 0.37116512,
       0.37135487]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:18:09] [32mIntermediate result: 0.13659313321113586  (Index 10)[0m
Epoch: 11 | cost time: 330.29900074005127 | valid_loss: 0.13659313321113586 | valid_loss_true: 0.028741794352970366
Pretest loss in this epoch: 0.13601125854127094
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0039
	speed: 0.449062s/iter; left time: 33297.013756s
	iters: 764, epoch: 12 | train_loss : 0.0095
	speed: 0.044432s/iter; left time: 3277.574390s
	iters: 1146, epoch: 12 | train_loss : 0.0049
	speed: 0.046995s/iter; left time: 3448.664184s
	iters: 1528, epoch: 12 | train_loss : 0.0048
	speed: 0.045296s/iter; left time: 3306.705604s
	iters: 1910, epoch: 12 | train_loss : 0.0044
	speed: 0.042481s/iter; left time: 3084.950994s
data: {'predict': array([0.51946925, 0.51881929, 0.51811507, ..., 0.36746002, 0.36873518,
       0.36895261]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:22:14] [32mIntermediate result: 0.1424318552017212  (Index 11)[0m
Epoch: 12 | cost time: 244.66857075691223 | valid_loss: 0.1424318552017212 | valid_loss_true: 0.03048153552900861
Pretest loss in this epoch: 0.13324774964558994
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0102
	speed: 0.503258s/iter; left time: 36353.837406s
	iters: 764, epoch: 13 | train_loss : 0.0062
	speed: 0.120864s/iter; left time: 8684.669445s
	iters: 1146, epoch: 13 | train_loss : 0.0206
	speed: 0.099494s/iter; left time: 7111.111136s
	iters: 1528, epoch: 13 | train_loss : 0.0050
	speed: 0.097505s/iter; left time: 6931.755793s
	iters: 1910, epoch: 13 | train_loss : 0.0032
	speed: 0.097308s/iter; left time: 6880.542791s
data: {'predict': array([0.52599221, 0.52526862, 0.52459247, ..., 0.36462155, 0.3659513 ,
       0.36618436]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:28:22] [32mIntermediate result: 0.1400757133960724  (Index 12)[0m
Epoch: 13 | cost time: 368.0703716278076 | valid_loss: 0.1400757133960724 | valid_loss_true: 0.02943889736865849
Pretest loss in this epoch: 0.1286303533827017
Early stop with best valid_loss: 0.1400757133960724
[2024-03-06 19:28:22] [32mFinal result: 0.13405801355838776[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 19:28:27.430005: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 19:28:27.430076: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 19:28:27.431847: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 19:28:27.441087: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 19:28:28.537987: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0280
	speed: 0.016462s/iter; left time: 1566.640146s
	iters: 764, epoch: 1 | train_loss : 0.0047
	speed: 0.012903s/iter; left time: 1223.035837s
	iters: 1146, epoch: 1 | train_loss : 0.0044
	speed: 0.013216s/iter; left time: 1247.683344s
	iters: 1528, epoch: 1 | train_loss : 0.0033
	speed: 0.012844s/iter; left time: 1207.586009s
	iters: 1910, epoch: 1 | train_loss : 0.0071
	speed: 0.011658s/iter; left time: 1091.634348s
data: {'predict': array([136.92096468, 136.85941843, 136.74184917, ..., 121.58752585,
       121.63926681, 121.46924704]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:31:10] [32mIntermediate result: 0.03461726754903793  (Index 0)[0m
Epoch: 1 | cost time: 156.262286901474 | valid_loss: 0.03461726754903793 | valid_loss_true: 1.4125377203944876
Pretest loss in this epoch: 23.393966468152726
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0051
	speed: 0.356056s/iter; left time: 33205.028999s
	iters: 764, epoch: 2 | train_loss : 0.0010
	speed: 0.009571s/iter; left time: 888.904595s
	iters: 1146, epoch: 2 | train_loss : 0.0047
	speed: 0.009581s/iter; left time: 886.229848s
	iters: 1528, epoch: 2 | train_loss : 0.0011
	speed: 0.009931s/iter; left time: 914.725074s
	iters: 1910, epoch: 2 | train_loss : 0.0015
	speed: 0.009280s/iter; left time: 851.268890s
data: {'predict': array([135.78821981, 135.72158034, 135.59534214, ..., 123.23438969,
       123.31890843, 123.17054189]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:33:52] [32mIntermediate result: 0.03372935578227043  (Index 1)[0m
Epoch: 2 | cost time: 161.31502866744995 | valid_loss: 0.03372935578227043 | valid_loss_true: 1.4474748840545442
Pretest loss in this epoch: 24.109959949680157
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0008
	speed: 0.409359s/iter; left time: 37393.751874s
	iters: 764, epoch: 3 | train_loss : 0.0021
	speed: 0.035887s/iter; left time: 3264.503860s
	iters: 1146, epoch: 3 | train_loss : 0.0009
	speed: 0.033035s/iter; left time: 2992.419578s
	iters: 1528, epoch: 3 | train_loss : 0.0014
	speed: 0.028476s/iter; left time: 2568.600479s
	iters: 1910, epoch: 3 | train_loss : 0.0016
	speed: 0.024561s/iter; left time: 2206.068799s
data: {'predict': array([135.13308724, 135.05195515, 134.90711251, ..., 122.25899547,
       122.36172042, 122.2013949 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:37:12] [32mIntermediate result: 0.028472838923335075  (Index 2)[0m
Epoch: 3 | cost time: 200.2835943698883 | valid_loss: 0.028472838923335075 | valid_loss_true: 1.2961364816114906
Pretest loss in this epoch: 22.600511039011327
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0020
	speed: 0.390154s/iter; left time: 34893.774102s
	iters: 764, epoch: 4 | train_loss : 0.0011
	speed: 0.018219s/iter; left time: 1622.468357s
	iters: 1146, epoch: 4 | train_loss : 0.0005
	speed: 0.025528s/iter; left time: 2263.625815s
	iters: 1528, epoch: 4 | train_loss : 0.0008
	speed: 0.040820s/iter; left time: 3604.019131s
	iters: 1910, epoch: 4 | train_loss : 0.0008
	speed: 0.044420s/iter; left time: 3904.887583s
data: {'predict': array([134.77011528, 134.69421778, 134.55634164, ..., 122.79580829,
       122.89951229, 122.75735293]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:40:31] [32mIntermediate result: 0.02588130347430706  (Index 3)[0m
Epoch: 4 | cost time: 199.1658296585083 | valid_loss: 0.02588130347430706 | valid_loss_true: 1.1696273661176881
Pretest loss in this epoch: 24.286462720050963
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0009
	speed: 0.380024s/iter; left time: 33261.625727s
	iters: 764, epoch: 5 | train_loss : 0.0062
	speed: 0.011215s/iter; left time: 977.291961s
	iters: 1146, epoch: 5 | train_loss : 0.0012
	speed: 0.010451s/iter; left time: 906.740545s
	iters: 1528, epoch: 5 | train_loss : 0.0008
	speed: 0.009385s/iter; left time: 810.640798s
	iters: 1910, epoch: 5 | train_loss : 0.0008
	speed: 0.008844s/iter; left time: 760.567119s
data: {'predict': array([135.39051549, 135.32812921, 135.19146187, ..., 123.4031179 ,
       123.5190819 , 123.37863088]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:43:07] [32mIntermediate result: 0.028018884360790253  (Index 4)[0m
Epoch: 5 | cost time: 155.4190969467163 | valid_loss: 0.028018884360790253 | valid_loss_true: 1.2844476547136991
Pretest loss in this epoch: 23.194823246774764
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0020
	speed: 0.369338s/iter; left time: 31620.539334s
	iters: 764, epoch: 6 | train_loss : 0.0310
	speed: 0.011418s/iter; left time: 973.156629s
	iters: 1146, epoch: 6 | train_loss : 0.0009
	speed: 0.013866s/iter; left time: 1176.502840s
	iters: 1528, epoch: 6 | train_loss : 0.0006
	speed: 0.013472s/iter; left time: 1137.929412s
	iters: 1910, epoch: 6 | train_loss : 0.0006
	speed: 0.013713s/iter; left time: 1153.095330s
data: {'predict': array([135.55058005, 135.48687304, 135.3657681 , ..., 123.98409901,
       124.09644604, 123.97037926]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:45:55] [32mIntermediate result: 0.027552202343940735  (Index 5)[0m
Epoch: 6 | cost time: 167.9107789993286 | valid_loss: 0.027552202343940735 | valid_loss_true: 1.2618123702815043
Pretest loss in this epoch: 25.161893699829722
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0006
	speed: 0.436631s/iter; left time: 36547.301594s
	iters: 764, epoch: 7 | train_loss : 0.0004
	speed: 0.038862s/iter; left time: 3238.030163s
	iters: 1146, epoch: 7 | train_loss : 0.0007
	speed: 0.039777s/iter; left time: 3299.089961s
	iters: 1528, epoch: 7 | train_loss : 0.0005
	speed: 0.037242s/iter; left time: 3074.625719s
	iters: 1910, epoch: 7 | train_loss : 0.0010
	speed: 0.040204s/iter; left time: 3303.739757s
data: {'predict': array([134.96263479, 134.90174124, 134.77159859, ..., 124.5263314 ,
       124.63450419, 124.51816906]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:49:43] [32mIntermediate result: 0.025739192962646484  (Index 6)[0m
Epoch: 7 | cost time: 228.90957903862 | valid_loss: 0.025739192962646484 | valid_loss_true: 1.1714587838263772
Pretest loss in this epoch: 26.022728440481018
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0008
	speed: 0.392304s/iter; left time: 32087.343301s
	iters: 764, epoch: 8 | train_loss : 0.0017
	speed: 0.012673s/iter; left time: 1031.742344s
	iters: 1146, epoch: 8 | train_loss : 0.0025
	speed: 0.011595s/iter; left time: 939.505967s
	iters: 1528, epoch: 8 | train_loss : 0.0007
	speed: 0.010729s/iter; left time: 865.254927s
	iters: 1910, epoch: 8 | train_loss : 0.0007
	speed: 0.011716s/iter; left time: 940.375635s
data: {'predict': array([135.14484888, 135.08147883, 134.95579436, ..., 124.96677842,
       125.07493413, 124.96083575]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:52:16] [32mIntermediate result: 0.026179345324635506  (Index 7)[0m
Epoch: 8 | cost time: 152.6732795238495 | valid_loss: 0.026179345324635506 | valid_loss_true: 1.1832049462723593
Pretest loss in this epoch: 26.738687164334404
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0007
	speed: 0.356747s/iter; left time: 28497.276795s
	iters: 764, epoch: 9 | train_loss : 0.0009
	speed: 0.013745s/iter; left time: 1092.720620s
	iters: 1146, epoch: 9 | train_loss : 0.0020
	speed: 0.013117s/iter; left time: 1037.817198s
	iters: 1528, epoch: 9 | train_loss : 0.0007
	speed: 0.011689s/iter; left time: 920.354750s
	iters: 1910, epoch: 9 | train_loss : 0.0021
	speed: 0.016169s/iter; left time: 1266.896360s
data: {'predict': array([135.35171729, 135.29191708, 135.16965754, ..., 125.35209668,
       125.46287793, 125.35091085]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:55:09] [32mIntermediate result: 0.02645927667617798  (Index 8)[0m
Epoch: 9 | cost time: 172.7027554512024 | valid_loss: 0.02645927667617798 | valid_loss_true: 1.1869665484051322
Pretest loss in this epoch: 26.397139912712575
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0005
	speed: 0.405303s/iter; left time: 31601.473608s
	iters: 764, epoch: 10 | train_loss : 0.0008
	speed: 0.018107s/iter; left time: 1404.849341s
	iters: 1146, epoch: 10 | train_loss : 0.0003
	speed: 0.015483s/iter; left time: 1195.343289s
	iters: 1528, epoch: 10 | train_loss : 0.0003
	speed: 0.015996s/iter; left time: 1228.893575s
	iters: 1910, epoch: 10 | train_loss : 0.0005
	speed: 0.014209s/iter; left time: 1086.144882s
data: {'predict': array([135.25855846, 135.19301469, 135.07087297, ..., 125.81282584,
       125.92254026, 125.81381786]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:58:12] [32mIntermediate result: 0.02694375067949295  (Index 9)[0m
Epoch: 10 | cost time: 183.21968150138855 | valid_loss: 0.02694375067949295 | valid_loss_true: 1.2116062752730166
Pretest loss in this epoch: 27.63971521246624
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0007
	speed: 0.409562s/iter; left time: 31150.878754s
	iters: 764, epoch: 11 | train_loss : 0.0005
	speed: 0.018964s/iter; left time: 1435.128314s
	iters: 1146, epoch: 11 | train_loss : 0.0004
	speed: 0.013104s/iter; left time: 986.656329s
	iters: 1528, epoch: 11 | train_loss : 0.0005
	speed: 0.016023s/iter; left time: 1200.312568s
	iters: 1910, epoch: 11 | train_loss : 0.0010
	speed: 0.015896s/iter; left time: 1184.728786s
data: {'predict': array([135.27862736, 135.21193016, 135.0906214 , ..., 126.10483506,
       126.215406  , 126.10904641]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:01:00] [32mIntermediate result: 0.027987167239189148  (Index 10)[0m
Epoch: 11 | cost time: 168.25176167488098 | valid_loss: 0.027987167239189148 | valid_loss_true: 1.244406825211069
Pretest loss in this epoch: 27.809891482896532
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0014
	speed: 0.386573s/iter; left time: 28663.623651s
	iters: 764, epoch: 12 | train_loss : 0.0016
	speed: 0.012941s/iter; left time: 954.628944s
	iters: 1146, epoch: 12 | train_loss : 0.0016
	speed: 0.011219s/iter; left time: 823.259990s
	iters: 1528, epoch: 12 | train_loss : 0.0004
	speed: 0.010150s/iter; left time: 740.956909s
	iters: 1910, epoch: 12 | train_loss : 0.0003
	speed: 0.012389s/iter; left time: 899.694858s
data: {'predict': array([135.25225056, 135.18394281, 135.06025533, ..., 126.52775038,
       126.634702  , 126.5298157 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:03:50] [32mIntermediate result: 0.028463052585721016  (Index 11)[0m
Epoch: 12 | cost time: 169.66095900535583 | valid_loss: 0.028463052585721016 | valid_loss_true: 1.2557405509952642
Pretest loss in this epoch: 29.23953704733096
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0009
	speed: 0.383658s/iter; left time: 27714.328532s
	iters: 764, epoch: 13 | train_loss : 0.0008
	speed: 0.012256s/iter; left time: 880.642999s
	iters: 1146, epoch: 13 | train_loss : 0.0044
	speed: 0.019908s/iter; left time: 1422.857811s
	iters: 1528, epoch: 13 | train_loss : 0.0009
	speed: 0.019291s/iter; left time: 1371.427323s
	iters: 1910, epoch: 13 | train_loss : 0.0003
	speed: 0.014427s/iter; left time: 1020.091801s
data: {'predict': array([135.1801821 , 135.11031917, 134.98459935, ..., 126.56756357,
       126.67515376, 126.56841598]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:06:44] [32mIntermediate result: 0.029128972440958023  (Index 12)[0m
Epoch: 13 | cost time: 173.71039462089539 | valid_loss: 0.029128972440958023 | valid_loss_true: 1.2739557978126126
Pretest loss in this epoch: 29.695562702214236
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0010
	speed: 0.387891s/iter; left time: 27278.835316s
	iters: 764, epoch: 14 | train_loss : 0.0016
	speed: 0.010637s/iter; left time: 744.011831s
	iters: 1146, epoch: 14 | train_loss : 0.0009
	speed: 0.009548s/iter; left time: 664.153056s
	iters: 1528, epoch: 14 | train_loss : 0.0015
	speed: 0.011555s/iter; left time: 799.356688s
	iters: 1910, epoch: 14 | train_loss : 0.0005
	speed: 0.012989s/iter; left time: 893.590419s
data: {'predict': array([135.24252597, 135.17202447, 135.05178785, ..., 127.18601333,
       127.28853151, 127.18536652]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:09:27] [32mIntermediate result: 0.02956555411219597  (Index 13)[0m
Epoch: 14 | cost time: 163.11388492584229 | valid_loss: 0.02956555411219597 | valid_loss_true: 1.2905910889478476
Pretest loss in this epoch: 31.16642630477168
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0005
	speed: 0.424021s/iter; left time: 29009.406836s
	iters: 764, epoch: 15 | train_loss : 0.0004
	speed: 0.055127s/iter; left time: 3750.451985s
	iters: 1146, epoch: 15 | train_loss : 0.0021
	speed: 0.055287s/iter; left time: 3740.251096s
	iters: 1528, epoch: 15 | train_loss : 0.0004
	speed: 0.035499s/iter; left time: 2387.983057s
	iters: 1910, epoch: 15 | train_loss : 0.0013
	speed: 0.014083s/iter; left time: 941.986011s
data: {'predict': array([135.39641693, 135.3253994 , 135.19985631, ..., 127.31703844,
       127.42130266, 127.31589797]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:13:18] [32mIntermediate result: 0.028921492397785187  (Index 14)[0m
Epoch: 15 | cost time: 231.62994837760925 | valid_loss: 0.028921492397785187 | valid_loss_true: 1.2692834303987561
Pretest loss in this epoch: 31.557357660565728
Early stop with best valid_loss: 0.028921492397785187
[2024-03-06 20:13:18] [32mFinal result: 0.025739192962646484[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_lstm --model_name alumina_lstm --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/lstm --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_lstm/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_lstm/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/lstm', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度', target_cols='1效出料温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_lstm', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 20:13:23.786945: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 20:13:23.787020: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 20:13:23.788767: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 20:13:23.798179: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 20:13:24.783656: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0000
	speed: 0.034856s/iter; left time: 3317.234649s
	iters: 764, epoch: 1 | train_loss : 0.0000
	speed: 0.028954s/iter; left time: 2744.479221s
	iters: 1146, epoch: 1 | train_loss : 0.0000
	speed: 0.032783s/iter; left time: 3094.915199s
	iters: 1528, epoch: 1 | train_loss : 0.0000
	speed: 0.036459s/iter; left time: 3428.012638s
	iters: 1910, epoch: 1 | train_loss : 0.0000
	speed: 0.038072s/iter; left time: 3565.100912s
data: {'predict': array([148.74831143, 148.74831144, 148.74831142, ..., 148.74831162,
       148.74831161, 148.74831161]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:16:52] [32mIntermediate result: 0.0012977661099284887  (Index 0)[0m
Epoch: 1 | cost time: 201.80160355567932 | valid_loss: 0.0012977661099284887 | valid_loss_true: 5.1468936222981155e-05
Pretest loss in this epoch: 14.470667646402969
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0000
	speed: 0.374965s/iter; left time: 34968.495565s
	iters: 764, epoch: 2 | train_loss : 0.0000
	speed: 0.012348s/iter; left time: 1146.841048s
	iters: 1146, epoch: 2 | train_loss : 0.0000
	speed: 0.012692s/iter; left time: 1173.943799s
	iters: 1528, epoch: 2 | train_loss : 0.0000
	speed: 0.012542s/iter; left time: 1155.305899s
	iters: 1910, epoch: 2 | train_loss : 0.0000
	speed: 0.011514s/iter; left time: 1056.170597s
data: {'predict': array([148.74825205, 148.74825205, 148.74825204, ..., 148.74825218,
       148.74825217, 148.74825218]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:19:39] [32mIntermediate result: 0.0010627186857163906  (Index 1)[0m
Epoch: 2 | cost time: 166.80879926681519 | valid_loss: 0.0010627186857163906 | valid_loss_true: 7.918996577424494e-06
Pretest loss in this epoch: 14.470631549721075
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0000
	speed: 0.391808s/iter; left time: 35790.480522s
	iters: 764, epoch: 3 | train_loss : 0.0000
	speed: 0.014087s/iter; left time: 1281.433306s
	iters: 1146, epoch: 3 | train_loss : 0.0000
	speed: 0.014770s/iter; left time: 1337.935821s
	iters: 1528, epoch: 3 | train_loss : 0.0000
	speed: 0.013982s/iter; left time: 1261.188538s
	iters: 1910, epoch: 3 | train_loss : 0.0000
	speed: 0.013304s/iter; left time: 1194.969478s
data: {'predict': array([148.74826063, 148.74826063, 148.74826062, ..., 148.74826073,
       148.74826073, 148.74826073]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:22:34] [32mIntermediate result: 0.0007323457975871861  (Index 2)[0m
Epoch: 3 | cost time: 175.22831535339355 | valid_loss: 0.0007323457975871861 | valid_loss_true: 6.605427823072032e-07
Pretest loss in this epoch: 14.470636733615851
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0000
	speed: 0.396663s/iter; left time: 35475.958416s
	iters: 764, epoch: 4 | train_loss : 0.0000
	speed: 0.012664s/iter; left time: 1127.794565s
	iters: 1146, epoch: 4 | train_loss : 0.0000
	speed: 0.012240s/iter; left time: 1085.316926s
	iters: 1528, epoch: 4 | train_loss : 0.0000
	speed: 0.012492s/iter; left time: 1102.908166s
	iters: 1910, epoch: 4 | train_loss : 0.0000
	speed: 0.012124s/iter; left time: 1065.839699s
data: {'predict': array([148.74827642, 148.74827643, 148.74827642, ..., 148.7482765 ,
       148.7482765 , 148.7482765 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:25:16] [32mIntermediate result: 0.0006475546397268772  (Index 3)[0m
Epoch: 4 | cost time: 162.1900932788849 | valid_loss: 0.0006475546397268772 | valid_loss_true: 1.6455371291442677e-05
Pretest loss in this epoch: 14.470646304753112
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0000
	speed: 0.376733s/iter; left time: 32973.557332s
	iters: 764, epoch: 5 | train_loss : 0.0000
	speed: 0.013039s/iter; left time: 1136.299924s
	iters: 1146, epoch: 5 | train_loss : 0.0000
	speed: 0.012857s/iter; left time: 1115.457065s
	iters: 1528, epoch: 5 | train_loss : 0.0000
	speed: 0.010156s/iter; left time: 877.222736s
	iters: 1910, epoch: 5 | train_loss : 0.0000
	speed: 0.008841s/iter; left time: 760.287104s
data: {'predict': array([148.74826158, 148.74826159, 148.74826158, ..., 148.74826163,
       148.74826164, 148.74826164]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:27:59] [32mIntermediate result: 0.0004669336194638163  (Index 4)[0m
Epoch: 5 | cost time: 163.14548254013062 | valid_loss: 0.0004669336194638163 | valid_loss_true: 1.6065376740108283e-06
Pretest loss in this epoch: 14.470637274489398
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0000
	speed: 0.421547s/iter; left time: 36090.299985s
	iters: 764, epoch: 6 | train_loss : 0.0000
	speed: 0.021873s/iter; left time: 1864.288827s
	iters: 1146, epoch: 6 | train_loss : 0.0000
	speed: 0.023824s/iter; left time: 2021.464090s
	iters: 1528, epoch: 6 | train_loss : 0.0000
	speed: 0.024477s/iter; left time: 2067.512588s
	iters: 1910, epoch: 6 | train_loss : 0.0000
	speed: 0.022065s/iter; left time: 1855.328128s
data: {'predict': array([148.74824569, 148.74824569, 148.74824569, ..., 148.74824575,
       148.74824573, 148.74824573]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:31:12] [32mIntermediate result: 0.00046970165567472577  (Index 5)[0m
Epoch: 6 | cost time: 192.49244928359985 | valid_loss: 0.00046970165567472577 | valid_loss_true: 1.4287152269433206e-05
Pretest loss in this epoch: 14.47062761897433
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0000
	speed: 0.383248s/iter; left time: 32079.016193s
	iters: 764, epoch: 7 | train_loss : 0.0000
	speed: 0.022833s/iter; left time: 1902.496240s
	iters: 1146, epoch: 7 | train_loss : 0.0000
	speed: 0.021777s/iter; left time: 1806.194136s
	iters: 1528, epoch: 7 | train_loss : 0.0000
	speed: 0.012506s/iter; left time: 1032.441305s
	iters: 1910, epoch: 7 | train_loss : 0.0000
	speed: 0.012792s/iter; left time: 1051.175315s
data: {'predict': array([148.74824499, 148.74824499, 148.74824499, ..., 148.74824502,
       148.74824501, 148.74824501]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:34:01] [32mIntermediate result: 0.0004643489373847842  (Index 6)[0m
Epoch: 7 | cost time: 168.99231266975403 | valid_loss: 0.0004643489373847842 | valid_loss_true: 1.500024246398217e-05
Pretest loss in this epoch: 14.470627175472993
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0000
	speed: 0.381820s/iter; left time: 31229.785116s
	iters: 764, epoch: 8 | train_loss : 0.0000
	speed: 0.053251s/iter; left time: 4335.144854s
	iters: 1146, epoch: 8 | train_loss : 0.0000
	speed: 0.029381s/iter; left time: 2380.694435s
	iters: 1528, epoch: 8 | train_loss : 0.0000
	speed: 0.013169s/iter; left time: 1062.053572s
	iters: 1910, epoch: 8 | train_loss : 0.0000
	speed: 0.029978s/iter; left time: 2406.130301s
data: {'predict': array([148.74825117, 148.74825116, 148.74825117, ..., 148.74825119,
       148.74825119, 148.74825119]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:37:21] [32mIntermediate result: 0.0003605248930398375  (Index 7)[0m
Epoch: 8 | cost time: 200.09719347953796 | valid_loss: 0.0003605248930398375 | valid_loss_true: 8.81772928828356e-06
Pretest loss in this epoch: 14.470630931448923
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0000
	speed: 0.389159s/iter; left time: 31086.429900s
	iters: 764, epoch: 9 | train_loss : 0.0000
	speed: 0.029042s/iter; left time: 2308.830543s
	iters: 1146, epoch: 9 | train_loss : 0.0000
	speed: 0.027048s/iter; left time: 2139.923768s
	iters: 1528, epoch: 9 | train_loss : 0.0000
	speed: 0.029551s/iter; left time: 2326.683724s
	iters: 1910, epoch: 9 | train_loss : 0.0000
	speed: 0.015787s/iter; left time: 1236.959187s
data: {'predict': array([148.74826715, 148.74826715, 148.74826715, ..., 148.74826717,
       148.74826717, 148.74826717]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:40:34] [32mIntermediate result: 0.0003477366117294878  (Index 8)[0m
Epoch: 9 | cost time: 192.7499804496765 | valid_loss: 0.0003477366117294878 | valid_loss_true: 7.164321584163947e-06
Pretest loss in this epoch: 14.470640636182772
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0000
	speed: 0.408327s/iter; left time: 31837.235872s
	iters: 764, epoch: 10 | train_loss : 0.0000
	speed: 0.029742s/iter; left time: 2307.660842s
	iters: 1146, epoch: 10 | train_loss : 0.0000
	speed: 0.038613s/iter; left time: 2981.141966s
	iters: 1528, epoch: 10 | train_loss : 0.0000
	speed: 0.040849s/iter; left time: 3138.219662s
	iters: 1910, epoch: 10 | train_loss : 0.0000
	speed: 0.036459s/iter; left time: 2786.976765s
data: {'predict': array([148.74825805, 148.74825805, 148.74825804, ..., 148.74825807,
       148.74825806, 148.74825807]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:43:58] [32mIntermediate result: 0.000343554827850312  (Index 9)[0m
Epoch: 10 | cost time: 204.14431524276733 | valid_loss: 0.000343554827850312 | valid_loss_true: 1.9422528512182077e-06
Pretest loss in this epoch: 14.470635103540467
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0000
	speed: 0.372748s/iter; left time: 28350.817856s
	iters: 764, epoch: 11 | train_loss : 0.0000
	speed: 0.013306s/iter; left time: 1006.986490s
	iters: 1146, epoch: 11 | train_loss : 0.0000
	speed: 0.011923s/iter; left time: 897.727610s
	iters: 1528, epoch: 11 | train_loss : 0.0000
	speed: 0.010932s/iter; left time: 818.954379s
	iters: 1910, epoch: 11 | train_loss : 0.0000
	speed: 0.010744s/iter; left time: 800.767761s
data: {'predict': array([148.74824312, 148.74824313, 148.74824313, ..., 148.74824315,
       148.74824315, 148.74824315]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:46:31] [32mIntermediate result: 0.0003193608717992902  (Index 10)[0m
Epoch: 11 | cost time: 153.44683623313904 | valid_loss: 0.0003193608717992902 | valid_loss_true: 1.685613867576036e-05
Pretest loss in this epoch: 14.47062604741754
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0000
	speed: 0.368819s/iter; left time: 27347.170171s
	iters: 764, epoch: 12 | train_loss : 0.0000
	speed: 0.024147s/iter; left time: 1781.216460s
	iters: 1146, epoch: 12 | train_loss : 0.0000
	speed: 0.022636s/iter; left time: 1661.123185s
	iters: 1528, epoch: 12 | train_loss : 0.0000
	speed: 0.026351s/iter; left time: 1923.661350s
	iters: 1910, epoch: 12 | train_loss : 0.0000
	speed: 0.012946s/iter; left time: 940.142166s
data: {'predict': array([148.74825353, 148.74825354, 148.74825353, ..., 148.74825356,
       148.74825356, 148.74825356]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:49:38] [32mIntermediate result: 0.00031146479886956513  (Index 11)[0m
Epoch: 12 | cost time: 187.06563925743103 | valid_loss: 0.00031146479886956513 | valid_loss_true: 6.452624838591791e-06
Pretest loss in this epoch: 14.470632363830486
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-11.pth
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0000
	speed: 0.390849s/iter; left time: 28233.790673s
	iters: 764, epoch: 13 | train_loss : 0.0000
	speed: 0.015227s/iter; left time: 1094.123941s
	iters: 1146, epoch: 13 | train_loss : 0.0000
	speed: 0.015129s/iter; left time: 1081.338533s
	iters: 1528, epoch: 13 | train_loss : 0.0000
	speed: 0.014941s/iter; left time: 1062.162924s
	iters: 1910, epoch: 13 | train_loss : 0.0000
	speed: 0.015365s/iter; left time: 1086.467672s
data: {'predict': array([148.74826516, 148.74826516, 148.74826515, ..., 148.74826518,
       148.74826518, 148.74826518]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:52:22] [32mIntermediate result: 0.0003084033669438213  (Index 12)[0m
Epoch: 13 | cost time: 163.09171533584595 | valid_loss: 0.0003084033669438213 | valid_loss_true: 5.172890592047645e-06
Pretest loss in this epoch: 14.470639421375616
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-12.pth
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0000
	speed: 0.405728s/iter; left time: 28533.228425s
	iters: 764, epoch: 14 | train_loss : 0.0000
	speed: 0.052994s/iter; left time: 3706.629779s
	iters: 1146, epoch: 14 | train_loss : 0.0000
	speed: 0.047419s/iter; left time: 3298.574505s
	iters: 1528, epoch: 14 | train_loss : 0.0000
	speed: 0.048050s/iter; left time: 3324.082750s
	iters: 1910, epoch: 14 | train_loss : 0.0000
	speed: 0.047333s/iter; left time: 3256.381784s
data: {'predict': array([148.74825913, 148.74825912, 148.74825912, ..., 148.74825914,
       148.74825914, 148.74825914]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:56:38] [32mIntermediate result: 0.0002994279202539474  (Index 13)[0m
Epoch: 14 | cost time: 256.89101338386536 | valid_loss: 0.0002994279202539474 | valid_loss_true: 8.639178203993987e-07
Pretest loss in this epoch: 14.470635755280492
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-13.pth
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0000
	speed: 0.512606s/iter; left time: 35069.916118s
	iters: 764, epoch: 15 | train_loss : 0.0000
	speed: 0.129998s/iter; left time: 8844.145179s
	iters: 1146, epoch: 15 | train_loss : 0.0000
	speed: 0.122966s/iter; left time: 8318.741531s
	iters: 1528, epoch: 15 | train_loss : 0.0000
	speed: 0.091785s/iter; left time: 6174.317469s
	iters: 1910, epoch: 15 | train_loss : 0.0000
	speed: 0.086223s/iter; left time: 5767.169623s
data: {'predict': array([148.74826373, 148.74826373, 148.74826373, ..., 148.74826376,
       148.74826376, 148.74826376]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:02:48] [32mIntermediate result: 0.0003100520989391953  (Index 14)[0m
Epoch: 15 | cost time: 369.76439332962036 | valid_loss: 0.0003100520989391953 | valid_loss_true: 3.7487816776269496e-06
Pretest loss in this epoch: 14.470638557303273
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0000
	speed: 0.525380s/iter; left time: 34939.898401s
	iters: 764, epoch: 16 | train_loss : 0.0000
	speed: 0.095066s/iter; left time: 6285.929210s
	iters: 1146, epoch: 16 | train_loss : 0.0000
	speed: 0.099808s/iter; left time: 6561.346008s
	iters: 1528, epoch: 16 | train_loss : 0.0000
	speed: 0.122595s/iter; left time: 8012.592362s
	iters: 1910, epoch: 16 | train_loss : 0.0000
	speed: 0.117114s/iter; left time: 7609.629942s
data: {'predict': array([148.74825481, 148.74825482, 148.74825481, ..., 148.74825483,
       148.74825483, 148.74825484]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:09:10] [32mIntermediate result: 0.0003136956656817347  (Index 15)[0m
Epoch: 16 | cost time: 381.41862893104553 | valid_loss: 0.0003136956656817347 | valid_loss_true: 5.174154208589902e-06
Pretest loss in this epoch: 14.470633139034703
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0000
	speed: 0.566397s/iter; left time: 36585.305189s
	iters: 764, epoch: 17 | train_loss : 0.0000
	speed: 0.084351s/iter; left time: 5416.251504s
	iters: 1146, epoch: 17 | train_loss : 0.0000
	speed: 0.094170s/iter; left time: 6010.770710s
	iters: 1528, epoch: 17 | train_loss : 0.0000
	speed: 0.094987s/iter; left time: 6026.614044s
	iters: 1910, epoch: 17 | train_loss : 0.0000
	speed: 0.115265s/iter; left time: 7269.192062s
data: {'predict': array([148.7482611 , 148.74826111, 148.74826111, ..., 148.74826113,
       148.74826112, 148.74826112]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:15:53] [32mIntermediate result: 0.000300780578982085  (Index 16)[0m
Epoch: 17 | cost time: 403.0391306877136 | valid_loss: 0.000300780578982085 | valid_loss_true: 1.1105857590091781e-06
Pretest loss in this epoch: 14.470636954708773
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0000
	speed: 0.692084s/iter; left time: 43381.221517s
	iters: 764, epoch: 18 | train_loss : 0.0000
	speed: 0.104939s/iter; left time: 6537.690338s
	iters: 1146, epoch: 18 | train_loss : 0.0000
	speed: 0.094516s/iter; left time: 5852.245410s
	iters: 1528, epoch: 18 | train_loss : 0.0000
	speed: 0.084064s/iter; left time: 5172.940793s
	iters: 1910, epoch: 18 | train_loss : 0.0000
	speed: 0.085280s/iter; left time: 5215.205348s
data: {'predict': array([148.74825485, 148.74825485, 148.74825485, ..., 148.74825487,
       148.74825487, 148.74825487]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:22:05] [32mIntermediate result: 0.0003015752008650452  (Index 17)[0m
Epoch: 18 | cost time: 372.53837180137634 | valid_loss: 0.0003015752008650452 | valid_loss_true: 5.1347545947785366e-06
Pretest loss in this epoch: 14.470633162416314
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0000
	speed: 0.600263s/iter; left time: 36478.568294s
	iters: 764, epoch: 19 | train_loss : 0.0000
	speed: 0.078375s/iter; left time: 4732.990625s
	iters: 1146, epoch: 19 | train_loss : 0.0000
	speed: 0.095321s/iter; left time: 5719.950726s
	iters: 1528, epoch: 19 | train_loss : 0.0000
	speed: 0.091271s/iter; left time: 5442.017470s
	iters: 1910, epoch: 19 | train_loss : 0.0000
	speed: 0.083694s/iter; left time: 4958.262966s
data: {'predict': array([148.74824864, 148.74824865, 148.74824864, ..., 148.74824866,
       148.74824866, 148.74824866]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:28:23] [32mIntermediate result: 0.00029622224974446  (Index 18)[0m
Epoch: 19 | cost time: 377.931987285614 | valid_loss: 0.00029622224974446 | valid_loss_true: 1.1349324962883875e-05
Pretest loss in this epoch: 14.470629389524623
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-18.pth
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0000
	speed: 0.625561s/iter; left time: 36820.540344s
	iters: 764, epoch: 20 | train_loss : 0.0000
	speed: 0.091500s/iter; left time: 5350.765588s
	iters: 1146, epoch: 20 | train_loss : 0.0000
	speed: 0.092573s/iter; left time: 5378.103669s
	iters: 1528, epoch: 20 | train_loss : 0.0000
	speed: 0.087621s/iter; left time: 5056.970017s
	iters: 1910, epoch: 20 | train_loss : 0.0000
	speed: 0.079396s/iter; left time: 4551.918738s
data: {'predict': array([148.74824161, 148.74824161, 148.74824161, ..., 148.74824162,
       148.74824162, 148.74824161]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:35:01] [32mIntermediate result: 0.0003104865609202534  (Index 19)[0m
Epoch: 20 | cost time: 397.4721746444702 | valid_loss: 0.0003104865609202534 | valid_loss_true: 1.8382060626836933e-05
Pretest loss in this epoch: 14.470625115789431
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0000
	speed: 0.694039s/iter; left time: 39524.821552s
	iters: 764, epoch: 21 | train_loss : 0.0000
	speed: 0.079263s/iter; left time: 4483.672802s
	iters: 1146, epoch: 21 | train_loss : 0.0000
	speed: 0.072080s/iter; left time: 4049.796770s
	iters: 1528, epoch: 21 | train_loss : 0.0000
	speed: 0.066779s/iter; left time: 3726.463973s
	iters: 1910, epoch: 21 | train_loss : 0.0000
	speed: 0.071579s/iter; left time: 3966.980905s
data: {'predict': array([148.74824903, 148.74824904, 148.74824903, ..., 148.74824905,
       148.74824905, 148.74824906]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:40:41] [32mIntermediate result: 0.0003033447719644755  (Index 20)[0m
Epoch: 21 | cost time: 340.60326862335205 | valid_loss: 0.0003033447719644755 | valid_loss_true: 1.0958219503844467e-05
Pretest loss in this epoch: 14.470629626391252
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0000
	speed: 0.627477s/iter; left time: 34535.061086s
	iters: 764, epoch: 22 | train_loss : 0.0000
	speed: 0.118524s/iter; left time: 6478.064441s
	iters: 1146, epoch: 22 | train_loss : 0.0000
	speed: 0.125320s/iter; left time: 6801.592927s
	iters: 1528, epoch: 22 | train_loss : 0.0000
	speed: 0.088158s/iter; left time: 4751.016430s
	iters: 1910, epoch: 22 | train_loss : 0.0000
	speed: 0.087596s/iter; left time: 4687.257661s
data: {'predict': array([148.74825832, 148.74825832, 148.74825832, ..., 148.74825834,
       148.74825834, 148.74825835]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:47:17] [32mIntermediate result: 0.0002898007514886558  (Index 21)[0m
Epoch: 22 | cost time: 395.3366873264313 | valid_loss: 0.0002898007514886558 | valid_loss_true: 1.6664394052010856e-06
Pretest loss in this epoch: 14.470635270643886
Chepoint Saved at:  ./checkpoints/allfeature/lstm/alumina_lstm/STANDALONE/checkpoint-21.pth
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0000
	speed: 0.624030s/iter; left time: 33152.823056s
	iters: 764, epoch: 23 | train_loss : 0.0000
	speed: 0.127977s/iter; left time: 6750.162297s
	iters: 1146, epoch: 23 | train_loss : 0.0000
	speed: 0.126194s/iter; left time: 6607.901860s
	iters: 1528, epoch: 23 | train_loss : 0.0000
	speed: 0.128203s/iter; left time: 6664.127933s
	iters: 1910, epoch: 23 | train_loss : 0.0000
	speed: 0.129757s/iter; left time: 6695.348023s
data: {'predict': array([148.74826122, 148.74826122, 148.74826122, ..., 148.74826123,
       148.74826123, 148.74826123]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:54:26] [32mIntermediate result: 0.00029900760273449123  (Index 22)[0m
Epoch: 23 | cost time: 428.9394042491913 | valid_loss: 0.00029900760273449123 | valid_loss_true: 1.2287437532328074e-06
Pretest loss in this epoch: 14.470637026281715
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 0.0000
	speed: 0.574822s/iter; left time: 29440.072246s
	iters: 764, epoch: 24 | train_loss : 0.0000
	speed: 0.108631s/iter; left time: 5522.156241s
	iters: 1146, epoch: 24 | train_loss : 0.0000
	speed: 0.128234s/iter; left time: 6469.642408s
	iters: 1528, epoch: 24 | train_loss : 0.0000
	speed: 0.134925s/iter; left time: 6755.708829s
	iters: 1910, epoch: 24 | train_loss : 0.0000
	speed: 0.143254s/iter; left time: 7117.985145s
data: {'predict': array([148.74826343, 148.74826343, 148.74826342, ..., 148.74826345,
       148.74826344, 148.74826345]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:02:36] [32mIntermediate result: 0.00029985210858285427  (Index 23)[0m
Epoch: 24 | cost time: 490.1218891143799 | valid_loss: 0.00029985210858285427 | valid_loss_true: 3.440830425973981e-06
Pretest loss in this epoch: 14.470638369716733
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 0.0000
	speed: 0.797998s/iter; left time: 39345.284937s
	iters: 764, epoch: 25 | train_loss : 0.0000
	speed: 0.124587s/iter; left time: 6095.161604s
	iters: 1146, epoch: 25 | train_loss : 0.0000
	speed: 0.097811s/iter; left time: 4747.858681s
	iters: 1528, epoch: 25 | train_loss : 0.0000
	speed: 0.112690s/iter; left time: 5427.048561s
	iters: 1910, epoch: 25 | train_loss : 0.0000
	speed: 0.118565s/iter; left time: 5664.678194s
data: {'predict': array([148.74825696, 148.74825695, 148.74825695, ..., 148.74825696,
       148.74825697, 148.74825697]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:09:39] [32mIntermediate result: 0.00029538353555835783  (Index 24)[0m
Epoch: 25 | cost time: 423.1807062625885 | valid_loss: 0.00029538353555835783 | valid_loss_true: 3.0367111760393946e-06
Pretest loss in this epoch: 14.470634435826186
Adjusting learning rate of group 0 to 1.7198e-06.
	iters: 382, epoch: 26 | train_loss : 0.0000
	speed: 0.650575s/iter; left time: 30833.363114s
	iters: 764, epoch: 26 | train_loss : 0.0000
	speed: 0.115931s/iter; left time: 5450.155643s
	iters: 1146, epoch: 26 | train_loss : 0.0000
	speed: 0.118234s/iter; left time: 5513.248086s
	iters: 1528, epoch: 26 | train_loss : 0.0000
	speed: 0.114430s/iter; left time: 5292.170418s
	iters: 1910, epoch: 26 | train_loss : 0.0000
	speed: 0.111761s/iter; left time: 5126.016120s
data: {'predict': array([148.7482599 , 148.7482599 , 148.7482599 , ..., 148.74825991,
       148.7482599 , 148.74825991]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:16:22] [32mIntermediate result: 0.0003008063940797001  (Index 25)[0m
Epoch: 26 | cost time: 403.31884264945984 | valid_loss: 0.0003008063940797001 | valid_loss_true: 9.308452328066871e-08
Pretest loss in this epoch: 14.470636222549027
Adjusting learning rate of group 0 to 1.4618e-06.
	iters: 382, epoch: 27 | train_loss : 0.0000
	speed: 0.589775s/iter; left time: 26824.742681s
	iters: 764, epoch: 27 | train_loss : 0.0000
	speed: 0.125936s/iter; left time: 5679.858740s
	iters: 1146, epoch: 27 | train_loss : 0.0000
	speed: 0.116538s/iter; left time: 5211.476570s
	iters: 1528, epoch: 27 | train_loss : 0.0000
	speed: 0.125646s/iter; left time: 5570.765490s
	iters: 1910, epoch: 27 | train_loss : 0.0000
	speed: 0.133280s/iter; left time: 5858.333297s
data: {'predict': array([148.74825382, 148.74825383, 148.74825382, ..., 148.74825384,
       148.74825384, 148.74825384]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:24:50] [32mIntermediate result: 0.00029377127066254616  (Index 26)[0m
Epoch: 27 | cost time: 508.134530544281 | valid_loss: 0.00029377127066254616 | valid_loss_true: 6.162712761792939e-06
Pretest loss in this epoch: 14.470632537492563
Adjusting learning rate of group 0 to 1.2425e-06.
	iters: 382, epoch: 28 | train_loss : 0.0000
	speed: 0.897808s/iter; left time: 39119.287976s
	iters: 764, epoch: 28 | train_loss : 0.0000
	speed: 0.174697s/iter; left time: 7545.172285s
	iters: 1146, epoch: 28 | train_loss : 0.0000
	speed: 0.172909s/iter; left time: 7401.871459s
	iters: 1528, epoch: 28 | train_loss : 0.0000
	speed: 0.147896s/iter; left time: 6274.649104s
	iters: 1910, epoch: 28 | train_loss : 0.0000
	speed: 0.110371s/iter; left time: 4640.454902s
data: {'predict': array([148.74826182, 148.74826183, 148.74826183, ..., 148.74826184,
       148.74826183, 148.74826183]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:33:33] [32mIntermediate result: 0.00029291442479006946  (Index 27)[0m
Epoch: 28 | cost time: 522.895498752594 | valid_loss: 0.00029291442479006946 | valid_loss_true: 1.8352927696448095e-06
Pretest loss in this epoch: 14.470637393864449
Adjusting learning rate of group 0 to 1.0562e-06.
	iters: 382, epoch: 29 | train_loss : 0.0000
	speed: 0.706802s/iter; left time: 29446.080043s
	iters: 764, epoch: 29 | train_loss : 0.0000
	speed: 0.127353s/iter; left time: 5257.013855s
	iters: 1146, epoch: 29 | train_loss : 0.0000
	speed: 0.130061s/iter; left time: 5319.107236s
	iters: 1528, epoch: 29 | train_loss : 0.0000
	speed: 0.133796s/iter; left time: 5420.737520s
	iters: 1910, epoch: 29 | train_loss : 0.0000
	speed: 0.130070s/iter; left time: 5220.082043s
data: {'predict': array([148.74826115, 148.74826115, 148.74826115, ..., 148.74826117,
       148.74826117, 148.74826117]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:42:06] [32mIntermediate result: 0.00029279026784934103  (Index 28)[0m
Epoch: 29 | cost time: 512.3727350234985 | valid_loss: 0.00029279026784934103 | valid_loss_true: 1.1624297371872483e-06
Pretest loss in this epoch: 14.470636984195394
Adjusting learning rate of group 0 to 8.9774e-07.
	iters: 382, epoch: 30 | train_loss : 0.0000
	speed: 0.835504s/iter; left time: 33211.300130s
	iters: 764, epoch: 30 | train_loss : 0.0000
	speed: 0.142577s/iter; left time: 5612.959210s
	iters: 1146, epoch: 30 | train_loss : 0.0000
	speed: 0.143124s/iter; left time: 5579.819219s
	iters: 1528, epoch: 30 | train_loss : 0.0000
	speed: 0.143980s/iter; left time: 5558.191537s
	iters: 1910, epoch: 30 | train_loss : 0.0000
	speed: 0.143951s/iter; left time: 5502.101552s
data: {'predict': array([148.74826061, 148.74826061, 148.74826061, ..., 148.74826062,
       148.74826062, 148.74826061]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 22:50:57] [32mIntermediate result: 0.0002925453882198781  (Index 29)[0m
Epoch: 30 | cost time: 531.6386497020721 | valid_loss: 0.0002925453882198781 | valid_loss_true: 6.154152165375221e-07
Pretest loss in this epoch: 14.470636653355555
Early stop with best valid_loss: 0.0002925453882198781
[2024-03-06 22:50:57] [32mFinal result: 0.0002898007514886558[0m
>>>>>>>end of training : alumina_lstm/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
