python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 17:19:40.413095: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 17:19:40.413370: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 17:19:40.415269: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 17:19:40.425485: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 17:19:41.599543: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 1.4221
	speed: 0.047038s/iter; left time: 4476.595504s
	iters: 764, epoch: 1 | train_loss : 1.2302
	speed: 0.042499s/iter; left time: 4028.328800s
	iters: 1146, epoch: 1 | train_loss : 1.2801
	speed: 0.040400s/iter; left time: 3813.968436s
	iters: 1528, epoch: 1 | train_loss : 1.1650
	speed: 0.042400s/iter; left time: 3986.547852s
	iters: 1910, epoch: 1 | train_loss : 0.7289
	speed: 0.040902s/iter; left time: 3830.112640s
data: {'predict': array([109.52750031, 109.55109181, 109.53571108, ...,  56.42091706,
        56.37741775,  56.69448146]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:23:36] [32mIntermediate result: 0.769533634185791  (Index 0)[0m
Epoch: 1 | cost time: 228.63312530517578 | valid_loss: 0.769533634185791 | valid_loss_true: 36.21361597008437
Pretest loss in this epoch: 77.36762296798183
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.9410
	speed: 0.478704s/iter; left time: 44642.983396s
	iters: 764, epoch: 2 | train_loss : 1.0771
	speed: 0.096613s/iter; left time: 8972.986517s
	iters: 1146, epoch: 2 | train_loss : 1.3629
	speed: 0.112757s/iter; left time: 10429.302546s
	iters: 1528, epoch: 2 | train_loss : 1.4286
	speed: 0.103208s/iter; left time: 9506.729456s
	iters: 1910, epoch: 2 | train_loss : 1.3458
	speed: 0.098070s/iter; left time: 8995.977976s
data: {'predict': array([108.18088637, 107.77006872, 107.25887436, ...,  56.5855273 ,
        56.32901061,  56.84292403]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:29:02] [32mIntermediate result: 0.7699273228645325  (Index 1)[0m
Epoch: 2 | cost time: 326.778733253479 | valid_loss: 0.7699273228645325 | valid_loss_true: 36.54124613429229
Pretest loss in this epoch: 77.6772129303593
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.8903
	speed: 0.473330s/iter; left time: 43237.286257s
	iters: 764, epoch: 3 | train_loss : 1.0633
	speed: 0.126448s/iter; left time: 11502.348819s
	iters: 1146, epoch: 3 | train_loss : 1.4543
	speed: 0.134778s/iter; left time: 12208.553821s
	iters: 1528, epoch: 3 | train_loss : 0.6086
	speed: 0.125681s/iter; left time: 11336.521839s
	iters: 1910, epoch: 3 | train_loss : 0.8287
	speed: 0.102287s/iter; left time: 9187.272025s
data: {'predict': array([108.97393206, 108.56767532, 108.22441388, ...,  57.7459393 ,
        56.96021024,  57.67099594]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:35:42] [32mIntermediate result: 0.7664998769760132  (Index 2)[0m
Epoch: 3 | cost time: 399.8880407810211 | valid_loss: 0.7664998769760132 | valid_loss_true: 36.166029414848815
Pretest loss in this epoch: 77.28478474970485
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.0203
	speed: 0.528086s/iter; left time: 47229.924232s
	iters: 764, epoch: 4 | train_loss : 1.3961
	speed: 0.096807s/iter; left time: 8621.046956s
	iters: 1146, epoch: 4 | train_loss : 0.6385
	speed: 0.095062s/iter; left time: 8429.369483s
	iters: 1528, epoch: 4 | train_loss : 1.3172
	speed: 0.092181s/iter; left time: 8138.635509s
	iters: 1910, epoch: 4 | train_loss : 0.7740
	speed: 0.098521s/iter; left time: 8660.740926s
data: {'predict': array([109.99367507, 109.33999243, 108.51392878, ...,  58.53247505,
        57.87309761,  58.63478387]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:41:26] [32mIntermediate result: 0.7601953148841858  (Index 3)[0m
Epoch: 4 | cost time: 343.93612408638 | valid_loss: 0.7601953148841858 | valid_loss_true: 35.865947088560155
Pretest loss in this epoch: 76.99517073795356
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.6577
	speed: 0.514644s/iter; left time: 45044.229859s
	iters: 764, epoch: 5 | train_loss : 0.9024
	speed: 0.096336s/iter; left time: 8395.007744s
	iters: 1146, epoch: 5 | train_loss : 1.0655
	speed: 0.151435s/iter; left time: 13138.679445s
	iters: 1528, epoch: 5 | train_loss : 0.9378
	speed: 0.159822s/iter; left time: 13805.232483s
	iters: 1910, epoch: 5 | train_loss : 1.2629
	speed: 0.162436s/iter; left time: 13969.038993s
data: {'predict': array([107.8076645 , 107.56127376, 106.893773  , ...,  56.39724094,
        56.042494  ,  56.82218133]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:48:49] [32mIntermediate result: 0.7712584137916565  (Index 4)[0m
Epoch: 5 | cost time: 443.2214684486389 | valid_loss: 0.7712584137916565 | valid_loss_true: 36.58925622601896
Pretest loss in this epoch: 77.7245824757282
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.9369
	speed: 0.593351s/iter; left time: 50799.114598s
	iters: 764, epoch: 6 | train_loss : 0.7041
	speed: 0.093822s/iter; left time: 7996.662497s
	iters: 1146, epoch: 6 | train_loss : 1.3267
	speed: 0.080142s/iter; left time: 6800.042342s
	iters: 1528, epoch: 6 | train_loss : 0.8691
	speed: 0.045415s/iter; left time: 3836.092143s
	iters: 1910, epoch: 6 | train_loss : 1.1597
	speed: 0.058779s/iter; left time: 4942.527310s
data: {'predict': array([109.87609833, 109.22659018, 108.36394899, ...,  57.96682617,
        57.63347631,  58.49293023]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 17:53:53] [32mIntermediate result: 0.7653945088386536  (Index 5)[0m
Epoch: 6 | cost time: 303.88091826438904 | valid_loss: 0.7653945088386536 | valid_loss_true: 36.20534138625455
Pretest loss in this epoch: 77.33581875357301
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.7788
	speed: 0.523633s/iter; left time: 43829.619678s
	iters: 764, epoch: 7 | train_loss : 0.8580
	speed: 0.090836s/iter; left time: 7568.545582s
	iters: 1146, epoch: 7 | train_loss : 1.2626
	speed: 0.089763s/iter; left time: 7444.858457s
	iters: 1528, epoch: 7 | train_loss : 0.8724
	speed: 0.094308s/iter; left time: 7785.800289s
	iters: 1910, epoch: 7 | train_loss : 0.9297
	speed: 0.096204s/iter; left time: 7905.551339s
data: {'predict': array([108.42537321, 108.05520605, 107.30854795, ...,  57.1568061 ,
        56.86287132,  57.81425989]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:00:32] [32mIntermediate result: 0.7672315239906311  (Index 6)[0m
Epoch: 7 | cost time: 399.2242293357849 | valid_loss: 0.7672315239906311 | valid_loss_true: 36.39690477227464
Pretest loss in this epoch: 77.51838444471271
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.9834
	speed: 0.660562s/iter; left time: 54028.722510s
	iters: 764, epoch: 8 | train_loss : 1.0076
	speed: 0.059565s/iter; left time: 4849.226883s
	iters: 1146, epoch: 8 | train_loss : 0.9978
	speed: 0.063544s/iter; left time: 5148.844800s
	iters: 1528, epoch: 8 | train_loss : 1.0957
	speed: 0.055578s/iter; left time: 4482.144768s
	iters: 1910, epoch: 8 | train_loss : 0.8852
	speed: 0.056385s/iter; left time: 4525.648697s
data: {'predict': array([109.21583241, 108.91305504, 108.3509432 , ...,  57.70372055,
        57.37500212,  58.3705218 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:05:20] [32mIntermediate result: 0.7666605114936829  (Index 7)[0m
Epoch: 8 | cost time: 287.0459122657776 | valid_loss: 0.7666605114936829 | valid_loss_true: 36.227005892067275
Pretest loss in this epoch: 77.33858101110718
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.9834
	speed: 0.532865s/iter; left time: 42565.813297s
	iters: 764, epoch: 9 | train_loss : 1.2429
	speed: 0.137554s/iter; left time: 10935.437911s
	iters: 1146, epoch: 9 | train_loss : 1.1471
	speed: 0.136605s/iter; left time: 10807.764995s
	iters: 1528, epoch: 9 | train_loss : 0.7885
	speed: 0.138610s/iter; left time: 10913.428503s
	iters: 1910, epoch: 9 | train_loss : 1.0588
	speed: 0.121833s/iter; left time: 9545.983583s
data: {'predict': array([108.80452679, 108.38296266, 107.66972867, ...,  57.10555579,
        56.99483593,  57.98653089]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:12:12] [32mIntermediate result: 0.768452525138855  (Index 8)[0m
Epoch: 9 | cost time: 412.0307140350342 | valid_loss: 0.768452525138855 | valid_loss_true: 36.37925580041965
Pretest loss in this epoch: 77.49000341337421
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.9815
	speed: 0.580745s/iter; left time: 45280.687299s
	iters: 764, epoch: 10 | train_loss : 0.8180
	speed: 0.131157s/iter; left time: 10176.187817s
	iters: 1146, epoch: 10 | train_loss : 1.5129
	speed: 0.112590s/iter; left time: 8692.630307s
	iters: 1528, epoch: 10 | train_loss : 1.0337
	speed: 0.068293s/iter; left time: 5246.559059s
	iters: 1910, epoch: 10 | train_loss : 1.2500
	speed: 0.066822s/iter; left time: 5107.980335s
data: {'predict': array([109.44426157, 108.9434724 , 108.37056612, ...,  57.21765774,
        57.2117514 ,  58.14549993]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:17:54] [32mIntermediate result: 0.7678097486495972  (Index 9)[0m
Epoch: 10 | cost time: 342.86723136901855 | valid_loss: 0.7678097486495972 | valid_loss_true: 36.241756520738306
Pretest loss in this epoch: 77.35921051493355
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 1.0283
	speed: 0.466559s/iter; left time: 35485.996553s
	iters: 764, epoch: 11 | train_loss : 0.8428
	speed: 0.088083s/iter; left time: 6665.884356s
	iters: 1146, epoch: 11 | train_loss : 1.1726
	speed: 0.095214s/iter; left time: 7169.108941s
	iters: 1528, epoch: 11 | train_loss : 0.7822
	speed: 0.092141s/iter; left time: 6902.580924s
	iters: 1910, epoch: 11 | train_loss : 1.1264
	speed: 0.111008s/iter; left time: 8273.560227s
data: {'predict': array([109.70551969, 109.24730749, 108.78519722, ...,  57.25077159,
        57.23195818,  58.1354868 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:23:57] [32mIntermediate result: 0.7659834623336792  (Index 10)[0m
Epoch: 11 | cost time: 362.1724247932434 | valid_loss: 0.7659834623336792 | valid_loss_true: 36.28017118118084
Pretest loss in this epoch: 77.40092161910809
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.9981
	speed: 0.539994s/iter; left time: 40039.490857s
	iters: 764, epoch: 12 | train_loss : 1.3727
	speed: 0.058326s/iter; left time: 4302.475279s
	iters: 1146, epoch: 12 | train_loss : 1.0282
	speed: 0.058089s/iter; left time: 4262.773709s
	iters: 1528, epoch: 12 | train_loss : 0.9201
	speed: 0.079733s/iter; left time: 5820.639698s
	iters: 1910, epoch: 12 | train_loss : 1.1049
	speed: 0.107155s/iter; left time: 7781.607094s
data: {'predict': array([109.93602481, 109.42379529, 108.88352618, ...,  58.02706292,
        57.85783252,  58.86440896]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 18:29:08] [32mIntermediate result: 0.7660865783691406  (Index 11)[0m
Epoch: 12 | cost time: 311.5632846355438 | valid_loss: 0.7660865783691406 | valid_loss_true: 36.16937804083244
Pretest loss in this epoch: 77.28580357965069
Early stop with best valid_loss: 0.7660865783691406
[2024-03-06 18:29:08] [32mFinal result: 0.7601953148841858[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 18:29:13.738979: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 18:29:13.739056: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 18:29:13.741006: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 18:29:13.750990: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 18:29:15.163642: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 1.3505
	speed: 0.089154s/iter; left time: 8484.739323s
	iters: 764, epoch: 1 | train_loss : 1.3747
	speed: 0.092064s/iter; left time: 8726.499290s
	iters: 1146, epoch: 1 | train_loss : 1.1912
	speed: 0.108690s/iter; left time: 10260.926618s
	iters: 1528, epoch: 1 | train_loss : 1.1151
	speed: 0.106386s/iter; left time: 10002.739089s
	iters: 1910, epoch: 1 | train_loss : 0.8444
	speed: 0.111766s/iter; left time: 10465.916365s
data: {'predict': array([0.27031099, 0.27030867, 0.27026665, ..., 0.04901433, 0.04880989,
       0.05021045]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:35:22] [32mIntermediate result: 0.9204689860343933  (Index 0)[0m
Epoch: 1 | cost time: 361.17146468162537 | valid_loss: 0.9204689860343933 | valid_loss_true: 0.18051699259847875
Pretest loss in this epoch: 0.36769320773965947
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.9567
	speed: 0.548473s/iter; left time: 51149.494268s
	iters: 764, epoch: 2 | train_loss : 1.0604
	speed: 0.107540s/iter; left time: 9987.854333s
	iters: 1146, epoch: 2 | train_loss : 1.3500
	speed: 0.120538s/iter; left time: 11149.057478s
	iters: 1528, epoch: 2 | train_loss : 1.3359
	speed: 0.093881s/iter; left time: 8647.582576s
	iters: 1910, epoch: 2 | train_loss : 1.3505
	speed: 0.079624s/iter; left time: 7303.951373s
data: {'predict': array([0.26519168, 0.26336755, 0.2613922 , ..., 0.04944226, 0.04842715,
       0.05061978]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:41:39] [32mIntermediate result: 0.9206830859184265  (Index 1)[0m
Epoch: 2 | cost time: 377.0250155925751 | valid_loss: 0.9206830859184265 | valid_loss_true: 0.18176979250959702
Pretest loss in this epoch: 0.3690087029626854
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0949
	speed: 0.604988s/iter; left time: 55263.846319s
	iters: 764, epoch: 3 | train_loss : 1.0077
	speed: 0.088527s/iter; left time: 8052.901057s
	iters: 1146, epoch: 3 | train_loss : 1.3850
	speed: 0.059668s/iter; left time: 5404.937128s
	iters: 1528, epoch: 3 | train_loss : 0.8845
	speed: 0.058012s/iter; left time: 5232.733256s
	iters: 1910, epoch: 3 | train_loss : 0.8816
	speed: 0.057037s/iter; left time: 5122.971513s
data: {'predict': array([0.2676957 , 0.26591188, 0.26463128, ..., 0.05449101, 0.05112324,
       0.05405774]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:47:09] [32mIntermediate result: 0.9183024764060974  (Index 2)[0m
Epoch: 3 | cost time: 329.71842527389526 | valid_loss: 0.9183024764060974 | valid_loss_true: 0.18045324841892135
Pretest loss in this epoch: 0.3673945135416767
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.2232
	speed: 0.583996s/iter; left time: 52230.303831s
	iters: 764, epoch: 4 | train_loss : 1.4568
	speed: 0.107538s/iter; left time: 9576.662635s
	iters: 1146, epoch: 4 | train_loss : 0.8630
	speed: 0.106709s/iter; left time: 9462.119017s
	iters: 1528, epoch: 4 | train_loss : 1.3058
	speed: 0.095156s/iter; left time: 8401.307253s
	iters: 1910, epoch: 4 | train_loss : 0.9667
	speed: 0.096435s/iter; left time: 8477.380504s
data: {'predict': array([0.27239282, 0.26949832, 0.26636918, ..., 0.05773804, 0.05508128,
       0.05826912]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:53:05] [32mIntermediate result: 0.9122628569602966  (Index 3)[0m
Epoch: 4 | cost time: 356.1524438858032 | valid_loss: 0.9122628569602966 | valid_loss_true: 0.1792338259411358
Pretest loss in this epoch: 0.36604620349315065
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.8073
	speed: 0.517586s/iter; left time: 45301.736855s
	iters: 764, epoch: 5 | train_loss : 0.9478
	speed: 0.105626s/iter; left time: 9204.593944s
	iters: 1146, epoch: 5 | train_loss : 1.1269
	speed: 0.112943s/iter; left time: 9799.065618s
	iters: 1528, epoch: 5 | train_loss : 1.0445
	speed: 0.113600s/iter; left time: 9812.694298s
	iters: 1910, epoch: 5 | train_loss : 1.1392
	speed: 0.092758s/iter; left time: 7976.867288s
data: {'predict': array([0.26332292, 0.26161778, 0.25860598, ..., 0.0494723 , 0.04833312,
       0.0514317 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 18:59:11] [32mIntermediate result: 0.9223763942718506  (Index 4)[0m
Epoch: 5 | cost time: 365.89543294906616 | valid_loss: 0.9223763942718506 | valid_loss_true: 0.18207756177704015
Pretest loss in this epoch: 0.36935964001188404
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.0624
	speed: 0.576311s/iter; left time: 49340.256695s
	iters: 764, epoch: 6 | train_loss : 0.8601
	speed: 0.147308s/iter; left time: 12555.361794s
	iters: 1146, epoch: 6 | train_loss : 1.5850
	speed: 0.144492s/iter; left time: 12260.185722s
	iters: 1528, epoch: 6 | train_loss : 1.0348
	speed: 0.113605s/iter; left time: 9595.980178s
	iters: 1910, epoch: 6 | train_loss : 1.2521
	speed: 0.113529s/iter; left time: 9546.207889s
data: {'predict': array([0.27163361, 0.26839172, 0.26503468, ..., 0.05588679, 0.05467592,
       0.05834091]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:06:04] [32mIntermediate result: 0.9170519709587097  (Index 5)[0m
Epoch: 6 | cost time: 412.4453728199005 | valid_loss: 0.9170519709587097 | valid_loss_true: 0.18051656247833017
Pretest loss in this epoch: 0.36752260848490187
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.9661
	speed: 0.478692s/iter; left time: 40067.972917s
	iters: 764, epoch: 7 | train_loss : 1.0296
	speed: 0.060842s/iter; left time: 5069.380327s
	iters: 1146, epoch: 7 | train_loss : 1.3384
	speed: 0.076180s/iter; left time: 6318.325887s
	iters: 1528, epoch: 7 | train_loss : 0.9136
	speed: 0.079715s/iter; left time: 6581.034431s
	iters: 1910, epoch: 7 | train_loss : 1.0494
	speed: 0.079682s/iter; left time: 6547.864556s
data: {'predict': array([0.26541474, 0.26336337, 0.2607247 , ..., 0.05222103, 0.05122969,
       0.05516824]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:11:12] [32mIntermediate result: 0.9182523488998413  (Index 6)[0m
Epoch: 7 | cost time: 308.338907957077 | valid_loss: 0.9182523488998413 | valid_loss_true: 0.18125998211632757
Pretest loss in this epoch: 0.3683563742880147
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 1.1032
	speed: 0.540907s/iter; left time: 44241.897178s
	iters: 764, epoch: 8 | train_loss : 1.1266
	speed: 0.089674s/iter; left time: 7300.347208s
	iters: 1146, epoch: 8 | train_loss : 0.9351
	speed: 0.101203s/iter; left time: 8200.242172s
	iters: 1528, epoch: 8 | train_loss : 1.2462
	speed: 0.124761s/iter; left time: 10061.443874s
	iters: 1910, epoch: 8 | train_loss : 1.1228
	speed: 0.129627s/iter; left time: 10404.371557s
data: {'predict': array([0.26877547, 0.26722172, 0.26519006, ..., 0.05431944, 0.05320384,
       0.05709198]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:17:33] [32mIntermediate result: 0.9181572794914246  (Index 7)[0m
Epoch: 8 | cost time: 381.19392466545105 | valid_loss: 0.9181572794914246 | valid_loss_true: 0.18064857804103546
Pretest loss in this epoch: 0.3676338784390191
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 1.0671
	speed: 0.510175s/iter; left time: 40753.295831s
	iters: 764, epoch: 9 | train_loss : 1.2513
	speed: 0.059674s/iter; left time: 4744.000620s
	iters: 1146, epoch: 9 | train_loss : 1.3131
	speed: 0.095192s/iter; left time: 7531.339625s
	iters: 1528, epoch: 9 | train_loss : 0.9266
	speed: 0.096917s/iter; left time: 7630.795140s
	iters: 1910, epoch: 9 | train_loss : 1.2837
	speed: 0.062515s/iter; left time: 4898.215086s
data: {'predict': array([0.26781168, 0.26557094, 0.26289984, ..., 0.05206388, 0.05176305,
       0.05575682]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:22:52] [32mIntermediate result: 0.9199013710021973  (Index 8)[0m
Epoch: 9 | cost time: 318.94292163848877 | valid_loss: 0.9199013710021973 | valid_loss_true: 0.18117552239350054
Pretest loss in this epoch: 0.36824147859433637
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 1.1359
	speed: 0.621912s/iter; left time: 48490.503512s
	iters: 764, epoch: 10 | train_loss : 1.0359
	speed: 0.129720s/iter; left time: 10064.697642s
	iters: 1146, epoch: 10 | train_loss : 1.5361
	speed: 0.127128s/iter; left time: 9815.064513s
	iters: 1528, epoch: 10 | train_loss : 1.2048
	speed: 0.092872s/iter; left time: 7134.796456s
	iters: 1910, epoch: 10 | train_loss : 1.3090
	speed: 0.093680s/iter; left time: 7161.114694s
data: {'predict': array([0.27006927, 0.26770986, 0.26556989, ..., 0.05273444, 0.05290089,
       0.05673649]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:29:27] [32mIntermediate result: 0.9185569286346436  (Index 9)[0m
Epoch: 10 | cost time: 394.8303689956665 | valid_loss: 0.9185569286346436 | valid_loss_true: 0.1805288698834895
Pretest loss in this epoch: 0.36752722830416806
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 1.1002
	speed: 0.473089s/iter; left time: 35982.683776s
	iters: 764, epoch: 11 | train_loss : 0.9151
	speed: 0.030521s/iter; left time: 2309.758659s
	iters: 1146, epoch: 11 | train_loss : 1.0220
	speed: 0.030104s/iter; left time: 2266.705392s
	iters: 1528, epoch: 11 | train_loss : 1.0893
	speed: 0.031888s/iter; left time: 2388.861325s
	iters: 1910, epoch: 11 | train_loss : 1.2371
	speed: 0.029623s/iter; left time: 2207.802212s
data: {'predict': array([0.27069445, 0.26867856, 0.26691773, ..., 0.0525656 , 0.05266336,
       0.05631882]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:32:53] [32mIntermediate result: 0.9172940850257874  (Index 10)[0m
Epoch: 11 | cost time: 206.0177252292633 | valid_loss: 0.9172940850257874 | valid_loss_true: 0.18082462077485437
Pretest loss in this epoch: 0.3678922463614862
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 1.0849
	speed: 0.432092s/iter; left time: 32038.771179s
	iters: 764, epoch: 12 | train_loss : 1.3656
	speed: 0.054103s/iter; left time: 3990.939937s
	iters: 1146, epoch: 12 | train_loss : 1.2530
	speed: 0.040957s/iter; left time: 3005.570369s
	iters: 1528, epoch: 12 | train_loss : 1.0910
	speed: 0.075561s/iter; left time: 5516.126387s
	iters: 1910, epoch: 12 | train_loss : 1.1380
	speed: 0.085324s/iter; left time: 6196.231486s
data: {'predict': array([0.27177915, 0.26948016, 0.26738858, ..., 0.05553649, 0.05509366,
       0.0592284 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-06 19:37:17] [32mIntermediate result: 0.9174913763999939  (Index 11)[0m
Epoch: 12 | cost time: 263.8066740036011 | valid_loss: 0.9174913763999939 | valid_loss_true: 0.18040386781679593
Pretest loss in this epoch: 0.3673898755654107
Early stop with best valid_loss: 0.9174913763999939
[2024-03-06 19:37:17] [32mFinal result: 0.9122628569602966[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 19:37:22.985699: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 19:37:22.985972: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 19:37:22.988085: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 19:37:22.998796: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 19:37:24.361339: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 1.4462
	speed: 0.097711s/iter; left time: 9299.052946s
	iters: 764, epoch: 1 | train_loss : 1.1903
	speed: 0.052348s/iter; left time: 4961.945392s
	iters: 1146, epoch: 1 | train_loss : 1.2369
	speed: 0.034031s/iter; left time: 3212.661538s
	iters: 1528, epoch: 1 | train_loss : 1.2508
	speed: 0.031210s/iter; left time: 2934.443685s
	iters: 1910, epoch: 1 | train_loss : 0.6815
	speed: 0.030388s/iter; left time: 2845.559271s
data: {'predict': array([97.20535182, 97.22390088, 97.21363905, ..., 52.85130244,
       52.81564641, 53.08102611]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:41:30] [32mIntermediate result: 0.7332437038421631  (Index 0)[0m
Epoch: 1 | cost time: 239.75614595413208 | valid_loss: 0.7332437038421631 | valid_loss_true: 28.819905340379798
Pretest loss in this epoch: 62.726627699430736
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.9497
	speed: 0.433088s/iter; left time: 40388.939438s
	iters: 764, epoch: 2 | train_loss : 1.0525
	speed: 0.047825s/iter; left time: 4441.770648s
	iters: 1146, epoch: 2 | train_loss : 1.3522
	speed: 0.045699s/iter; left time: 4226.853089s
	iters: 1528, epoch: 2 | train_loss : 1.4758
	speed: 0.044645s/iter; left time: 4112.348852s
	iters: 1910, epoch: 2 | train_loss : 1.3629
	speed: 0.032401s/iter; left time: 2972.104801s
data: {'predict': array([96.0395747 , 95.68220845, 95.24889287, ..., 53.00142916,
       52.79006134, 53.22594533]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:45:21] [32mIntermediate result: 0.7337467074394226  (Index 1)[0m
Epoch: 2 | cost time: 230.72185683250427 | valid_loss: 0.7337467074394226 | valid_loss_true: 29.096333418715428
Pretest loss in this epoch: 62.99710342513924
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.8007
	speed: 0.433880s/iter; left time: 39633.616995s
	iters: 764, epoch: 3 | train_loss : 1.0937
	speed: 0.073476s/iter; left time: 6683.724127s
	iters: 1146, epoch: 3 | train_loss : 1.4898
	speed: 0.091628s/iter; left time: 8299.948091s
	iters: 1528, epoch: 3 | train_loss : 0.5384
	speed: 0.090019s/iter; left time: 8119.806928s
	iters: 1910, epoch: 3 | train_loss : 0.8311
	speed: 0.046944s/iter; left time: 4216.438780s
data: {'predict': array([96.72330962, 96.38827435, 96.07954282, ..., 53.94219058,
       53.29109323, 53.910201  ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:50:06] [32mIntermediate result: 0.730161190032959  (Index 2)[0m
Epoch: 3 | cost time: 285.0896484851837 | valid_loss: 0.730161190032959 | valid_loss_true: 28.782056682909985
Pretest loss in this epoch: 62.6492581745686
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.9202
	speed: 0.433154s/iter; left time: 38739.565892s
	iters: 764, epoch: 4 | train_loss : 1.3208
	speed: 0.034302s/iter; left time: 3054.773548s
	iters: 1146, epoch: 4 | train_loss : 0.6054
	speed: 0.041668s/iter; left time: 3694.791926s
	iters: 1528, epoch: 4 | train_loss : 1.2745
	speed: 0.041864s/iter; left time: 3696.154932s
	iters: 1910, epoch: 4 | train_loss : 0.7411
	speed: 0.041216s/iter; left time: 3623.208959s
data: {'predict': array([97.5207824 , 97.00643722, 96.2978854 , ..., 54.60687455,
       54.04268349, 54.69280061]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:53:49] [32mIntermediate result: 0.7240421772003174  (Index 3)[0m
Epoch: 4 | cost time: 223.49397540092468 | valid_loss: 0.7240421772003174 | valid_loss_true: 28.534658973349963
Pretest loss in this epoch: 62.39685714484331
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.6738
	speed: 0.428361s/iter; left time: 37492.291297s
	iters: 764, epoch: 5 | train_loss : 0.8381
	speed: 0.034382s/iter; left time: 2996.113154s
	iters: 1146, epoch: 5 | train_loss : 1.0454
	speed: 0.034529s/iter; left time: 2995.762397s
	iters: 1528, epoch: 5 | train_loss : 0.8591
	speed: 0.035785s/iter; left time: 3091.055079s
	iters: 1910, epoch: 5 | train_loss : 1.2740
	speed: 0.045874s/iter; left time: 3945.018400s
data: {'predict': array([95.65856264, 95.47653588, 94.959865  , ..., 52.8367403 ,
       52.52126024, 53.18931848]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 19:57:35] [32mIntermediate result: 0.7348772883415222  (Index 4)[0m
Epoch: 5 | cost time: 225.5434274673462 | valid_loss: 0.7348772883415222 | valid_loss_true: 29.12794804407316
Pretest loss in this epoch: 63.019245460830234
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.8485
	speed: 0.437779s/iter; left time: 37480.030995s
	iters: 764, epoch: 6 | train_loss : 0.6501
	speed: 0.034245s/iter; left time: 2918.727269s
	iters: 1146, epoch: 6 | train_loss : 1.1464
	speed: 0.037515s/iter; left time: 3183.133919s
	iters: 1528, epoch: 6 | train_loss : 0.8190
	speed: 0.075884s/iter; left time: 6409.791183s
	iters: 1910, epoch: 6 | train_loss : 1.1010
	speed: 0.031808s/iter; left time: 2674.585600s
data: {'predict': array([97.40588287, 96.90575109, 96.17750032, ..., 54.14449124,
       53.84230561, 54.57185001]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:01:26] [32mIntermediate result: 0.7290688753128052  (Index 5)[0m
Epoch: 6 | cost time: 231.45173931121826 | valid_loss: 0.7290688753128052 | valid_loss_true: 28.812706747600107
Pretest loss in this epoch: 62.68929870957277
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.7238
	speed: 0.429686s/iter; left time: 35966.007276s
	iters: 764, epoch: 7 | train_loss : 0.7947
	speed: 0.035464s/iter; left time: 2954.936690s
	iters: 1146, epoch: 7 | train_loss : 1.2129
	speed: 0.037195s/iter; left time: 3084.920482s
	iters: 1528, epoch: 7 | train_loss : 0.8891
	speed: 0.036565s/iter; left time: 3018.729000s
	iters: 1910, epoch: 7 | train_loss : 0.9031
	speed: 0.036357s/iter; left time: 2987.661523s
data: {'predict': array([96.23115403, 95.94551929, 95.32229972, ..., 53.4944401 ,
       53.22541279, 54.02971895]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:05:06] [32mIntermediate result: 0.7308924794197083  (Index 6)[0m
Epoch: 7 | cost time: 219.81951808929443 | valid_loss: 0.7308924794197083 | valid_loss_true: 28.968189000436343
Pretest loss in this epoch: 62.84109052328475
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.9325
	speed: 0.435532s/iter; left time: 35623.005731s
	iters: 764, epoch: 8 | train_loss : 0.9106
	speed: 0.041723s/iter; left time: 3396.674699s
	iters: 1146, epoch: 8 | train_loss : 1.0150
	speed: 0.030161s/iter; left time: 2443.860276s
	iters: 1528, epoch: 8 | train_loss : 1.0085
	speed: 0.030129s/iter; left time: 2429.798396s
	iters: 1910, epoch: 8 | train_loss : 0.8049
	speed: 0.029220s/iter; left time: 2345.322245s
data: {'predict': array([96.89451138, 96.62752938, 96.20007635, ..., 53.95257259,
       53.66348817, 54.51199443]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:08:37] [32mIntermediate result: 0.7302344441413879  (Index 7)[0m
Epoch: 8 | cost time: 210.9135353565216 | valid_loss: 0.7302344441413879 | valid_loss_true: 28.82363401431789
Pretest loss in this epoch: 62.684211953488976
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.8675
	speed: 0.419400s/iter; left time: 33502.060525s
	iters: 764, epoch: 9 | train_loss : 1.1628
	speed: 0.042532s/iter; left time: 3381.277487s
	iters: 1146, epoch: 9 | train_loss : 1.0714
	speed: 0.042691s/iter; left time: 3377.585415s
	iters: 1528, epoch: 9 | train_loss : 0.7380
	speed: 0.091342s/iter; left time: 7191.774222s
	iters: 1910, epoch: 9 | train_loss : 0.9417
	speed: 0.101008s/iter; left time: 7914.316857s
data: {'predict': array([96.4550222 , 96.13399062, 95.57915892, ..., 53.43039496,
       53.31325691, 54.1569421 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:13:15] [32mIntermediate result: 0.7321298718452454  (Index 8)[0m
Epoch: 9 | cost time: 277.68418049812317 | valid_loss: 0.7321298718452454 | valid_loss_true: 28.95859885562345
Pretest loss in this epoch: 62.82287171594789
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.9018
	speed: 0.441382s/iter; left time: 34414.588358s
	iters: 764, epoch: 10 | train_loss : 0.6949
	speed: 0.080152s/iter; left time: 6218.815589s
	iters: 1146, epoch: 10 | train_loss : 1.5281
	speed: 0.092717s/iter; left time: 7158.346361s
	iters: 1528, epoch: 10 | train_loss : 0.9605
	speed: 0.041181s/iter; left time: 3163.696441s
	iters: 1910, epoch: 10 | train_loss : 1.1858
	speed: 0.039155s/iter; left time: 2993.077076s
data: {'predict': array([97.00718182, 96.67421306, 96.18562496, ..., 53.53085016,
       53.48355384, 54.27744971]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:17:28] [32mIntermediate result: 0.7314268946647644  (Index 9)[0m
Epoch: 10 | cost time: 252.99247217178345 | valid_loss: 0.7314268946647644 | valid_loss_true: 28.84189262346687
Pretest loss in this epoch: 62.70623258407708
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.9235
	speed: 0.406956s/iter; left time: 30952.647310s
	iters: 764, epoch: 11 | train_loss : 0.8315
	speed: 0.029981s/iter; left time: 2268.865875s
	iters: 1146, epoch: 11 | train_loss : 1.2621
	speed: 0.030689s/iter; left time: 2310.735997s
	iters: 1528, epoch: 11 | train_loss : 0.7521
	speed: 0.028730s/iter; left time: 2152.248657s
	iters: 1910, epoch: 11 | train_loss : 1.0586
	speed: 0.039573s/iter; left time: 2949.401009s
data: {'predict': array([97.28240864, 96.96011878, 96.51820257, ..., 53.56793414,
       53.51271111, 54.28083812]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:20:51] [32mIntermediate result: 0.7296894192695618  (Index 10)[0m
Epoch: 11 | cost time: 203.46533703804016 | valid_loss: 0.7296894192695618 | valid_loss_true: 28.872905556874496
Pretest loss in this epoch: 62.74285173092881
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 1.0177
	speed: 0.405648s/iter; left time: 30077.953470s
	iters: 764, epoch: 12 | train_loss : 1.3692
	speed: 0.036187s/iter; left time: 2669.387483s
	iters: 1146, epoch: 12 | train_loss : 0.9644
	speed: 0.033063s/iter; left time: 2426.281894s
	iters: 1528, epoch: 12 | train_loss : 0.8567
	speed: 0.032758s/iter; left time: 2391.381838s
	iters: 1910, epoch: 12 | train_loss : 1.0873
	speed: 0.034514s/iter; left time: 2506.395097s
data: {'predict': array([97.44331087, 97.09785354, 96.59675095, ..., 54.23333915,
       54.04178337, 54.91164743]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-06 20:24:12] [32mIntermediate result: 0.7295956611633301  (Index 11)[0m
Epoch: 12 | cost time: 200.3582739830017 | valid_loss: 0.7295956611633301 | valid_loss_true: 28.776285313685197
Pretest loss in this epoch: 62.63842358246566
Early stop with best valid_loss: 0.7295956611633301
[2024-03-06 20:24:12] [32mFinal result: 0.7240421772003174[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度', target_cols='1效出料温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 20:24:17.307478: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 20:24:17.307547: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 20:24:17.309317: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 20:24:17.317924: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 20:24:18.441818: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0935
	speed: 0.037193s/iter; left time: 3539.598046s
	iters: 764, epoch: 1 | train_loss : 0.0874
	speed: 0.029724s/iter; left time: 2817.433585s
	iters: 1146, epoch: 1 | train_loss : 0.0609
	speed: 0.029678s/iter; left time: 2801.774648s
	iters: 1528, epoch: 1 | train_loss : 0.0877
	speed: 0.030516s/iter; left time: 2869.247328s
	iters: 1910, epoch: 1 | train_loss : 0.1803
	speed: 0.052662s/iter; left time: 4931.288735s
data: {'predict': array([148.23187892, 148.23201851, 148.23213194, ..., 147.11134885,
       147.11036966, 147.11717103]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:27:45] [32mIntermediate result: 0.5984494090080261  (Index 0)[0m
Epoch: 1 | cost time: 202.0988917350769 | valid_loss: 0.5984494090080261 | valid_loss_true: 0.5966882479345749
Pretest loss in this epoch: 13.547467267222732
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0887
	speed: 0.425957s/iter; left time: 39723.906352s
	iters: 764, epoch: 2 | train_loss : 0.0783
	speed: 0.086187s/iter; left time: 8004.709208s
	iters: 1146, epoch: 2 | train_loss : 0.0743
	speed: 0.050385s/iter; left time: 4660.355871s
	iters: 1528, epoch: 2 | train_loss : 0.6288
	speed: 0.038060s/iter; left time: 3505.778448s
	iters: 1910, epoch: 2 | train_loss : 0.0899
	speed: 0.035557s/iter; left time: 3261.681664s
data: {'predict': array([148.19720856, 148.18694381, 148.17534063, ..., 147.11522911,
       147.11024568, 147.12141345]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:32:07] [32mIntermediate result: 0.5991688370704651  (Index 1)[0m
Epoch: 2 | cost time: 261.26726365089417 | valid_loss: 0.5991688370704651 | valid_loss_true: 0.5998409127788629
Pretest loss in this epoch: 13.53230542099329
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0530
	speed: 0.445276s/iter; left time: 40674.656144s
	iters: 764, epoch: 3 | train_loss : 0.0873
	speed: 0.043446s/iter; left time: 3952.050829s
	iters: 1146, epoch: 3 | train_loss : 0.0720
	speed: 0.040701s/iter; left time: 3686.789215s
	iters: 1528, epoch: 3 | train_loss : 0.0790
	speed: 0.032189s/iter; left time: 2903.521342s
	iters: 1910, epoch: 3 | train_loss : 0.0674
	speed: 0.031071s/iter; left time: 2790.777928s
data: {'predict': array([148.20925311, 148.20159719, 148.19156311, ..., 147.13732884,
       147.12055216, 147.13854382]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:35:58] [32mIntermediate result: 0.5979865789413452  (Index 2)[0m
Epoch: 3 | cost time: 231.49479413032532 | valid_loss: 0.5979865789413452 | valid_loss_true: 0.5971967465241366
Pretest loss in this epoch: 13.553156645773317
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0644
	speed: 0.450992s/iter; left time: 40334.932461s
	iters: 764, epoch: 4 | train_loss : 0.0778
	speed: 0.043258s/iter; left time: 3852.311976s
	iters: 1146, epoch: 4 | train_loss : 0.0726
	speed: 0.046030s/iter; left time: 4081.589615s
	iters: 1528, epoch: 4 | train_loss : 0.1215
	speed: 0.047468s/iter; left time: 4190.960966s
	iters: 1910, epoch: 4 | train_loss : 0.0779
	speed: 0.048745s/iter; left time: 4285.052958s
data: {'predict': array([148.23003743, 148.21856085, 148.20125381, ..., 147.15533481,
       147.14014302, 147.15807829]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:40:02] [32mIntermediate result: 0.5954260230064392  (Index 3)[0m
Epoch: 4 | cost time: 243.66279649734497 | valid_loss: 0.5954260230064392 | valid_loss_true: 0.5946081963241368
Pretest loss in this epoch: 13.571330543660657
Chepoint Saved at:  ./checkpoints/allfeature/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0673
	speed: 0.454311s/iter; left time: 39763.587820s
	iters: 764, epoch: 5 | train_loss : 0.0773
	speed: 0.039517s/iter; left time: 3443.666379s
	iters: 1146, epoch: 5 | train_loss : 0.0506
	speed: 0.081042s/iter; left time: 7031.309829s
	iters: 1528, epoch: 5 | train_loss : 0.0767
	speed: 0.091704s/iter; left time: 7921.323729s
	iters: 1910, epoch: 5 | train_loss : 0.1383
	speed: 0.052672s/iter; left time: 4529.624577s
data: {'predict': array([148.18580035, 148.17610488, 148.16747842, ..., 147.11568616,
       147.10639165, 147.12467454]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:44:27] [32mIntermediate result: 0.5992113947868347  (Index 4)[0m
Epoch: 5 | cost time: 265.2618968486786 | valid_loss: 0.5992113947868347 | valid_loss_true: 0.5998204019504845
Pretest loss in this epoch: 13.537401965085188
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0699
	speed: 0.423016s/iter; left time: 36216.049839s
	iters: 764, epoch: 6 | train_loss : 0.0505
	speed: 0.030150s/iter; left time: 2569.770735s
	iters: 1146, epoch: 6 | train_loss : 0.0834
	speed: 0.032454s/iter; left time: 2753.706180s
	iters: 1528, epoch: 6 | train_loss : 0.0830
	speed: 0.030868s/iter; left time: 2607.375443s
	iters: 1910, epoch: 6 | train_loss : 0.0787
	speed: 0.031236s/iter; left time: 2626.486477s
data: {'predict': array([148.22623281, 148.21049843, 148.1971849 , ..., 147.14410196,
       147.13462553, 147.15400825]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:48:04] [32mIntermediate result: 0.5972142815589905  (Index 5)[0m
Epoch: 6 | cost time: 216.75552010536194 | valid_loss: 0.5972142815589905 | valid_loss_true: 0.5970506034720429
Pretest loss in this epoch: 13.55360406699375
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0632
	speed: 0.448856s/iter; left time: 37570.627192s
	iters: 764, epoch: 7 | train_loss : 0.0638
	speed: 0.040168s/iter; left time: 3346.863421s
	iters: 1146, epoch: 7 | train_loss : 0.1037
	speed: 0.038257s/iter; left time: 3172.963289s
	iters: 1528, epoch: 7 | train_loss : 0.0787
	speed: 0.037665s/iter; left time: 3109.549658s
	iters: 1910, epoch: 7 | train_loss : 0.0668
	speed: 0.036958s/iter; left time: 3036.989937s
data: {'predict': array([148.20329068, 148.19273386, 148.17994128, ..., 147.13315866,
       147.12434588, 147.14553759]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:51:42] [32mIntermediate result: 0.5975005030632019  (Index 6)[0m
Epoch: 7 | cost time: 218.51066780090332 | valid_loss: 0.5975005030632019 | valid_loss_true: 0.5981113720297995
Pretest loss in this epoch: 13.549339521866388
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0699
	speed: 0.436294s/iter; left time: 35685.343140s
	iters: 764, epoch: 8 | train_loss : 0.0576
	speed: 0.059217s/iter; left time: 4820.844325s
	iters: 1146, epoch: 8 | train_loss : 0.0892
	speed: 0.091807s/iter; left time: 7438.922600s
	iters: 1528, epoch: 8 | train_loss : 0.0872
	speed: 0.093016s/iter; left time: 7501.337255s
	iters: 1910, epoch: 8 | train_loss : 0.0808
	speed: 0.079373s/iter; left time: 6370.794336s
data: {'predict': array([148.2213587 , 148.21066872, 148.20280651, ..., 147.14242373,
       147.13431762, 147.15647898]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 20:57:00] [32mIntermediate result: 0.597417950630188  (Index 7)[0m
Epoch: 8 | cost time: 317.11985087394714 | valid_loss: 0.597417950630188 | valid_loss_true: 0.5968582116214888
Pretest loss in this epoch: 13.555719036803822
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0819
	speed: 0.608465s/iter; left time: 48604.810262s
	iters: 764, epoch: 9 | train_loss : 0.2337
	speed: 0.150267s/iter; left time: 11946.106547s
	iters: 1146, epoch: 9 | train_loss : 0.0760
	speed: 0.120853s/iter; left time: 9561.501541s
	iters: 1528, epoch: 9 | train_loss : 0.0594
	speed: 0.101370s/iter; left time: 7981.357522s
	iters: 1910, epoch: 9 | train_loss : 0.0810
	speed: 0.094426s/iter; left time: 7398.582261s
data: {'predict': array([148.21015517, 148.19861762, 148.18788479, ..., 147.12795029,
       147.12402616, 147.14631067]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:04:18] [32mIntermediate result: 0.598109245300293  (Index 8)[0m
Epoch: 9 | cost time: 438.68780493736267 | valid_loss: 0.598109245300293 | valid_loss_true: 0.5982026543662214
Pretest loss in this epoch: 13.547582883783944
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0712
	speed: 0.661812s/iter; left time: 51601.491295s
	iters: 764, epoch: 10 | train_loss : 0.0672
	speed: 0.133635s/iter; left time: 10368.469361s
	iters: 1146, epoch: 10 | train_loss : 0.0778
	speed: 0.105762s/iter; left time: 8165.453203s
	iters: 1528, epoch: 10 | train_loss : 0.0872
	speed: 0.100991s/iter; left time: 7758.537383s
	iters: 1910, epoch: 10 | train_loss : 0.1188
	speed: 0.072882s/iter; left time: 5571.282061s
data: {'predict': array([148.22116492, 148.20923326, 148.20204613, ..., 147.13145385,
       147.12846527, 147.1494529 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:11:17] [32mIntermediate result: 0.5977544784545898  (Index 9)[0m
Epoch: 10 | cost time: 418.3124330043793 | valid_loss: 0.5977544784545898 | valid_loss_true: 0.5970239862601212
Pretest loss in this epoch: 13.555886851453094
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0714
	speed: 0.732048s/iter; left time: 55678.872230s
	iters: 764, epoch: 11 | train_loss : 0.0806
	speed: 0.184499s/iter; left time: 13962.304921s
	iters: 1146, epoch: 11 | train_loss : 0.0643
	speed: 0.182781s/iter; left time: 13762.469532s
	iters: 1528, epoch: 11 | train_loss : 0.0607
	speed: 0.173605s/iter; left time: 13005.295737s
	iters: 1910, epoch: 11 | train_loss : 0.1064
	speed: 0.202967s/iter; left time: 15127.359220s
data: {'predict': array([148.22512428, 148.21442   , 148.20802561, ..., 147.13162372,
       147.12808035, 147.1485375 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:21:00] [32mIntermediate result: 0.597162663936615  (Index 10)[0m
Epoch: 11 | cost time: 583.1783142089844 | valid_loss: 0.597162663936615 | valid_loss_true: 0.5973867753009343
Pretest loss in this epoch: 13.552064937800939
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0890
	speed: 0.727383s/iter; left time: 53934.007415s
	iters: 764, epoch: 12 | train_loss : 0.0878
	speed: 0.180961s/iter; left time: 13348.743831s
	iters: 1146, epoch: 12 | train_loss : 0.1810
	speed: 0.192079s/iter; left time: 14095.532789s
	iters: 1528, epoch: 12 | train_loss : 0.0785
	speed: 0.156901s/iter; left time: 11454.062703s
	iters: 1910, epoch: 12 | train_loss : 0.0987
	speed: 0.124477s/iter; left time: 9039.492918s
data: {'predict': array([148.23021821, 148.21766017, 148.20954976, ..., 147.14905701,
       147.14178643, 147.1656091 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-06 21:29:44] [32mIntermediate result: 0.5969013571739197  (Index 11)[0m
Epoch: 12 | cost time: 524.3355433940887 | valid_loss: 0.5969013571739197 | valid_loss_true: 0.5962898001967073
Pretest loss in this epoch: 13.55878452090227
Early stop with best valid_loss: 0.5969013571739197
[2024-03-06 21:29:44] [32mFinal result: 0.5954260230064392[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
