python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 20:51:20.839707: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 20:51:20.839763: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 20:51:20.841555: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 20:51:20.851181: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 20:51:21.922634: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0097
	speed: 0.089711s/iter; left time: 8537.670713s
	iters: 764, epoch: 1 | train_loss : 0.0061
	speed: 0.149331s/iter; left time: 14154.677769s
	iters: 1146, epoch: 1 | train_loss : 0.0047
	speed: 0.171957s/iter; left time: 16233.606337s
	iters: 1528, epoch: 1 | train_loss : 0.0035
	speed: 0.066074s/iter; left time: 6212.470066s
	iters: 1910, epoch: 1 | train_loss : 0.0036
	speed: 0.063054s/iter; left time: 5904.483905s
data: {'predict': array([159.28269957, 159.09767099, 159.04200362, ..., 126.99993965,
       126.94247838, 127.2864894 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:03:10] [32mIntermediate result: 0.030836155638098717  (Index 0)[0m
Epoch: 1 | cost time: 703.5964195728302 | valid_loss: 0.030836155638098717 | valid_loss_true: 1.7153285872732036
Pretest loss in this epoch: 11.357795727541818
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0023
	speed: 1.520903s/iter; left time: 141836.377798s
	iters: 764, epoch: 2 | train_loss : 0.0021
	speed: 0.263719s/iter; left time: 24493.206606s
	iters: 1146, epoch: 2 | train_loss : 0.0115
	speed: 0.193974s/iter; left time: 17941.410143s
	iters: 1528, epoch: 2 | train_loss : 0.0018
	speed: 0.169013s/iter; left time: 15568.136003s
	iters: 1910, epoch: 2 | train_loss : 0.0012
	speed: 0.192263s/iter; left time: 17636.298872s
data: {'predict': array([158.87955959, 158.69742495, 158.60423231, ..., 134.62355475,
       134.65087438, 134.9906277 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:31:00] [32mIntermediate result: 0.04161215201020241  (Index 1)[0m
Epoch: 2 | cost time: 1669.2414844036102 | valid_loss: 0.04161215201020241 | valid_loss_true: 1.895506085822111
Pretest loss in this epoch: 11.258640882438922
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0013
	speed: 3.561650s/iter; left time: 325346.073081s
	iters: 764, epoch: 3 | train_loss : 0.0016
	speed: 0.232522s/iter; left time: 21151.365280s
	iters: 1146, epoch: 3 | train_loss : 0.0017
	speed: 0.229056s/iter; left time: 20748.599048s
	iters: 1528, epoch: 3 | train_loss : 0.0016
	speed: 0.222468s/iter; left time: 20066.846916s
	iters: 1910, epoch: 3 | train_loss : 0.0014
	speed: 0.185824s/iter; left time: 16690.530657s
data: {'predict': array([159.49204454, 159.3215477 , 159.22627628, ..., 137.18072144,
       137.2778594 , 137.57824913]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:53:48] [32mIntermediate result: 0.04062478989362717  (Index 2)[0m
Epoch: 3 | cost time: 1368.0591869354248 | valid_loss: 0.04062478989362717 | valid_loss_true: 1.8354017004682686
Pretest loss in this epoch: 9.622733569277566
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0008
	speed: 2.571104s/iter; left time: 229949.273677s
	iters: 764, epoch: 4 | train_loss : 0.0016
	speed: 0.228531s/iter; left time: 20351.584489s
	iters: 1146, epoch: 4 | train_loss : 0.0010
	speed: 0.307637s/iter; left time: 27278.781751s
	iters: 1528, epoch: 4 | train_loss : 0.0009
	speed: 0.288957s/iter; left time: 25511.979456s
	iters: 1910, epoch: 4 | train_loss : 0.0075
	speed: 0.276182s/iter; left time: 24278.648454s
data: {'predict': array([159.28583044, 159.12276306, 159.01700746, ..., 140.37145848,
       140.52361155, 140.73621432]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:30:19] [32mIntermediate result: 0.03952636197209358  (Index 3)[0m
Epoch: 4 | cost time: 2191.036283969879 | valid_loss: 0.03952636197209358 | valid_loss_true: 1.8801200681599155
Pretest loss in this epoch: 9.281673890735904
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0013
	speed: 4.750481s/iter; left time: 415785.832328s
	iters: 764, epoch: 5 | train_loss : 0.0009
	speed: 0.159495s/iter; left time: 13898.847097s
	iters: 1146, epoch: 5 | train_loss : 0.0007
	speed: 0.267886s/iter; left time: 23242.035491s
	iters: 1528, epoch: 5 | train_loss : 0.0008
	speed: 0.361580s/iter; left time: 31232.886192s
	iters: 1910, epoch: 5 | train_loss : 0.0014
	speed: 0.344553s/iter; left time: 29630.504591s
data: {'predict': array([159.9118317 , 159.76104804, 159.68662367, ..., 143.56297366,
       143.70056678, 143.87396602]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 23:11:28] [32mIntermediate result: 0.0348331555724144  (Index 4)[0m
Epoch: 5 | cost time: 2469.3655149936676 | valid_loss: 0.0348331555724144 | valid_loss_true: 1.6750020601184827
Pretest loss in this epoch: 8.884206761512706
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0007
	speed: 5.333274s/iter; left time: 456602.933379s
	iters: 764, epoch: 6 | train_loss : 0.0008
	speed: 0.188680s/iter; left time: 16081.602301s
	iters: 1146, epoch: 6 | train_loss : 0.0009
	speed: 0.199052s/iter; left time: 16889.561240s
	iters: 1528, epoch: 6 | train_loss : 0.0010
	speed: 0.232971s/iter; left time: 19678.590352s
	iters: 1910, epoch: 6 | train_loss : 0.0011
	speed: 0.262610s/iter; left time: 22081.808283s
data: {'predict': array([160.31384062, 160.1664727 , 160.08213957, ..., 144.10592375,
       144.26626784, 144.40153961]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 23:44:56] [32mIntermediate result: 0.030542995780706406  (Index 5)[0m
Epoch: 6 | cost time: 2007.3186204433441 | valid_loss: 0.030542995780706406 | valid_loss_true: 1.5227656341459839
Pretest loss in this epoch: 7.456799162540634
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0006
	speed: 4.268477s/iter; left time: 357284.318043s
	iters: 764, epoch: 7 | train_loss : 0.0007
	speed: 0.099592s/iter; left time: 8298.107458s
	iters: 1146, epoch: 7 | train_loss : 0.0012
	speed: 0.144692s/iter; left time: 12000.593455s
	iters: 1528, epoch: 7 | train_loss : 0.0011
	speed: 0.181413s/iter; left time: 14976.891156s
	iters: 1910, epoch: 7 | train_loss : 0.0007
	speed: 0.209721s/iter; left time: 17233.787922s
data: {'predict': array([160.33024241, 160.19122065, 160.11400953, ..., 145.33922288,
       145.53098141, 145.65251968]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 00:24:30] [32mIntermediate result: 0.031008392572402954  (Index 6)[0m
Epoch: 7 | cost time: 2374.8666021823883 | valid_loss: 0.031008392572402954 | valid_loss_true: 1.5536488359659426
Pretest loss in this epoch: 7.671467374907436
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0008
	speed: 5.793610s/iter; left time: 473870.948904s
	iters: 764, epoch: 8 | train_loss : 0.0008
	speed: 0.297405s/iter; left time: 24211.730187s
	iters: 1146, epoch: 8 | train_loss : 0.0005
	speed: 0.278712s/iter; left time: 22583.494033s
	iters: 1528, epoch: 8 | train_loss : 0.0009
	speed: 0.217086s/iter; left time: 17507.126261s
	iters: 1910, epoch: 8 | train_loss : 0.0008
	speed: 0.270690s/iter; left time: 21726.693008s
data: {'predict': array([160.32058185, 160.18391247, 160.10912425, ..., 145.3415936 ,
       145.5328684 , 145.62833021]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:00:16] [32mIntermediate result: 0.03353392705321312  (Index 7)[0m
Epoch: 8 | cost time: 2145.1991200447083 | valid_loss: 0.03353392705321312 | valid_loss_true: 1.627520946580535
Pretest loss in this epoch: 7.486528707902369
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0021
	speed: 4.379858s/iter; left time: 349867.445233s
	iters: 764, epoch: 9 | train_loss : 0.0006
	speed: 0.159784s/iter; left time: 12702.671587s
	iters: 1146, epoch: 9 | train_loss : 0.0007
	speed: 0.217081s/iter; left time: 17174.794073s
	iters: 1528, epoch: 9 | train_loss : 0.0009
	speed: 0.269819s/iter; left time: 21244.227762s
	iters: 1910, epoch: 9 | train_loss : 0.0015
	speed: 0.194192s/iter; left time: 15215.531944s
data: {'predict': array([160.12242902, 160.00193297, 159.93989668, ..., 146.05953375,
       146.23924409, 146.32690271]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:16:57] [32mIntermediate result: 0.03340544551610947  (Index 8)[0m
Epoch: 9 | cost time: 1001.5214850902557 | valid_loss: 0.03340544551610947 | valid_loss_true: 1.6233396519344299
Pretest loss in this epoch: 7.295640160319936
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0006
	speed: 1.724216s/iter; left time: 134437.095773s
	iters: 764, epoch: 10 | train_loss : 0.0006
	speed: 0.093200s/iter; left time: 7231.222000s
	iters: 1146, epoch: 10 | train_loss : 0.0008
	speed: 0.196319s/iter; left time: 15156.976545s
	iters: 1528, epoch: 10 | train_loss : 0.0007
	speed: 0.217778s/iter; left time: 16730.576250s
	iters: 1910, epoch: 10 | train_loss : 0.0006
	speed: 0.207124s/iter; left time: 15832.986153s
data: {'predict': array([159.76167421, 159.64211178, 159.58792522, ..., 146.31722523,
       146.49836702, 146.57949313]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:31:45] [32mIntermediate result: 0.036918994039297104  (Index 9)[0m
Epoch: 10 | cost time: 887.4094088077545 | valid_loss: 0.036918994039297104 | valid_loss_true: 1.7585877907619825
Pretest loss in this epoch: 7.36242588026447
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0006
	speed: 1.605269s/iter; left time: 122095.191864s
	iters: 764, epoch: 11 | train_loss : 0.0012
	speed: 0.113109s/iter; left time: 8559.773036s
	iters: 1146, epoch: 11 | train_loss : 0.0008
	speed: 0.191093s/iter; left time: 14388.364245s
	iters: 1528, epoch: 11 | train_loss : 0.0008
	speed: 0.209029s/iter; left time: 15658.967116s
	iters: 1910, epoch: 11 | train_loss : 0.0543
	speed: 0.180363s/iter; left time: 13442.601475s
data: {'predict': array([159.82029193, 159.70072103, 159.64485622, ..., 146.08721231,
       146.28083243, 146.35202157]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:45:52] [32mIntermediate result: 0.036745812743902206  (Index 10)[0m
Epoch: 11 | cost time: 847.2244567871094 | valid_loss: 0.036745812743902206 | valid_loss_true: 1.744620609628274
Pretest loss in this epoch: 7.137145032975096
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0009
	speed: 1.526277s/iter; left time: 113170.394983s
	iters: 764, epoch: 12 | train_loss : 0.0008
	speed: 0.130428s/iter; left time: 9621.170192s
	iters: 1146, epoch: 12 | train_loss : 0.0011
	speed: 0.183993s/iter; left time: 13502.131458s
	iters: 1528, epoch: 12 | train_loss : 0.0007
	speed: 0.185374s/iter; left time: 13532.691543s
	iters: 1910, epoch: 12 | train_loss : 0.0007
	speed: 0.174275s/iter; left time: 12655.871444s
data: {'predict': array([160.15744678, 160.04341272, 159.99100596, ..., 147.51143648,
       147.69963541, 147.76072962]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:00:30] [32mIntermediate result: 0.033582303673028946  (Index 11)[0m
Epoch: 12 | cost time: 878.5894787311554 | valid_loss: 0.033582303673028946 | valid_loss_true: 1.6731460890092102
Pretest loss in this epoch: 7.234215939683415
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0009
	speed: 1.642499s/iter; left time: 118649.210542s
	iters: 764, epoch: 13 | train_loss : 0.0007
	speed: 0.139637s/iter; left time: 10033.604770s
	iters: 1146, epoch: 13 | train_loss : 0.0007
	speed: 0.144159s/iter; left time: 10303.494315s
	iters: 1528, epoch: 13 | train_loss : 0.0010
	speed: 0.179396s/iter; left time: 12753.448682s
	iters: 1910, epoch: 13 | train_loss : 0.0008
	speed: 0.165208s/iter; left time: 11681.658679s
data: {'predict': array([159.7196247 , 159.6109667 , 159.56213083, ..., 148.29900316,
       148.47613405, 148.52954213]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:14:06] [32mIntermediate result: 0.037127722054719925  (Index 12)[0m
Epoch: 13 | cost time: 815.1971640586853 | valid_loss: 0.037127722054719925 | valid_loss_true: 1.784168094647465
Pretest loss in this epoch: 7.70510361139618
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0008
	speed: 1.533174s/iter; left time: 107822.009374s
	iters: 764, epoch: 14 | train_loss : 0.0007
	speed: 0.161519s/iter; left time: 11297.251238s
	iters: 1146, epoch: 14 | train_loss : 0.0006
	speed: 0.186276s/iter; left time: 12957.723702s
	iters: 1528, epoch: 14 | train_loss : 0.0005
	speed: 0.161206s/iter; left time: 11152.215071s
	iters: 1910, epoch: 14 | train_loss : 0.0007
	speed: 0.161968s/iter; left time: 11143.058466s
data: {'predict': array([159.35449232, 159.25478973, 159.20540665, ..., 147.13635302,
       147.33670169, 147.38748942]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:27:01] [32mIntermediate result: 0.04167017340660095  (Index 13)[0m
Epoch: 14 | cost time: 775.0973174571991 | valid_loss: 0.04167017340660095 | valid_loss_true: 1.9740855920840703
Pretest loss in this epoch: 7.5017239927057
Early stop with best valid_loss: 0.04167017340660095
[2024-03-07 02:27:01] [32mFinal result: 0.030542995780706406[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 02:27:06.213223: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 02:27:06.213285: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 02:27:06.214944: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 02:27:06.222812: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:27:07.249871: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0170
	speed: 0.090996s/iter; left time: 8659.951236s
	iters: 764, epoch: 1 | train_loss : 0.0228
	speed: 0.177595s/iter; left time: 16833.713001s
	iters: 1146, epoch: 1 | train_loss : 0.0077
	speed: 0.195121s/iter; left time: 18420.397824s
	iters: 1528, epoch: 1 | train_loss : 0.0113
	speed: 0.185114s/iter; left time: 17404.960522s
	iters: 1910, epoch: 1 | train_loss : 0.0096
	speed: 0.159986s/iter; left time: 14981.283488s
data: {'predict': array([0.50451996, 0.50351999, 0.50244227, ..., 0.25813844, 0.25734735,
       0.25777917]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 02:39:49] [32mIntermediate result: 0.14461003243923187  (Index 0)[0m
Epoch: 1 | cost time: 756.4614405632019 | valid_loss: 0.14461003243923187 | valid_loss_true: 0.028172076859428154
Pretest loss in this epoch: 0.06781089722943412
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0057
	speed: 1.338916s/iter; left time: 124864.674801s
	iters: 764, epoch: 2 | train_loss : 0.0105
	speed: 0.185933s/iter; left time: 17268.713030s
	iters: 1146, epoch: 2 | train_loss : 0.0589
	speed: 0.199014s/iter; left time: 18407.561683s
	iters: 1528, epoch: 2 | train_loss : 0.0046
	speed: 0.201567s/iter; left time: 18566.715312s
	iters: 1910, epoch: 2 | train_loss : 0.0061
	speed: 0.151023s/iter; left time: 13853.322358s
data: {'predict': array([0.50611895, 0.50476392, 0.50404605, ..., 0.29286118, 0.29227545,
       0.29226011]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 02:52:29] [32mIntermediate result: 0.15600493550300598  (Index 1)[0m
Epoch: 2 | cost time: 760.0384991168976 | valid_loss: 0.15600493550300598 | valid_loss_true: 0.029886557145741805
Pretest loss in this epoch: 0.0689168215465302
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0059
	speed: 1.240374s/iter; left time: 113304.430577s
	iters: 764, epoch: 3 | train_loss : 0.0046
	speed: 0.164052s/iter; left time: 14923.012342s
	iters: 1146, epoch: 3 | train_loss : 0.0083
	speed: 0.176534s/iter; left time: 15990.972300s
	iters: 1528, epoch: 3 | train_loss : 0.0069
	speed: 0.190418s/iter; left time: 17175.888050s
	iters: 1910, epoch: 3 | train_loss : 0.0055
	speed: 0.126468s/iter; left time: 11359.203280s
data: {'predict': array([0.51147645, 0.51020777, 0.50946422, ..., 0.3272408 , 0.32668646,
       0.32679683]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:03:48] [32mIntermediate result: 0.14119617640972137  (Index 2)[0m
Epoch: 3 | cost time: 678.976222038269 | valid_loss: 0.14119617640972137 | valid_loss_true: 0.0278168161029904
Pretest loss in this epoch: 0.06651245221565963
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0062
	speed: 1.150409s/iter; left time: 102887.938025s
	iters: 764, epoch: 4 | train_loss : 0.0067
	speed: 0.160529s/iter; left time: 14295.721217s
	iters: 1146, epoch: 4 | train_loss : 0.0058
	speed: 0.159266s/iter; left time: 14122.405477s
	iters: 1528, epoch: 4 | train_loss : 0.0054
	speed: 0.160282s/iter; left time: 14151.255697s
	iters: 1910, epoch: 4 | train_loss : 0.0378
	speed: 0.096024s/iter; left time: 8441.268154s
data: {'predict': array([0.50449797, 0.50323819, 0.50279035, ..., 0.34530507, 0.34456135,
       0.34477886]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:14:52] [32mIntermediate result: 0.16763761639595032  (Index 3)[0m
Epoch: 4 | cost time: 664.2606739997864 | valid_loss: 0.16763761639595032 | valid_loss_true: 0.03289664122732039
Pretest loss in this epoch: 0.08286964543820688
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0098
	speed: 1.160281s/iter; left time: 101553.606627s
	iters: 764, epoch: 5 | train_loss : 0.0051
	speed: 0.177583s/iter; left time: 15475.097458s
	iters: 1146, epoch: 5 | train_loss : 0.0056
	speed: 0.177543s/iter; left time: 15403.832680s
	iters: 1528, epoch: 5 | train_loss : 0.0055
	speed: 0.158852s/iter; left time: 13721.497708s
	iters: 1910, epoch: 5 | train_loss : 0.0079
	speed: 0.156687s/iter; left time: 13474.592834s
data: {'predict': array([0.51324983, 0.51202764, 0.51139473, ..., 0.34572268, 0.34511629,
       0.34533157]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:26:16] [32mIntermediate result: 0.13599839806556702  (Index 4)[0m
Epoch: 5 | cost time: 683.9377887248993 | valid_loss: 0.13599839806556702 | valid_loss_true: 0.027903810975779708
Pretest loss in this epoch: 0.07260140682231764
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0045
	speed: 1.096470s/iter; left time: 93873.183775s
	iters: 764, epoch: 6 | train_loss : 0.0068
	speed: 0.155760s/iter; left time: 13275.700510s
	iters: 1146, epoch: 6 | train_loss : 0.0081
	speed: 0.181721s/iter; left time: 15419.018072s
	iters: 1528, epoch: 6 | train_loss : 0.0079
	speed: 0.182764s/iter; left time: 15437.743792s
	iters: 1910, epoch: 6 | train_loss : 0.0083
	speed: 0.181457s/iter; left time: 15257.979731s
data: {'predict': array([0.51384368, 0.51281128, 0.51217601, ..., 0.35767174, 0.35713318,
       0.35723032]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:37:54] [32mIntermediate result: 0.14202964305877686  (Index 5)[0m
Epoch: 6 | cost time: 697.9780542850494 | valid_loss: 0.14202964305877686 | valid_loss_true: 0.02883183027309972
Pretest loss in this epoch: 0.08975073050229741
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0042
	speed: 1.147720s/iter; left time: 96067.595030s
	iters: 764, epoch: 7 | train_loss : 0.0046
	speed: 0.158644s/iter; left time: 13218.403736s
	iters: 1146, epoch: 7 | train_loss : 0.0050
	speed: 0.164180s/iter; left time: 13616.960617s
	iters: 1528, epoch: 7 | train_loss : 0.0062
	speed: 0.172783s/iter; left time: 14264.443528s
	iters: 1910, epoch: 7 | train_loss : 0.0056
	speed: 0.125619s/iter; left time: 10322.732979s
data: {'predict': array([0.5137053 , 0.51263785, 0.51188626, ..., 0.36089167, 0.36065221,
       0.36054428]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:50:27] [32mIntermediate result: 0.13772132992744446  (Index 6)[0m
Epoch: 7 | cost time: 752.8782458305359 | valid_loss: 0.13772132992744446 | valid_loss_true: 0.02869172136678657
Pretest loss in this epoch: 0.09066644316124138
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0044
	speed: 1.353531s/iter; left time: 110708.037355s
	iters: 764, epoch: 8 | train_loss : 0.0046
	speed: 0.165336s/iter; left time: 13459.997539s
	iters: 1146, epoch: 8 | train_loss : 0.0025
	speed: 0.162188s/iter; left time: 13141.749446s
	iters: 1528, epoch: 8 | train_loss : 0.0087
	speed: 0.110357s/iter; left time: 8899.810652s
	iters: 1910, epoch: 8 | train_loss : 0.0048
	speed: 0.075011s/iter; left time: 6020.661460s
data: {'predict': array([0.51353458, 0.51255475, 0.51192857, ..., 0.36406048, 0.36379248,
       0.36350854]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:02:41] [32mIntermediate result: 0.14023533463478088  (Index 7)[0m
Epoch: 8 | cost time: 734.6183226108551 | valid_loss: 0.14023533463478088 | valid_loss_true: 0.028833903370020182
Pretest loss in this epoch: 0.10604551975386634
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0145
	speed: 1.408705s/iter; left time: 112528.759507s
	iters: 764, epoch: 9 | train_loss : 0.0041
	speed: 0.181998s/iter; left time: 14468.626014s
	iters: 1146, epoch: 9 | train_loss : 0.0045
	speed: 0.167858s/iter; left time: 13280.440907s
	iters: 1528, epoch: 9 | train_loss : 0.0059
	speed: 0.140462s/iter; left time: 11059.259969s
	iters: 1910, epoch: 9 | train_loss : 0.0067
	speed: 0.073431s/iter; left time: 5753.521834s
data: {'predict': array([0.50820432, 0.50729058, 0.50663821, ..., 0.36360105, 0.36325218,
       0.36290816]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:14:30] [32mIntermediate result: 0.14631742238998413  (Index 8)[0m
Epoch: 9 | cost time: 708.7284817695618 | valid_loss: 0.14631742238998413 | valid_loss_true: 0.029975465905839157
Pretest loss in this epoch: 0.10752599930122013
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0058
	speed: 1.276973s/iter; left time: 99565.595253s
	iters: 764, epoch: 10 | train_loss : 0.0047
	speed: 0.194973s/iter; left time: 15127.566242s
	iters: 1146, epoch: 10 | train_loss : 0.0060
	speed: 0.196811s/iter; left time: 15195.007902s
	iters: 1528, epoch: 10 | train_loss : 0.0063
	speed: 0.185076s/iter; left time: 14218.271445s
	iters: 1910, epoch: 10 | train_loss : 0.0060
	speed: 0.108694s/iter; left time: 8308.780385s
data: {'predict': array([0.51068026, 0.50983177, 0.50921668, ..., 0.37007085, 0.36974362,
       0.36931718]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:26:49] [32mIntermediate result: 0.1433364599943161  (Index 9)[0m
Epoch: 10 | cost time: 738.5136711597443 | valid_loss: 0.1433364599943161 | valid_loss_true: 0.02929731223460984
Pretest loss in this epoch: 0.12039464766537286
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0031
	speed: 1.239924s/iter; left time: 94307.361112s
	iters: 764, epoch: 11 | train_loss : 0.0039
	speed: 0.164412s/iter; left time: 12442.218669s
	iters: 1146, epoch: 11 | train_loss : 0.0052
	speed: 0.174690s/iter; left time: 13153.263064s
	iters: 1528, epoch: 11 | train_loss : 0.0051
	speed: 0.193517s/iter; left time: 14496.931233s
	iters: 1910, epoch: 11 | train_loss : 0.0045
	speed: 0.113396s/iter; left time: 8451.495542s
data: {'predict': array([0.50753515, 0.50666782, 0.50603069, ..., 0.36657364, 0.36637126,
       0.36577377]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:38:44] [32mIntermediate result: 0.1563306450843811  (Index 10)[0m
Epoch: 11 | cost time: 715.8527002334595 | valid_loss: 0.1563306450843811 | valid_loss_true: 0.03159425171906944
Pretest loss in this epoch: 0.117125251077283
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0080
	speed: 1.241780s/iter; left time: 92075.490868s
	iters: 764, epoch: 12 | train_loss : 0.0057
	speed: 0.151943s/iter; left time: 11208.213265s
	iters: 1146, epoch: 12 | train_loss : 0.0048
	speed: 0.157867s/iter; left time: 11584.887085s
	iters: 1528, epoch: 12 | train_loss : 0.0054
	speed: 0.108984s/iter; left time: 7956.041294s
	iters: 1910, epoch: 12 | train_loss : 0.0051
	speed: 0.122254s/iter; left time: 8878.070589s
data: {'predict': array([0.51215731, 0.51129272, 0.51072587, ..., 0.36795353, 0.36774545,
       0.36714235]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:52:02] [32mIntermediate result: 0.14069341123104095  (Index 11)[0m
Epoch: 12 | cost time: 797.9243783950806 | valid_loss: 0.14069341123104095 | valid_loss_true: 0.02925169772993046
Pretest loss in this epoch: 0.12331812924182028
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0066
	speed: 1.543978s/iter; left time: 111532.336635s
	iters: 764, epoch: 13 | train_loss : 0.0043
	speed: 0.144620s/iter; left time: 10391.699502s
	iters: 1146, epoch: 13 | train_loss : 0.0051
	speed: 0.070367s/iter; left time: 5029.307125s
	iters: 1528, epoch: 13 | train_loss : 0.0050
	speed: 0.069612s/iter; left time: 4948.752483s
	iters: 1910, epoch: 13 | train_loss : 0.0055
	speed: 0.074161s/iter; left time: 5243.846241s
data: {'predict': array([0.50549615, 0.50470377, 0.50408195, ..., 0.37026646, 0.37015542,
       0.36954043]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:02:13] [32mIntermediate result: 0.15379947423934937  (Index 12)[0m
Epoch: 13 | cost time: 610.2348692417145 | valid_loss: 0.15379947423934937 | valid_loss_true: 0.031103968564285378
Pretest loss in this epoch: 0.13202800824892544
Early stop with best valid_loss: 0.15379947423934937
[2024-03-07 05:02:13] [32mFinal result: 0.13599839806556702[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 05:02:18.821833: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 05:02:18.821910: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 05:02:18.824045: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 05:02:18.836451: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 05:02:19.941504: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0155
	speed: 0.184676s/iter; left time: 17575.418598s
	iters: 764, epoch: 1 | train_loss : 0.0067
	speed: 0.176882s/iter; left time: 16766.137016s
	iters: 1146, epoch: 1 | train_loss : 0.0059
	speed: 0.174455s/iter; left time: 16469.420018s
	iters: 1528, epoch: 1 | train_loss : 0.0034
	speed: 0.155853s/iter; left time: 14653.746137s
	iters: 1910, epoch: 1 | train_loss : 0.0051
	speed: 0.106892s/iter; left time: 10009.464801s
data: {'predict': array([136.10599376, 135.95316669, 135.8292047 , ..., 122.56839384,
       122.6119377 , 122.76111599]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 05:13:22] [32mIntermediate result: 0.03439565375447273  (Index 0)[0m
Epoch: 1 | cost time: 655.845668554306 | valid_loss: 0.03439565375447273 | valid_loss_true: 1.7465334184713468
Pretest loss in this epoch: 24.404161177032684
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0050
	speed: 1.078989s/iter; left time: 100624.322598s
	iters: 764, epoch: 2 | train_loss : 0.0012
	speed: 0.154052s/iter; left time: 14307.772774s
	iters: 1146, epoch: 2 | train_loss : 0.0062
	speed: 0.166115s/iter; left time: 15364.684336s
	iters: 1528, epoch: 2 | train_loss : 0.0019
	speed: 0.172306s/iter; left time: 15871.494562s
	iters: 1910, epoch: 2 | train_loss : 0.0013
	speed: 0.178231s/iter; left time: 16349.138014s
data: {'predict': array([135.98787312, 135.87797137, 135.82620744, ..., 124.2969871 ,
       124.20747589, 124.43992936]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 05:24:36] [32mIntermediate result: 0.02620563842356205  (Index 1)[0m
Epoch: 2 | cost time: 674.5213255882263 | valid_loss: 0.02620563842356205 | valid_loss_true: 1.320073858288764
Pretest loss in this epoch: 21.67722707177221
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0014
	speed: 1.116680s/iter; left time: 102005.355688s
	iters: 764, epoch: 3 | train_loss : 0.0022
	speed: 0.155300s/iter; left time: 14126.822596s
	iters: 1146, epoch: 3 | train_loss : 0.0020
	speed: 0.153423s/iter; left time: 13897.492294s
	iters: 1528, epoch: 3 | train_loss : 0.0034
	speed: 0.154175s/iter; left time: 13906.751733s
	iters: 1910, epoch: 3 | train_loss : 0.0012
	speed: 0.123141s/iter; left time: 11060.414129s
data: {'predict': array([137.08313226, 136.98761357, 136.95693882, ..., 124.84349035,
       124.72043083, 124.97265159]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 05:36:09] [32mIntermediate result: 0.02460099384188652  (Index 2)[0m
Epoch: 3 | cost time: 693.0010230541229 | valid_loss: 0.02460099384188652 | valid_loss_true: 1.3496096337822205
Pretest loss in this epoch: 21.570520198128474
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0019
	speed: 1.199385s/iter; left time: 107268.198715s
	iters: 764, epoch: 4 | train_loss : 0.0014
	speed: 0.150531s/iter; left time: 13405.408339s
	iters: 1146, epoch: 4 | train_loss : 0.0011
	speed: 0.108320s/iter; left time: 9604.969660s
	iters: 1528, epoch: 4 | train_loss : 0.0012
	speed: 0.067640s/iter; left time: 5971.959294s
	iters: 1910, epoch: 4 | train_loss : 0.0039
	speed: 0.066844s/iter; left time: 5876.084735s
data: {'predict': array([137.30451097, 137.21460271, 137.18312209, ..., 125.08558711,
       124.98646088, 125.23962888]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 05:46:14] [32mIntermediate result: 0.027921801432967186  (Index 3)[0m
Epoch: 4 | cost time: 604.6903893947601 | valid_loss: 0.027921801432967186 | valid_loss_true: 1.3540933072693524
Pretest loss in this epoch: 20.25636095993645
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0009
	speed: 1.191111s/iter; left time: 104252.023689s
	iters: 764, epoch: 5 | train_loss : 0.0009
	speed: 0.076680s/iter; left time: 6682.156941s
	iters: 1146, epoch: 5 | train_loss : 0.0024
	speed: 0.068374s/iter; left time: 5932.224906s
	iters: 1528, epoch: 5 | train_loss : 0.0009
	speed: 0.070535s/iter; left time: 6092.775443s
	iters: 1910, epoch: 5 | train_loss : 0.0014
	speed: 0.073809s/iter; left time: 6347.318401s
data: {'predict': array([137.83381651, 137.74477538, 137.73832374, ..., 126.80039701,
       126.70819604, 126.96216283]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 05:55:17] [32mIntermediate result: 0.033428918570280075  (Index 4)[0m
Epoch: 5 | cost time: 542.821266412735 | valid_loss: 0.033428918570280075 | valid_loss_true: 1.6044254850729662
Pretest loss in this epoch: 19.578255273953864
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0007
	speed: 1.126468s/iter; left time: 96441.438618s
	iters: 764, epoch: 6 | train_loss : 0.0008
	speed: 0.107092s/iter; left time: 9127.652613s
	iters: 1146, epoch: 6 | train_loss : 0.0009
	speed: 0.069183s/iter; left time: 5870.162677s
	iters: 1528, epoch: 6 | train_loss : 0.0008
	speed: 0.071463s/iter; left time: 6036.319663s
	iters: 1910, epoch: 6 | train_loss : 0.0015
	speed: 0.070712s/iter; left time: 5945.873040s
data: {'predict': array([138.13655823, 138.05281414, 138.04173466, ..., 127.41749011,
       127.34343997, 127.58742652]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:05:51] [32mIntermediate result: 0.03488517552614212  (Index 5)[0m
Epoch: 6 | cost time: 634.5013201236725 | valid_loss: 0.03488517552614212 | valid_loss_true: 1.6683050990485329
Pretest loss in this epoch: 18.879053434897312
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0005
	speed: 1.270437s/iter; left time: 106339.376691s
	iters: 764, epoch: 7 | train_loss : 0.0006
	speed: 0.069631s/iter; left time: 5801.738735s
	iters: 1146, epoch: 7 | train_loss : 0.0008
	speed: 0.068930s/iter; left time: 5717.017046s
	iters: 1528, epoch: 7 | train_loss : 0.0013
	speed: 0.100655s/iter; left time: 8309.771815s
	iters: 1910, epoch: 7 | train_loss : 0.0008
	speed: 0.154057s/iter; left time: 12659.674006s
data: {'predict': array([138.24680636, 138.17068501, 138.16438889, ..., 127.11157087,
       127.0173788 , 127.27650832]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:14:57] [32mIntermediate result: 0.03566594421863556  (Index 6)[0m
Epoch: 7 | cost time: 545.7284491062164 | valid_loss: 0.03566594421863556 | valid_loss_true: 1.6916508277087403
Pretest loss in this epoch: 18.08294232657007
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0011
	speed: 1.033901s/iter; left time: 84564.853607s
	iters: 764, epoch: 8 | train_loss : 0.0008
	speed: 0.068107s/iter; left time: 5544.567259s
	iters: 1146, epoch: 8 | train_loss : 0.0007
	speed: 0.115793s/iter; left time: 9382.458088s
	iters: 1528, epoch: 8 | train_loss : 0.0009
	speed: 0.152803s/iter; left time: 12322.984188s
	iters: 1910, epoch: 8 | train_loss : 0.0011
	speed: 0.156690s/iter; left time: 12576.585616s
data: {'predict': array([138.50559775, 138.42700225, 138.41185103, ..., 127.83802141,
       127.75852107, 128.00130825]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:23:33] [32mIntermediate result: 0.03718354552984238  (Index 7)[0m
Epoch: 8 | cost time: 515.7094342708588 | valid_loss: 0.03718354552984238 | valid_loss_true: 1.7272826329154316
Pretest loss in this epoch: 17.456712844397803
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0007
	speed: 0.851927s/iter; left time: 68052.781749s
	iters: 764, epoch: 9 | train_loss : 0.0007
	speed: 0.154548s/iter; left time: 12286.431818s
	iters: 1146, epoch: 9 | train_loss : 0.0009
	speed: 0.151771s/iter; left time: 12007.644819s
	iters: 1528, epoch: 9 | train_loss : 0.0007
	speed: 0.149236s/iter; left time: 11750.089041s
	iters: 1910, epoch: 9 | train_loss : 0.0009
	speed: 0.136190s/iter; left time: 10670.883529s
data: {'predict': array([138.48771318, 138.41408247, 138.40296058, ..., 127.95187591,
       127.86776894, 128.105986  ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:32:03] [32mIntermediate result: 0.03906026855111122  (Index 8)[0m
Epoch: 9 | cost time: 510.51175594329834 | valid_loss: 0.03906026855111122 | valid_loss_true: 1.7958538816053335
Pretest loss in this epoch: 17.22403842065069
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0028
	speed: 0.831850s/iter; left time: 64859.320077s
	iters: 764, epoch: 10 | train_loss : 0.0006
	speed: 0.147668s/iter; left time: 11457.270569s
	iters: 1146, epoch: 10 | train_loss : 0.0007
	speed: 0.146504s/iter; left time: 11310.970253s
	iters: 1528, epoch: 10 | train_loss : 0.0008
	speed: 0.106069s/iter; left time: 8148.645046s
	iters: 1910, epoch: 10 | train_loss : 0.0007
	speed: 0.071889s/iter; left time: 5495.329046s
data: {'predict': array([138.39062989, 138.32229857, 138.31266588, ..., 128.74459007,
       128.66529945, 128.88689376]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:42:10] [32mIntermediate result: 0.03571784123778343  (Index 9)[0m
Epoch: 10 | cost time: 606.505589723587 | valid_loss: 0.03571784123778343 | valid_loss_true: 1.6634048945166375
Pretest loss in this epoch: 18.162418412523586
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0008
	speed: 1.109155s/iter; left time: 84361.182230s
	iters: 764, epoch: 11 | train_loss : 0.0010
	speed: 0.107605s/iter; left time: 8143.227303s
	iters: 1146, epoch: 11 | train_loss : 0.0015
	speed: 0.071894s/iter; left time: 5413.264912s
	iters: 1528, epoch: 11 | train_loss : 0.0007
	speed: 0.070020s/iter; left time: 5245.410624s
	iters: 1910, epoch: 11 | train_loss : 0.0719
	speed: 0.070554s/iter; left time: 5258.497242s
data: {'predict': array([138.32840855, 138.25811912, 138.24950201, ..., 128.28177555,
       128.19658231, 128.42118802]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 06:52:50] [32mIntermediate result: 0.033003680408000946  (Index 10)[0m
Epoch: 11 | cost time: 640.183393239975 | valid_loss: 0.033003680408000946 | valid_loss_true: 1.5687383354665714
Pretest loss in this epoch: 17.71646000446709
Early stop with best valid_loss: 0.033003680408000946
[2024-03-07 06:52:50] [32mFinal result: 0.02460099384188652[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度', target_cols='1效出料温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 06:52:55.926051: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 06:52:55.926106: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 06:52:55.927786: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 06:52:55.936617: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 06:52:56.955849: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0015
	speed: 0.075579s/iter; left time: 7192.751931s
	iters: 764, epoch: 1 | train_loss : 0.0006
	speed: 0.072550s/iter; left time: 6876.754226s
	iters: 1146, epoch: 1 | train_loss : 0.0003
	speed: 0.070966s/iter; left time: 6699.535775s
	iters: 1528, epoch: 1 | train_loss : 0.0002
	speed: 0.102830s/iter; left time: 9668.371940s
	iters: 1910, epoch: 1 | train_loss : 0.0001
	speed: 0.147103s/iter; left time: 13774.904758s
data: {'predict': array([148.7368499 , 148.73714528, 148.73716204, ..., 148.76020035,
       148.7612283 , 148.76314424]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:02:16] [32mIntermediate result: 0.003239990910515189  (Index 0)[0m
Epoch: 1 | cost time: 553.8473732471466 | valid_loss: 0.003239990910515189 | valid_loss_true: 0.007232460059875323
Pretest loss in this epoch: 14.47688811198001
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0001
	speed: 1.057488s/iter; left time: 98619.187985s
	iters: 764, epoch: 2 | train_loss : 0.0001
	speed: 0.070101s/iter; left time: 6510.676153s
	iters: 1146, epoch: 2 | train_loss : 0.0000
	speed: 0.127771s/iter; left time: 11818.071999s
	iters: 1528, epoch: 2 | train_loss : 0.0000
	speed: 0.151353s/iter; left time: 13941.423659s
	iters: 1910, epoch: 2 | train_loss : 0.0000
	speed: 0.154835s/iter; left time: 14203.006657s
data: {'predict': array([148.74420374, 148.74433855, 148.7442552 , ..., 148.75499756,
       148.75568313, 148.75655491]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:10:45] [32mIntermediate result: 0.0013100692303851247  (Index 1)[0m
Epoch: 2 | cost time: 509.0778880119324 | valid_loss: 0.0013100692303851247 | valid_loss_true: 0.0031482146538905588
Pretest loss in this epoch: 14.473775045137947
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0000
	speed: 0.836441s/iter; left time: 76406.369479s
	iters: 764, epoch: 3 | train_loss : 0.0000
	speed: 0.152130s/iter; left time: 13838.470387s
	iters: 1146, epoch: 3 | train_loss : 0.0000
	speed: 0.147443s/iter; left time: 13355.808628s
	iters: 1528, epoch: 3 | train_loss : 0.0000
	speed: 0.151765s/iter; left time: 13689.374594s
	iters: 1910, epoch: 3 | train_loss : 0.0000
	speed: 0.136138s/iter; left time: 12227.818132s
data: {'predict': array([148.74717125, 148.74725732, 148.74717444, ..., 148.75269688,
       148.75318533, 148.75362542]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:19:15] [32mIntermediate result: 0.0014996390091255307  (Index 2)[0m
Epoch: 3 | cost time: 509.87541031837463 | valid_loss: 0.0014996390091255307 | valid_loss_true: 0.0023551888979120093
Pretest loss in this epoch: 14.472426882199047
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0000
	speed: 0.812023s/iter; left time: 72624.123520s
	iters: 764, epoch: 4 | train_loss : 0.0000
	speed: 0.148627s/iter; left time: 13235.785534s
	iters: 1146, epoch: 4 | train_loss : 0.0000
	speed: 0.147939s/iter; left time: 13118.091157s
	iters: 1528, epoch: 4 | train_loss : 0.0000
	speed: 0.117256s/iter; left time: 10352.534315s
	iters: 1910, epoch: 4 | train_loss : 0.0000
	speed: 0.068699s/iter; left time: 6039.215319s
data: {'predict': array([148.74824149, 148.74828658, 148.7482201 , ..., 148.75114615,
       148.75147694, 148.75171089]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:28:49] [32mIntermediate result: 0.001321885036304593  (Index 3)[0m
Epoch: 4 | cost time: 574.0764329433441 | valid_loss: 0.001321885036304593 | valid_loss_true: 0.0016964844428007824
Pretest loss in this epoch: 14.471771274107313
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0000
	speed: 1.028222s/iter; left time: 89995.159866s
	iters: 764, epoch: 5 | train_loss : 0.0000
	speed: 0.152036s/iter; left time: 13248.882039s
	iters: 1146, epoch: 5 | train_loss : 0.0000
	speed: 0.069277s/iter; left time: 6010.573588s
	iters: 1528, epoch: 5 | train_loss : 0.0000
	speed: 0.068734s/iter; left time: 5937.166842s
	iters: 1910, epoch: 5 | train_loss : 0.0000
	speed: 0.070475s/iter; left time: 6060.606563s
data: {'predict': array([148.74870595, 148.74873723, 148.74869511, ..., 148.75060998,
       148.75082652, 148.75095628]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:38:32] [32mIntermediate result: 0.0011874609626829624  (Index 4)[0m
Epoch: 5 | cost time: 583.4368286132812 | valid_loss: 0.0011874609626829624 | valid_loss_true: 0.0014241786452110741
Pretest loss in this epoch: 14.471623202432315
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0000
	speed: 1.168007s/iter; left time: 99997.734569s
	iters: 764, epoch: 6 | train_loss : 0.0000
	speed: 0.075936s/iter; left time: 6472.214422s
	iters: 1146, epoch: 6 | train_loss : 0.0000
	speed: 0.072446s/iter; left time: 6147.029851s
	iters: 1528, epoch: 6 | train_loss : 0.0000
	speed: 0.072147s/iter; left time: 6094.099080s
	iters: 1910, epoch: 6 | train_loss : 0.0000
	speed: 0.069503s/iter; left time: 5844.191914s
data: {'predict': array([148.74844675, 148.74846798, 148.74842961, ..., 148.74960978,
       148.74975704, 148.749822  ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:47:57] [32mIntermediate result: 0.0007390043465420604  (Index 5)[0m
Epoch: 6 | cost time: 564.4040145874023 | valid_loss: 0.0007390043465420604 | valid_loss_true: 0.0008465801290500157
Pretest loss in this epoch: 14.47118630432202
Chepoint Saved at:  ./checkpoints/allfeature/transformer/alumina_transformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0000
	speed: 1.188742s/iter; left time: 99501.293130s
	iters: 764, epoch: 7 | train_loss : 0.0000
	speed: 0.084485s/iter; left time: 7039.352040s
	iters: 1146, epoch: 7 | train_loss : 0.0000
	speed: 0.070421s/iter; left time: 5840.672046s
	iters: 1528, epoch: 7 | train_loss : 0.0000
	speed: 0.069761s/iter; left time: 5759.256332s
	iters: 1910, epoch: 7 | train_loss : 0.0000
	speed: 0.072205s/iter; left time: 5933.416222s
data: {'predict': array([148.74901251, 148.74902988, 148.74899743, ..., 148.74973691,
       148.74983777, 148.74986339]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 07:57:23] [32mIntermediate result: 0.0011293283896520734  (Index 6)[0m
Epoch: 7 | cost time: 565.8994262218475 | valid_loss: 0.0011293283896520734 | valid_loss_true: 0.0011484221610634443
Pretest loss in this epoch: 14.47131779217326
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0000
	speed: 1.177747s/iter; left time: 96330.280680s
	iters: 764, epoch: 8 | train_loss : 0.0000
	speed: 0.065173s/iter; left time: 5305.729403s
	iters: 1146, epoch: 8 | train_loss : 0.0000
	speed: 0.065976s/iter; left time: 5345.912276s
	iters: 1528, epoch: 8 | train_loss : 0.0000
	speed: 0.072936s/iter; left time: 5881.971992s
	iters: 1910, epoch: 8 | train_loss : 0.0000
	speed: 0.067581s/iter; left time: 5424.314431s
data: {'predict': array([148.7489076 , 148.74892064, 148.7488991 , ..., 148.74935851,
       148.74942653, 148.74944209]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:06:25] [32mIntermediate result: 0.0009386076708324254  (Index 7)[0m
Epoch: 8 | cost time: 542.4784007072449 | valid_loss: 0.0009386076708324254 | valid_loss_true: 0.0009568579333877493
Pretest loss in this epoch: 14.471142908351622
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0000
	speed: 1.151110s/iter; left time: 91951.814371s
	iters: 764, epoch: 9 | train_loss : 0.0000
	speed: 0.095146s/iter; left time: 7564.039596s
	iters: 1146, epoch: 9 | train_loss : 0.0000
	speed: 0.071318s/iter; left time: 5642.458781s
	iters: 1528, epoch: 9 | train_loss : 0.0000
	speed: 0.070054s/iter; left time: 5515.738592s
	iters: 1910, epoch: 9 | train_loss : 0.0000
	speed: 0.071941s/iter; left time: 5636.783637s
data: {'predict': array([148.74904177, 148.74905115, 148.74903578, ..., 148.74935047,
       148.74940217, 148.74941147]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:14:59] [32mIntermediate result: 0.0009977390291169286  (Index 8)[0m
Epoch: 9 | cost time: 513.4451415538788 | valid_loss: 0.0009977390291169286 | valid_loss_true: 0.0010172011631345943
Pretest loss in this epoch: 14.471182409720132
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0000
	speed: 1.035291s/iter; left time: 80721.644102s
	iters: 764, epoch: 10 | train_loss : 0.0000
	speed: 0.152182s/iter; left time: 11807.509934s
	iters: 1146, epoch: 10 | train_loss : 0.0000
	speed: 0.073459s/iter; left time: 5671.483542s
	iters: 1528, epoch: 10 | train_loss : 0.0000
	speed: 0.069459s/iter; left time: 5336.143643s
	iters: 1910, epoch: 10 | train_loss : 0.0000
	speed: 0.068738s/iter; left time: 5254.457786s
data: {'predict': array([148.74906772, 148.74907391, 148.7490626 , ..., 148.74925263,
       148.74929464, 148.74930148]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:23:34] [32mIntermediate result: 0.0009753475314937532  (Index 9)[0m
Epoch: 10 | cost time: 515.5208358764648 | valid_loss: 0.0009753475314937532 | valid_loss_true: 0.000987071422257535
Pretest loss in this epoch: 14.47114453485506
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0000
	speed: 0.989562s/iter; left time: 75265.126561s
	iters: 764, epoch: 11 | train_loss : 0.0000
	speed: 0.147355s/iter; left time: 11151.404910s
	iters: 1146, epoch: 11 | train_loss : 0.0000
	speed: 0.084564s/iter; left time: 6367.278986s
	iters: 1528, epoch: 11 | train_loss : 0.0000
	speed: 0.070740s/iter; left time: 5299.377656s
	iters: 1910, epoch: 11 | train_loss : 0.0000
	speed: 0.070051s/iter; left time: 5220.997857s
data: {'predict': array([148.74892078, 148.74892426, 148.74891395, ..., 148.74901459,
       148.74905022, 148.74905565]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:32:23] [32mIntermediate result: 0.0007826653891243041  (Index 10)[0m
Epoch: 11 | cost time: 528.6818222999573 | valid_loss: 0.0007826653891243041 | valid_loss_true: 0.0008127285825131433
Pretest loss in this epoch: 14.470998226631865
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0000
	speed: 1.005497s/iter; left time: 74555.613722s
	iters: 764, epoch: 12 | train_loss : 0.0000
	speed: 0.157510s/iter; left time: 11618.864548s
	iters: 1146, epoch: 12 | train_loss : 0.0000
	speed: 0.084664s/iter; left time: 6213.003927s
	iters: 1528, epoch: 12 | train_loss : 0.0000
	speed: 0.066190s/iter; left time: 4832.038829s
	iters: 1910, epoch: 12 | train_loss : 0.0000
	speed: 0.067168s/iter; left time: 4877.730269s
data: {'predict': array([148.74914225, 148.74914396, 148.74913497, ..., 148.74917451,
       148.7492061 , 148.74921123]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:41:05] [32mIntermediate result: 0.000973596703261137  (Index 11)[0m
Epoch: 12 | cost time: 522.3705742359161 | valid_loss: 0.000973596703261137 | valid_loss_true: 0.0009910885544501596
Pretest loss in this epoch: 14.471097162964588
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0000
	speed: 0.989471s/iter; left time: 71476.437314s
	iters: 764, epoch: 13 | train_loss : 0.0000
	speed: 0.154850s/iter; left time: 11126.781183s
	iters: 1146, epoch: 13 | train_loss : 0.0000
	speed: 0.089991s/iter; left time: 6431.930735s
	iters: 1528, epoch: 13 | train_loss : 0.0000
	speed: 0.068153s/iter; left time: 4845.031069s
	iters: 1910, epoch: 13 | train_loss : 0.0000
	speed: 0.069114s/iter; left time: 4886.971306s
data: {'predict': array([148.74892065, 148.7489229 , 148.74891752, ..., 148.74893379,
       148.74895981, 148.74896503]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 08:52:08] [32mIntermediate result: 0.0007533732568845153  (Index 12)[0m
Epoch: 13 | cost time: 662.8044848442078 | valid_loss: 0.0007533732568845153 | valid_loss_true: 0.0007748821340521955
Pretest loss in this epoch: 14.470959208170283
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0000
	speed: 1.275272s/iter; left time: 89684.793983s
	iters: 764, epoch: 14 | train_loss : 0.0000
	speed: 0.077859s/iter; left time: 5445.773721s
	iters: 1146, epoch: 14 | train_loss : 0.0000
	speed: 0.070937s/iter; left time: 4934.495890s
	iters: 1528, epoch: 14 | train_loss : 0.0000
	speed: 0.070526s/iter; left time: 4878.970422s
	iters: 1910, epoch: 14 | train_loss : 0.0000
	speed: 0.095516s/iter; left time: 6571.296465s
data: {'predict': array([148.74904003, 148.74904166, 148.74903782, ..., 148.74906164,
       148.74908534, 148.74909113]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:01:55] [32mIntermediate result: 0.0008457813528366387  (Index 13)[0m
Epoch: 14 | cost time: 587.0496933460236 | valid_loss: 0.0008457813528366387 | valid_loss_true: 0.0008742407742516825
Pretest loss in this epoch: 14.471032607360046
Early stop with best valid_loss: 0.0008457813528366387
[2024-03-07 09:01:55] [32mFinal result: 0.0007390043465420604[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
