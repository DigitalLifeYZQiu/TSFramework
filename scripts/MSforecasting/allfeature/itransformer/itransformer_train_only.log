python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 20:38:28.130023: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 20:38:28.130463: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 20:38:28.132634: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 20:38:28.142547: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 20:38:30.464790: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.7874
	speed: 0.243117s/iter; left time: 23137.176569s
	iters: 764, epoch: 1 | train_loss : 0.9940
	speed: 0.232533s/iter; left time: 22041.091027s
	iters: 1146, epoch: 1 | train_loss : 0.9965
	speed: 0.271129s/iter; left time: 25595.921308s
	iters: 1528, epoch: 1 | train_loss : 1.1780
	speed: 0.294406s/iter; left time: 27680.892052s
	iters: 1910, epoch: 1 | train_loss : 1.0507
	speed: 0.279114s/iter; left time: 26136.515578s
data: {'predict': array([109.49324976, 109.86918222, 107.89796321, ...,  55.33585459,
        55.12758144,  56.50195291]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 20:54:40] [32mIntermediate result: 0.7762852907180786  (Index 0)[0m
Epoch: 1 | cost time: 963.0276708602905 | valid_loss: 0.7762852907180786 | valid_loss_true: 36.5426574533277
Pretest loss in this epoch: 77.75206852699961
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.6246
	speed: 1.460877s/iter; left time: 136238.480453s
	iters: 764, epoch: 2 | train_loss : 2.5969
	speed: 0.277437s/iter; left time: 25767.220471s
	iters: 1146, epoch: 2 | train_loss : 1.1945
	speed: 0.278242s/iter; left time: 25735.728605s
	iters: 1528, epoch: 2 | train_loss : 0.7064
	speed: 0.264032s/iter; left time: 24320.516046s
	iters: 1910, epoch: 2 | train_loss : 1.0403
	speed: 0.240275s/iter; left time: 22040.407982s
data: {'predict': array([110.42879924, 110.51898654, 109.05736825, ...,  56.0796808 ,
        55.79932439,  56.82131259]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 21:10:58] [32mIntermediate result: 0.7674655914306641  (Index 1)[0m
Epoch: 2 | cost time: 977.7321000099182 | valid_loss: 0.7674655914306641 | valid_loss_true: 36.307977584829366
Pretest loss in this epoch: 77.51409751011904
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.7435
	speed: 1.523205s/iter; left time: 139140.231486s
	iters: 764, epoch: 3 | train_loss : 1.2886
	speed: 0.264158s/iter; left time: 24029.134616s
	iters: 1146, epoch: 3 | train_loss : 0.9501
	speed: 0.264364s/iter; left time: 23946.869661s
	iters: 1528, epoch: 3 | train_loss : 0.9815
	speed: 0.207787s/iter; left time: 18742.577685s
	iters: 1910, epoch: 3 | train_loss : 0.7869
	speed: 0.232735s/iter; left time: 20904.043665s
data: {'predict': array([109.0786525 , 109.160653  , 107.64609768, ...,  56.93733517,
        56.39364185,  57.2363696 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 21:27:06] [32mIntermediate result: 0.7708370685577393  (Index 2)[0m
Epoch: 3 | cost time: 967.8594839572906 | valid_loss: 0.7708370685577393 | valid_loss_true: 36.39504242372615
Pretest loss in this epoch: 77.55219725321001
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.2277
	speed: 1.588280s/iter; left time: 142049.377592s
	iters: 764, epoch: 4 | train_loss : 0.9324
	speed: 0.260869s/iter; left time: 23231.407025s
	iters: 1146, epoch: 4 | train_loss : 1.1274
	speed: 0.231137s/iter; left time: 20495.393276s
	iters: 1528, epoch: 4 | train_loss : 1.1423
	speed: 0.260581s/iter; left time: 23006.680482s
	iters: 1910, epoch: 4 | train_loss : 1.0298
	speed: 0.291901s/iter; left time: 25660.436170s
data: {'predict': array([109.84647639, 109.64889332, 108.72380403, ...,  56.36250242,
        56.14525412,  56.99566519]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 21:43:44] [32mIntermediate result: 0.7683480381965637  (Index 3)[0m
Epoch: 4 | cost time: 998.602861404419 | valid_loss: 0.7683480381965637 | valid_loss_true: 36.41493615292058
Pretest loss in this epoch: 77.5775768774997
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.5200
	speed: 1.569326s/iter; left time: 137355.227892s
	iters: 764, epoch: 5 | train_loss : 1.3083
	speed: 0.257458s/iter; left time: 22435.664966s
	iters: 1146, epoch: 5 | train_loss : 0.7650
	speed: 0.254413s/iter; left time: 22073.118979s
	iters: 1528, epoch: 5 | train_loss : 1.3353
	speed: 0.297246s/iter; left time: 25675.831257s
	iters: 1910, epoch: 5 | train_loss : 0.5635
	speed: 0.280567s/iter; left time: 24127.906241s
data: {'predict': array([110.16514784, 109.97175618, 109.17936204, ...,  56.50570995,
        56.11323466,  57.17079628]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 22:00:23] [32mIntermediate result: 0.7688350081443787  (Index 4)[0m
Epoch: 5 | cost time: 998.3294379711151 | valid_loss: 0.7688350081443787 | valid_loss_true: 36.32946438869424
Pretest loss in this epoch: 77.48096569648577
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.2280
	speed: 1.427329s/iter; left time: 122199.304001s
	iters: 764, epoch: 6 | train_loss : 0.6352
	speed: 0.230020s/iter; left time: 19605.082784s
	iters: 1146, epoch: 6 | train_loss : 0.9385
	speed: 0.253935s/iter; left time: 21546.388831s
	iters: 1528, epoch: 6 | train_loss : 1.0317
	speed: 0.258747s/iter; left time: 21855.814949s
	iters: 1910, epoch: 6 | train_loss : 1.4287
	speed: 0.227190s/iter; left time: 19103.508803s
data: {'predict': array([109.38436047, 109.12857431, 108.47014178, ...,  56.09211965,
        55.88389163,  56.66558723]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 22:15:46] [32mIntermediate result: 0.7712253928184509  (Index 5)[0m
Epoch: 6 | cost time: 923.4944243431091 | valid_loss: 0.7712253928184509 | valid_loss_true: 36.5194340687498
Pretest loss in this epoch: 77.67398485939142
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.8074
	speed: 1.524666s/iter; left time: 127619.097754s
	iters: 764, epoch: 7 | train_loss : 1.1160
	speed: 0.276064s/iter; left time: 23001.887686s
	iters: 1146, epoch: 7 | train_loss : 1.2593
	speed: 0.272330s/iter; left time: 22586.814635s
	iters: 1528, epoch: 7 | train_loss : 1.0689
	speed: 0.266719s/iter; left time: 22019.503263s
	iters: 1910, epoch: 7 | train_loss : 0.7667
	speed: 0.248328s/iter; left time: 20406.322922s
data: {'predict': array([109.40542472, 109.18034361, 108.59787549, ...,  55.22141154,
        54.83229277,  55.95395535]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 22:33:06] [32mIntermediate result: 0.7711026072502136  (Index 6)[0m
Epoch: 7 | cost time: 1039.3902702331543 | valid_loss: 0.7711026072502136 | valid_loss_true: 36.485807071751395
Pretest loss in this epoch: 77.65110055073887
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.8588
	speed: 1.683712s/iter; left time: 137714.210803s
	iters: 764, epoch: 8 | train_loss : 1.0476
	speed: 0.316777s/iter; left time: 25788.843384s
	iters: 1146, epoch: 8 | train_loss : 0.9142
	speed: 0.313755s/iter; left time: 25422.912463s
	iters: 1528, epoch: 8 | train_loss : 1.3304
	speed: 0.238045s/iter; left time: 19197.347295s
	iters: 1910, epoch: 8 | train_loss : 1.3227
	speed: 0.247285s/iter; left time: 19848.043740s
data: {'predict': array([110.04596618, 109.69785612, 109.24893216, ...,  55.36838739,
        55.36444983,  56.4120096 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 22:50:34] [32mIntermediate result: 0.7714570164680481  (Index 7)[0m
Epoch: 8 | cost time: 1048.402471780777 | valid_loss: 0.7714570164680481 | valid_loss_true: 36.47440700433697
Pretest loss in this epoch: 77.64343839408387
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.8929
	speed: 1.655939s/iter; left time: 132278.088123s
	iters: 764, epoch: 9 | train_loss : 0.9194
	speed: 0.290831s/iter; left time: 23120.788238s
	iters: 1146, epoch: 9 | train_loss : 1.0693
	speed: 0.256116s/iter; left time: 20263.155853s
	iters: 1528, epoch: 9 | train_loss : 0.6839
	speed: 0.267702s/iter; left time: 21077.494782s
	iters: 1910, epoch: 9 | train_loss : 1.0376
	speed: 0.297922s/iter; left time: 23343.048593s
data: {'predict': array([109.75302707, 109.40276771, 108.8082246 , ...,  55.50187513,
        55.43487459,  56.55745105]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 23:07:27] [32mIntermediate result: 0.7717306613922119  (Index 8)[0m
Epoch: 9 | cost time: 1012.8843052387238 | valid_loss: 0.7717306613922119 | valid_loss_true: 36.51070922291051
Pretest loss in this epoch: 77.67670054151996
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.9789
	speed: 1.438231s/iter; left time: 112138.853851s
	iters: 764, epoch: 10 | train_loss : 1.0549
	speed: 0.275397s/iter; left time: 21367.495842s
	iters: 1146, epoch: 10 | train_loss : 1.2168
	speed: 0.279207s/iter; left time: 21556.421713s
	iters: 1528, epoch: 10 | train_loss : 1.2598
	speed: 0.260810s/iter; left time: 20036.465003s
	iters: 1910, epoch: 10 | train_loss : 1.0525
	speed: 0.253816s/iter; left time: 19402.192401s
data: {'predict': array([109.73232104, 109.40620602, 108.84696273, ...,  55.42032029,
        55.34465486,  56.2998738 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 23:23:16] [32mIntermediate result: 0.770922064781189  (Index 9)[0m
Epoch: 10 | cost time: 949.6428112983704 | valid_loss: 0.770922064781189 | valid_loss_true: 36.463936908731306
Pretest loss in this epoch: 77.62632712145327
Early stop with best valid_loss: 0.770922064781189
[2024-03-07 23:23:16] [32mFinal result: 0.7674655914306641[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 23:23:23.586156: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 23:23:23.586570: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 23:23:23.588494: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 23:23:23.598226: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 23:23:25.381359: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 1.0602
	speed: 0.242110s/iter; left time: 23041.382768s
	iters: 764, epoch: 1 | train_loss : 1.0134
	speed: 0.258821s/iter; left time: 24532.878194s
	iters: 1146, epoch: 1 | train_loss : 0.9374
	speed: 0.268995s/iter; left time: 25394.461938s
	iters: 1528, epoch: 1 | train_loss : 1.2321
	speed: 0.276073s/iter; left time: 25957.236813s
	iters: 1910, epoch: 1 | train_loss : 0.8848
	speed: 0.236853s/iter; left time: 22179.167238s9192642569541931
data: {'predict': array([0.26969519, 0.27112498, 0.26309147, ..., 0.04464424, 0.04380735,
       0.04968815]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 23:39:17] [32mIntermediate result: 0.9271343946456909  (Index 0)[0m
Epoch: 1 | cost time: 944.2007186412811 | valid_loss: 0.9271343946456909 | valid_loss_true: 0.18186708326487672
Pretest loss in this epoch: 0.3694073380122913
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.6388
	speed: 1.486653s/iter; left time: 138642.310761s
	iters: 764, epoch: 2 | train_loss : 2.8499
	speed: 0.289276s/iter; left time: 26866.826942s
	iters: 1146, epoch: 2 | train_loss : 1.2749
	speed: 0.245437s/iter; left time: 22701.461060s
	iters: 1528, epoch: 2 | train_loss : 0.8022
	speed: 0.223743s/iter; left time: 20609.414465s
	iters: 1910, epoch: 2 | train_loss : 1.2642
	speed: 0.260286s/iter; left time: 23876.035388s
data: {'predict': array([0.27424536, 0.27455319, 0.26874204, ..., 0.04783286, 0.04649279,
       0.0510569 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 23:55:25] [32mIntermediate result: 0.9192642569541931  (Index 1)[0m
Epoch: 2 | cost time: 967.9237811565399 | valid_loss: 0.9192642569541931 | valid_loss_true: 0.18097284462960112
Pretest loss in this epoch: 0.3683203226365639
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.8473
	speed: 1.499284s/iter; left time: 136955.136453s
	iters: 764, epoch: 3 | train_loss : 1.3258
	speed: 0.249706s/iter; left time: 22714.498903s
	iters: 1146, epoch: 3 | train_loss : 1.2187
	speed: 0.239010s/iter; left time: 21650.224635s
	iters: 1528, epoch: 3 | train_loss : 1.1014
	speed: 0.249964s/iter; left time: 22547.010087s
	iters: 1910, epoch: 3 | train_loss : 0.9904
	speed: 0.238471s/iter; left time: 21419.185824s
data: {'predict': array([0.26854814, 0.26889575, 0.26277584, ..., 0.05162065, 0.04907984,
       0.05304707]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 00:12:27] [32mIntermediate result: 0.9224303960800171  (Index 2)[0m
Epoch: 3 | cost time: 1021.7276725769043 | valid_loss: 0.9224303960800171 | valid_loss_true: 0.1813246588083755
Pretest loss in this epoch: 0.36851759649005145
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.1420
	speed: 1.728537s/iter; left time: 154593.467366s
	iters: 764, epoch: 4 | train_loss : 1.2235
	speed: 0.301061s/iter; left time: 26810.685171s
	iters: 1146, epoch: 4 | train_loss : 1.2409
	speed: 0.290658s/iter; left time: 25773.268979s
	iters: 1528, epoch: 4 | train_loss : 1.1914
	speed: 0.300714s/iter; left time: 26550.056284s
	iters: 1910, epoch: 4 | train_loss : 1.2823
	speed: 0.299841s/iter; left time: 26358.438058s
data: {'predict': array([0.27150386, 0.27068489, 0.26717545, ..., 0.04871152, 0.04756301,
       0.05148324]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 00:31:51] [32mIntermediate result: 0.9203282594680786  (Index 3)[0m
Epoch: 4 | cost time: 1164.54629778862 | valid_loss: 0.9203282594680786 | valid_loss_true: 0.181442423974049
Pretest loss in this epoch: 0.3686916127633933
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.5825
	speed: 1.866987s/iter; left time: 163408.073990s
	iters: 764, epoch: 5 | train_loss : 1.3454
	speed: 0.291040s/iter; left time: 25362.056557s
	iters: 1146, epoch: 5 | train_loss : 0.9077
	speed: 0.274972s/iter; left time: 23856.861237s
	iters: 1528, epoch: 5 | train_loss : 1.4268
	speed: 0.311155s/iter; left time: 26877.262999s
	iters: 1910, epoch: 5 | train_loss : 0.8546
	speed: 0.316599s/iter; left time: 27226.604582s
data: {'predict': array([0.27285859, 0.27198419, 0.26907179, ..., 0.04915501, 0.04732057,
       0.05207495]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 00:51:36] [32mIntermediate result: 0.9210473895072937  (Index 4)[0m
Epoch: 5 | cost time: 1185.1885719299316 | valid_loss: 0.9210473895072937 | valid_loss_true: 0.18118644739861348
Pretest loss in this epoch: 0.36838107852271296
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.2443
	speed: 1.908902s/iter; left time: 163428.758944s
	iters: 764, epoch: 6 | train_loss : 0.9780
	speed: 0.292207s/iter; left time: 24905.381876s
	iters: 1146, epoch: 6 | train_loss : 0.8883
	speed: 0.277748s/iter; left time: 23566.887662s
	iters: 1528, epoch: 6 | train_loss : 1.2816
	speed: 0.275278s/iter; left time: 23252.162255s
	iters: 1910, epoch: 6 | train_loss : 1.1480
	speed: 0.288597s/iter; left time: 24266.957021s
data: {'predict': array([0.2701052 , 0.2690791 , 0.26675374, ..., 0.04748082, 0.0463776 ,
       0.04991215]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 01:10:50] [32mIntermediate result: 0.9233042001724243  (Index 5)[0m
Epoch: 6 | cost time: 1153.966635465622 | valid_loss: 0.9233042001724243 | valid_loss_true: 0.18194224754430366
Pretest loss in this epoch: 0.3692758533605151
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.8815
	speed: 1.878803s/iter; left time: 157261.482179s
	iters: 764, epoch: 7 | train_loss : 1.2780
	speed: 0.291867s/iter; left time: 24318.677735s
	iters: 1146, epoch: 7 | train_loss : 1.2866
	speed: 0.289768s/iter; left time: 24033.060329s
	iters: 1528, epoch: 7 | train_loss : 1.1140
	speed: 0.320776s/iter; left time: 26482.344429s
	iters: 1910, epoch: 7 | train_loss : 0.8352
	speed: 0.320550s/iter; left time: 26341.159208s
data: {'predict': array([0.26971349, 0.26888943, 0.26680744, ..., 0.04411732, 0.04211604,
       0.04703235]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 01:30:43] [32mIntermediate result: 0.9231677055358887  (Index 6)[0m
Epoch: 7 | cost time: 1192.7852823734283 | valid_loss: 0.9231677055358887 | valid_loss_true: 0.18177934927994868
Pretest loss in this epoch: 0.369134397160922
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 1.0296
	speed: 1.894750s/iter; left time: 154975.394985s
	iters: 764, epoch: 8 | train_loss : 1.0640
	speed: 0.294792s/iter; left time: 23998.977843s
	iters: 1146, epoch: 8 | train_loss : 1.0278
	speed: 0.347616s/iter; left time: 28166.616985s
	iters: 1528, epoch: 8 | train_loss : 1.2260
	speed: 0.362394s/iter; left time: 29225.629562s
	iters: 1910, epoch: 8 | train_loss : 1.2671
	speed: 0.306737s/iter; left time: 24619.948269s
data: {'predict': array([0.27247011, 0.2711905 , 0.26968929, ..., 0.04450331, 0.04401054,
       0.04859586]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 01:50:02] [32mIntermediate result: 0.9238758087158203  (Index 7)[0m
Epoch: 8 | cost time: 1158.5555255413055 | valid_loss: 0.9238758087158203 | valid_loss_true: 0.18183627686803996
Pretest loss in this epoch: 0.3692244684695307
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.9115
	speed: 1.672978s/iter; left time: 133639.145935s
	iters: 764, epoch: 9 | train_loss : 1.1493
	speed: 0.292603s/iter; left time: 23261.682241s
	iters: 1146, epoch: 9 | train_loss : 1.3133
	speed: 0.287812s/iter; left time: 22770.852090s
	iters: 1528, epoch: 9 | train_loss : 0.8318
	speed: 0.278919s/iter; left time: 21960.654955s
	iters: 1910, epoch: 9 | train_loss : 1.1893
	speed: 0.261267s/iter; left time: 20471.044974s
data: {'predict': array([0.27122163, 0.26990492, 0.26783428, ..., 0.04504012, 0.04429566,
       0.04923168]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 02:08:25] [32mIntermediate result: 0.9243329167366028  (Index 8)[0m
Epoch: 9 | cost time: 1103.1562850475311 | valid_loss: 0.9243329167366028 | valid_loss_true: 0.1820262378997498
Pretest loss in this epoch: 0.36942147150784255
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.9314
	speed: 1.834349s/iter; left time: 143024.153671s
	iters: 764, epoch: 10 | train_loss : 1.1749
	speed: 0.317275s/iter; left time: 24616.699470s
	iters: 1146, epoch: 10 | train_loss : 1.4466
	speed: 0.299005s/iter; left time: 23084.964929s
	iters: 1528, epoch: 10 | train_loss : 1.2091
	speed: 0.275257s/iter; left time: 21146.373314s
	iters: 1910, epoch: 10 | train_loss : 1.2814
	speed: 0.265867s/iter; left time: 20323.440269s
data: {'predict': array([0.27122088, 0.27002711, 0.26813123, ..., 0.04464016, 0.04382102,
       0.04809876]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-08 02:27:46] [32mIntermediate result: 0.923818051815033  (Index 9)[0m
Epoch: 10 | cost time: 1160.994295835495 | valid_loss: 0.923818051815033 | valid_loss_true: 0.18187607169411804
Pretest loss in this epoch: 0.36925190270187114
Early stop with best valid_loss: 0.923818051815033
[2024-03-08 02:27:46] [32mFinal result: 0.9192642569541931[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-08 02:27:54.819433: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-08 02:27:54.819807: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-08 02:27:54.821570: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-08 02:27:54.830909: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-08 02:27:57.200477: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.6810
	speed: 0.307668s/iter; left time: 29280.474602s
	iters: 764, epoch: 1 | train_loss : 0.9442
	speed: 0.298784s/iter; left time: 28320.801450s
	iters: 1146, epoch: 1 | train_loss : 0.9735
	speed: 0.330471s/iter; left time: 31198.097738s
	iters: 1528, epoch: 1 | train_loss : 1.1827
	speed: 0.306697s/iter; left time: 28836.540261s
	iters: 1910, epoch: 1 | train_loss : 1.1406
	speed: 0.305443s/iter; left time: 28601.962930s
data: {'predict': array([97.21772022, 97.50572543, 95.85142618, ..., 52.01577016,
       51.81851678, 52.96311518]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 02:48:35] [32mIntermediate result: 0.7399089336395264  (Index 0)[0m
Epoch: 1 | cost time: 1229.0313222408295 | valid_loss: 0.7399089336395264 | valid_loss_true: 29.092961991029885
Pretest loss in this epoch: 63.06080185122086
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.6473
	speed: 2.016732s/iter; left time: 188076.434525s
	iters: 764, epoch: 2 | train_loss : 2.6283
	speed: 0.327807s/iter; left time: 30445.360226s
	iters: 1146, epoch: 2 | train_loss : 1.1646
	speed: 0.270913s/iter; left time: 25057.867710s
	iters: 1528, epoch: 2 | train_loss : 0.6572
	speed: 0.272229s/iter; left time: 25075.581383s
	iters: 1910, epoch: 2 | train_loss : 0.9643
	speed: 0.290085s/iter; left time: 26609.458510s
data: {'predict': array([97.98654823, 98.04009945, 96.82185855, ..., 52.69876755,
       52.44138996, 53.29734223]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 03:07:56] [32mIntermediate result: 0.730900228023529  (Index 1)[0m
Epoch: 2 | cost time: 1160.740529537201 | valid_loss: 0.730900228023529 | valid_loss_true: 28.89169800070583
Pretest loss in this epoch: 62.84349611518911
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.7375
	speed: 1.864150s/iter; left time: 170284.473493s
	iters: 764, epoch: 3 | train_loss : 1.2957
	speed: 0.303010s/iter; left time: 27563.284153s
	iters: 1146, epoch: 3 | train_loss : 0.9313
	speed: 0.264442s/iter; left time: 23953.981693s
	iters: 1528, epoch: 3 | train_loss : 0.9855
	speed: 0.292570s/iter; left time: 26390.123058s
	iters: 1910, epoch: 3 | train_loss : 0.6658
	speed: 0.293811s/iter; left time: 26389.770056s
data: {'predict': array([96.80662957, 96.8645671 , 95.58727884, ..., 53.3669766 ,
       52.85603867, 53.58321261]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 03:26:56] [32mIntermediate result: 0.7343155741691589  (Index 2)[0m
Epoch: 3 | cost time: 1140.4904913902283 | valid_loss: 0.7343155741691589 | valid_loss_true: 28.964985095128693
Pretest loss in this epoch: 62.88042357781574
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.2203
	speed: 1.825885s/iter; left time: 163299.842545s
	iters: 764, epoch: 4 | train_loss : 0.8336
	speed: 0.293537s/iter; left time: 26140.605988s
	iters: 1146, epoch: 4 | train_loss : 1.1360
	speed: 0.279467s/iter; left time: 24780.888616s
	iters: 1528, epoch: 4 | train_loss : 1.0895
	speed: 0.290827s/iter; left time: 25677.097730s
	iters: 1910, epoch: 4 | train_loss : 0.9066
	speed: 0.298373s/iter; left time: 26229.411446s
data: {'predict': array([97.50255381, 97.31817071, 96.52949177, ..., 52.93891092,
       52.71533258, 53.43236485]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 03:46:20] [32mIntermediate result: 0.7317430377006531  (Index 3)[0m
Epoch: 4 | cost time: 1163.9758851528168 | valid_loss: 0.7317430377006531 | valid_loss_true: 28.9768294160237
Pretest loss in this epoch: 62.89609085556027
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.5512
	speed: 1.888042s/iter; left time: 165250.848131s
	iters: 764, epoch: 5 | train_loss : 1.2269
	speed: 0.324649s/iter; left time: 28290.844680s
	iters: 1146, epoch: 5 | train_loss : 0.7200
	speed: 0.300750s/iter; left time: 26093.395145s
	iters: 1528, epoch: 5 | train_loss : 1.2555
	speed: 0.291871s/iter; left time: 25211.539856s
	iters: 1910, epoch: 5 | train_loss : 0.4817
	speed: 0.285124s/iter; left time: 24519.770559s
data: {'predict': array([97.74601254, 97.57096052, 96.89009326, ..., 53.01979442,
       52.66145266, 53.55788202]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 04:05:40] [32mIntermediate result: 0.7321528792381287  (Index 4)[0m
Epoch: 5 | cost time: 1160.2053864002228 | valid_loss: 0.7321528792381287 | valid_loss_true: 28.90428447645063
Pretest loss in this epoch: 62.810490911082894
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.1655
	speed: 1.835233s/iter; left time: 157121.661407s
	iters: 764, epoch: 6 | train_loss : 0.5867
	speed: 0.334497s/iter; left time: 28509.848403s
	iters: 1146, epoch: 6 | train_loss : 0.8716
	speed: 0.296209s/iter; left time: 25133.306338s
	iters: 1528, epoch: 6 | train_loss : 0.9721
	speed: 0.262979s/iter; left time: 22213.311440s
	iters: 1910, epoch: 6 | train_loss : 1.5386
	speed: 0.259932s/iter; left time: 21856.651859s
data: {'predict': array([97.05484102, 96.82999497, 96.25730462, ..., 52.6618768 ,
       52.44975495, 53.11646065]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 04:24:21] [32mIntermediate result: 0.7345776557922363  (Index 5)[0m
Epoch: 6 | cost time: 1120.8539807796478 | valid_loss: 0.7345776557922363 | valid_loss_true: 29.064166900708248
Pretest loss in this epoch: 62.978585722329115
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.8225
	speed: 1.788611s/iter; left time: 149712.113805s
	iters: 764, epoch: 7 | train_loss : 1.0088
	speed: 0.330056s/iter; left time: 27500.564057s
	iters: 1146, epoch: 7 | train_loss : 1.2564
	speed: 0.296736s/iter; left time: 24610.998034s
	iters: 1528, epoch: 7 | train_loss : 1.0541
	speed: 0.263543s/iter; left time: 21757.348802s
	iters: 1910, epoch: 7 | train_loss : 0.7023
	speed: 0.265417s/iter; left time: 21810.656316s
data: {'predict': array([97.10125608, 96.90725443, 96.40552035, ..., 51.974228  ,
       51.61043368, 52.55609156]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 04:43:06] [32mIntermediate result: 0.7343372106552124  (Index 6)[0m
Epoch: 7 | cost time: 1124.9772806167603 | valid_loss: 0.7343372106552124 | valid_loss_true: 29.030926719299245
Pretest loss in this epoch: 62.94908057475519
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.7443
	speed: 1.751105s/iter; left time: 143226.345923s
	iters: 764, epoch: 8 | train_loss : 1.0013
	speed: 0.287429s/iter; left time: 23399.626398s
	iters: 1146, epoch: 8 | train_loss : 0.8672
	speed: 0.239943s/iter; left time: 19442.099637s
	iters: 1528, epoch: 8 | train_loss : 1.3375
	speed: 0.231061s/iter; left time: 18634.131049s
	iters: 1910, epoch: 8 | train_loss : 1.3053
	speed: 0.248024s/iter; left time: 19907.386257s
data: {'predict': array([97.64678027, 97.34963955, 96.95739957, ..., 52.09750666,
       52.04875412, 52.92867501]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 04:58:26] [32mIntermediate result: 0.7344854474067688  (Index 7)[0m
Epoch: 8 | cost time: 920.0733332633972 | valid_loss: 0.7344854474067688 | valid_loss_true: 29.011775091468763
Pretest loss in this epoch: 62.93278682206732
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.8868
	speed: 1.364298s/iter; left time: 108981.499836s
	iters: 764, epoch: 9 | train_loss : 0.8680
	speed: 0.290853s/iter; left time: 23122.509930s
	iters: 1146, epoch: 9 | train_loss : 1.0666
	speed: 0.243076s/iter; left time: 19231.410653s
	iters: 1528, epoch: 9 | train_loss : 0.6449
	speed: 0.228604s/iter; left time: 17999.154979s
	iters: 1910, epoch: 9 | train_loss : 0.9572
	speed: 0.226785s/iter; left time: 17769.298120s
data: {'predict': array([97.40768075, 97.10742261, 96.58807964, ..., 52.24378784,
       52.14734782, 53.08385842]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 05:13:44] [32mIntermediate result: 0.7347045540809631  (Index 8)[0m
Epoch: 9 | cost time: 917.950870513916 | valid_loss: 0.7347045540809631 | valid_loss_true: 29.040952481424174
Pretest loss in this epoch: 62.96243059503807
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.9501
	speed: 1.444860s/iter; left time: 112655.734756s
	iters: 764, epoch: 10 | train_loss : 1.0168
	speed: 0.285744s/iter; left time: 22170.278440s
	iters: 1146, epoch: 10 | train_loss : 1.0835
	speed: 0.225739s/iter; left time: 17428.376928s
	iters: 1528, epoch: 10 | train_loss : 1.2881
	speed: 0.219337s/iter; left time: 16850.347052s
	iters: 1910, epoch: 10 | train_loss : 0.9627
	speed: 0.260852s/iter; left time: 19940.075529s
data: {'predict': array([97.39152809, 97.12040129, 96.64047979, ..., 52.16600998,
       52.06398075, 52.85540718]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-08 05:29:33] [32mIntermediate result: 0.733903706073761  (Index 9)[0m
Epoch: 10 | cost time: 949.1106548309326 | valid_loss: 0.733903706073761 | valid_loss_true: 29.00183739813146
Pretest loss in this epoch: 62.91700985624154
Early stop with best valid_loss: 0.733903706073761
[2024-03-08 05:29:33] [32mFinal result: 0.730900228023529[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/allfeature/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/allfeature/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度', target_cols='1效出料温度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-08 05:29:40.035417: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-08 05:29:40.035479: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-08 05:29:40.037365: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-08 05:29:40.046921: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-08 05:29:41.482529: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0687
	speed: 0.265008s/iter; left time: 25220.569534s
	iters: 764, epoch: 1 | train_loss : 0.0778
	speed: 0.270599s/iter; left time: 25649.273103s
	iters: 1146, epoch: 1 | train_loss : 0.0549
	speed: 0.256125s/iter; left time: 24179.493070s
	iters: 1528, epoch: 1 | train_loss : 0.0858
	speed: 0.244022s/iter; left time: 22943.635369s
	iters: 1910, epoch: 1 | train_loss : 0.0765
	speed: 0.265480s/iter; left time: 24859.807391s
data: {'predict': array([148.23075936, 148.23948649, 148.19387034, ..., 147.09580062,
       147.08941696, 147.11719117]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 05:45:59] [32mIntermediate result: 0.6010920405387878  (Index 0)[0m
Epoch: 1 | cost time: 970.4434978961945 | valid_loss: 0.6010920405387878 | valid_loss_true: 0.5994594887753882
Pretest loss in this epoch: 13.534148038792743
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0874
	speed: 1.491053s/iter; left time: 139052.592402s
	iters: 764, epoch: 2 | train_loss : 1.0508
	speed: 0.260036s/iter; left time: 24151.097835s
	iters: 1146, epoch: 2 | train_loss : 0.2902
	speed: 0.276303s/iter; left time: 25556.412445s
	iters: 1528, epoch: 2 | train_loss : 0.0690
	speed: 0.272207s/iter; left time: 25073.521169s
	iters: 1910, epoch: 2 | train_loss : 0.0610
	speed: 0.227773s/iter; left time: 20893.624601s
data: {'predict': array([148.24659322, 148.24918733, 148.21578083, ..., 147.11188028,
       147.10304163, 147.12513039]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 06:02:07] [32mIntermediate result: 0.5976385474205017  (Index 1)[0m
Epoch: 2 | cost time: 968.3994224071503 | valid_loss: 0.5976385474205017 | valid_loss_true: 0.5976557186566857
Pretest loss in this epoch: 13.549680731133959
Chepoint Saved at:  ./checkpoints/allfeature/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0596
	speed: 1.506252s/iter; left time: 137591.561635s
	iters: 764, epoch: 3 | train_loss : 0.1621
	speed: 0.248908s/iter; left time: 22641.877088s
	iters: 1146, epoch: 3 | train_loss : 0.0912
	speed: 0.222138s/iter; left time: 20121.893361s
	iters: 1528, epoch: 3 | train_loss : 0.0668
	speed: 0.232702s/iter; left time: 20989.952931s
	iters: 1910, epoch: 3 | train_loss : 0.0675
	speed: 0.279724s/iter; left time: 25124.564882s
data: {'predict': array([148.21965543, 148.22156648, 148.18654279, ..., 147.1282023 ,
       147.11320601, 147.13212106]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 06:18:20] [32mIntermediate result: 0.5987638831138611  (Index 2)[0m
Epoch: 3 | cost time: 972.7852005958557 | valid_loss: 0.5987638831138611 | valid_loss_true: 0.5979811283163303
Pretest loss in this epoch: 13.544955987188954
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0826
	speed: 1.558590s/iter; left time: 139394.081215s
	iters: 764, epoch: 4 | train_loss : 0.0788
	speed: 0.235868s/iter; left time: 21004.951209s
	iters: 1146, epoch: 4 | train_loss : 0.0809
	speed: 0.244403s/iter; left time: 21671.717617s
	iters: 1528, epoch: 4 | train_loss : 0.0684
	speed: 0.229744s/iter; left time: 20284.110596s
	iters: 1910, epoch: 4 | train_loss : 0.0753
	speed: 0.229218s/iter; left time: 20150.056431s
data: {'predict': array([148.23424301, 148.22995655, 148.20843152, ..., 147.11731921,
       147.10969017, 147.12795172]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 06:33:43] [32mIntermediate result: 0.5977864265441895  (Index 3)[0m
Epoch: 4 | cost time: 922.5365927219391 | valid_loss: 0.5977864265441895 | valid_loss_true: 0.5981968142558356
Pretest loss in this epoch: 13.544003949160022
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0659
	speed: 1.503676s/iter; left time: 131609.263484s
	iters: 764, epoch: 5 | train_loss : 0.0544
	speed: 0.279148s/iter; left time: 24325.759198s
	iters: 1146, epoch: 5 | train_loss : 0.0679
	speed: 0.258907s/iter; left time: 22463.062646s
	iters: 1528, epoch: 5 | train_loss : 0.0720
	speed: 0.238672s/iter; left time: 20616.237416s
	iters: 1910, epoch: 5 | train_loss : 0.0644
	speed: 0.253391s/iter; left time: 21790.860888s
data: {'predict': array([148.24437539, 148.23958752, 148.2197846 , ..., 147.12282155,
       147.11189626, 147.13451515]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 06:49:41] [32mIntermediate result: 0.5977591872215271  (Index 4)[0m
Epoch: 5 | cost time: 958.1345326900482 | valid_loss: 0.5977591872215271 | valid_loss_true: 0.5973852088732439
Pretest loss in this epoch: 13.54767749708419
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0640
	speed: 1.483897s/iter; left time: 127042.337620s
	iters: 764, epoch: 6 | train_loss : 0.0947
	speed: 0.290674s/iter; left time: 24774.727050s
	iters: 1146, epoch: 6 | train_loss : 0.0644
	speed: 0.261407s/iter; left time: 22180.352195s
	iters: 1528, epoch: 6 | train_loss : 0.1737
	speed: 0.225797s/iter; left time: 19072.650654s
	iters: 1910, epoch: 6 | train_loss : 0.1006
	speed: 0.239453s/iter; left time: 20134.677280s
data: {'predict': array([148.2225406 , 148.21674196, 148.19954208, ..., 147.11181364,
       147.10496877, 147.12244771]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 07:05:20] [32mIntermediate result: 0.5986171364784241  (Index 5)[0m
Epoch: 6 | cost time: 939.4492783546448 | valid_loss: 0.5986171364784241 | valid_loss_true: 0.5988146153717104
Pretest loss in this epoch: 13.539066037116779
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0705
	speed: 1.438648s/iter; left time: 120419.127512s
	iters: 764, epoch: 7 | train_loss : 0.0720
	speed: 0.224602s/iter; left time: 18714.033881s
	iters: 1146, epoch: 7 | train_loss : 0.0703
	speed: 0.209398s/iter; left time: 17367.281482s
	iters: 1528, epoch: 7 | train_loss : 0.0553
	speed: 0.279381s/iter; left time: 23064.887612s
	iters: 1910, epoch: 7 | train_loss : 0.0497
	speed: 0.247372s/iter; left time: 20327.801024s
data: {'predict': array([148.2262663 , 148.22109971, 148.20569704, ..., 147.09493027,
       147.08515046, 147.10940717]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 07:20:29] [32mIntermediate result: 0.5983740091323853  (Index 6)[0m
Epoch: 7 | cost time: 908.1991586685181 | valid_loss: 0.5983740091323853 | valid_loss_true: 0.5984198123853476
Pretest loss in this epoch: 13.543804546181631
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0578
	speed: 1.413686s/iter; left time: 115628.237135s
	iters: 764, epoch: 8 | train_loss : 0.1340
	speed: 0.259276s/iter; left time: 21107.652097s
	iters: 1146, epoch: 8 | train_loss : 0.0707
	speed: 0.273524s/iter; left time: 22163.062852s
	iters: 1528, epoch: 8 | train_loss : 0.1322
	speed: 0.281565s/iter; left time: 22707.077823s
	iters: 1910, epoch: 8 | train_loss : 0.0756
	speed: 0.249591s/iter; left time: 20033.143353s
data: {'predict': array([148.23989496, 148.23154799, 148.21812908, ..., 147.09799454,
       147.09640453, 147.11876593]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 07:36:28] [32mIntermediate result: 0.5985875725746155  (Index 7)[0m
Epoch: 8 | cost time: 959.1976125240326 | valid_loss: 0.5985875725746155 | valid_loss_true: 0.5983394079093085
Pretest loss in this epoch: 13.543071773503845
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0607
	speed: 1.452141s/iter; left time: 115998.456053s
	iters: 764, epoch: 9 | train_loss : 0.0971
	speed: 0.259161s/iter; left time: 20603.026980s
	iters: 1146, epoch: 9 | train_loss : 0.0718
	speed: 0.276092s/iter; left time: 21843.573137s
	iters: 1528, epoch: 9 | train_loss : 0.0730
	speed: 0.274506s/iter; left time: 21613.240255s
	iters: 1910, epoch: 9 | train_loss : 0.0878
	speed: 0.248841s/iter; left time: 19497.468105s
data: {'predict': array([148.2361987 , 148.22816507, 148.21117506, ..., 147.10423563,
       147.10110996, 147.12513802]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 07:51:49] [32mIntermediate result: 0.5983518362045288  (Index 8)[0m
Epoch: 9 | cost time: 921.401201248169 | valid_loss: 0.5983518362045288 | valid_loss_true: 0.5982593506959359
Pretest loss in this epoch: 13.542555154388287
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0874
	speed: 1.305904s/iter; left time: 101821.318497s
	iters: 764, epoch: 10 | train_loss : 0.0628
	speed: 0.234183s/iter; left time: 18169.787216s
	iters: 1146, epoch: 10 | train_loss : 0.0750
	speed: 0.225997s/iter; left time: 17448.332080s
	iters: 1528, epoch: 10 | train_loss : 0.0738
	speed: 0.217438s/iter; left time: 16704.447709s
	iters: 1910, epoch: 10 | train_loss : 0.0589
	speed: 0.245933s/iter; left time: 18799.574343s
data: {'predict': array([148.23504941, 148.22788886, 148.21182678, ..., 147.10181711,
       147.09859178, 147.11882816]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-08 08:05:41] [32mIntermediate result: 0.598060667514801  (Index 9)[0m
Epoch: 10 | cost time: 832.0758209228516 | valid_loss: 0.598060667514801 | valid_loss_true: 0.5979426036645161
Pretest loss in this epoch: 13.545148535246705
Early stop with best valid_loss: 0.598060667514801
[2024-03-08 08:05:41] [32mFinal result: 0.5976385474205017[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
