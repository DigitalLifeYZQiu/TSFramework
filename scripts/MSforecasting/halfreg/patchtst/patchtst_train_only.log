python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温 --target_cols 1效蒸发器汽温 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温', target_cols='1效蒸发器汽温', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 19:08:18.050626: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 19:08:18.050688: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 19:08:18.052313: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 19:08:18.060486: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 19:08:19.061609: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,1效蒸发器汽温
	iters: 382, epoch: 1 | train_loss : 0.1324
	speed: 0.041157s/iter; left time: 3916.917135s
	iters: 764, epoch: 1 | train_loss : 0.1936
	speed: 0.031706s/iter; left time: 3005.307322s
	iters: 1146, epoch: 1 | train_loss : 0.1101
	speed: 0.031199s/iter; left time: 2945.381746s
	iters: 1528, epoch: 1 | train_loss : 0.1136
	speed: 0.031907s/iter; left time: 2999.980931s
	iters: 1910, epoch: 1 | train_loss : 0.1411
	speed: 0.031706s/iter; left time: 2969.006899s
data: {'predict': array([172.39984888, 177.20560504, 177.92639823, ..., 126.92311284,
       127.13081058, 127.50965038]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:12:09] [32mIntermediate result: 0.2158542424440384  (Index 0)[0m
Epoch: 1 | cost time: 222.27940273284912 | valid_loss: 0.2158542424440384 | valid_loss_true: 10.368354695657446
Pretest loss in this epoch: 21.45938528157437
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.1761
	speed: 0.461570s/iter; left time: 43045.118647s
	iters: 764, epoch: 2 | train_loss : 0.1540
	speed: 0.038403s/iter; left time: 3566.725017s
	iters: 1146, epoch: 2 | train_loss : 0.1473
	speed: 0.038292s/iter; left time: 3541.802802s
	iters: 1528, epoch: 2 | train_loss : 0.1711
	speed: 0.038867s/iter; left time: 3580.161763s
	iters: 1910, epoch: 2 | train_loss : 0.1102
	speed: 0.039274s/iter; left time: 3602.581497s
data: {'predict': array([174.36679468, 179.71371691, 177.15028742, ..., 127.02003009,
       127.19332426, 127.677364  ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:16:15] [32mIntermediate result: 0.21604134142398834  (Index 1)[0m
Epoch: 2 | cost time: 245.62132096290588 | valid_loss: 0.21604134142398834 | valid_loss_true: 10.388801401013126
Pretest loss in this epoch: 21.26942083100268
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.1348
	speed: 0.487050s/iter; left time: 44490.518178s
	iters: 764, epoch: 3 | train_loss : 0.1826
	speed: 0.039790s/iter; left time: 3619.463055s
	iters: 1146, epoch: 3 | train_loss : 0.1132
	speed: 0.038383s/iter; left time: 3476.840013s
	iters: 1528, epoch: 3 | train_loss : 0.0993
	speed: 0.037506s/iter; left time: 3383.052576s
	iters: 1910, epoch: 3 | train_loss : 0.1150
	speed: 0.036882s/iter; left time: 3312.711069s
data: {'predict': array([174.47473625, 178.98935284, 176.18790979, ..., 126.69607988,
       126.72748938, 127.14740065]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:20:22] [32mIntermediate result: 0.21495240926742554  (Index 2)[0m
Epoch: 3 | cost time: 247.19198417663574 | valid_loss: 0.21495240926742554 | valid_loss_true: 10.297889411255232
Pretest loss in this epoch: 21.57948638124851
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.1402
	speed: 0.498244s/iter; left time: 44560.913351s
	iters: 764, epoch: 4 | train_loss : 0.1649
	speed: 0.041624s/iter; left time: 3706.770629s
	iters: 1146, epoch: 4 | train_loss : 0.1168
	speed: 0.040868s/iter; left time: 3623.859933s
	iters: 1528, epoch: 4 | train_loss : 0.1247
	speed: 0.040642s/iter; left time: 3588.299262s
	iters: 1910, epoch: 4 | train_loss : 0.1330
	speed: 0.040091s/iter; left time: 3524.353178s
data: {'predict': array([175.88995283, 179.48804066, 177.10782892, ..., 126.97752152,
       126.88420407, 127.19285251]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:24:37] [32mIntermediate result: 0.21570327877998352  (Index 3)[0m
Epoch: 4 | cost time: 254.66362929344177 | valid_loss: 0.21570327877998352 | valid_loss_true: 10.35069455400269
Pretest loss in this epoch: 21.31409165232043
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.1502
	speed: 0.498852s/iter; left time: 43661.982203s
	iters: 764, epoch: 5 | train_loss : 0.1826
	speed: 0.039860s/iter; left time: 3473.539683s
	iters: 1146, epoch: 5 | train_loss : 0.1555
	speed: 0.038017s/iter; left time: 3298.391222s
	iters: 1528, epoch: 5 | train_loss : 0.1303
	speed: 0.038148s/iter; left time: 3295.225877s
	iters: 1910, epoch: 5 | train_loss : 0.1162
	speed: 0.033663s/iter; left time: 2894.939778s
data: {'predict': array([171.64930118, 177.19501933, 175.27688684, ..., 126.6919477 ,
       126.53269095, 126.78647872]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:28:38] [32mIntermediate result: 0.21258138120174408  (Index 4)[0m
Epoch: 5 | cost time: 240.89018058776855 | valid_loss: 0.21258138120174408 | valid_loss_true: 10.208289152778946
Pretest loss in this epoch: 21.064253090895647
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.1234
	speed: 0.480168s/iter; left time: 41109.099727s
	iters: 764, epoch: 6 | train_loss : 0.1111
	speed: 0.036250s/iter; left time: 3089.670712s
	iters: 1146, epoch: 6 | train_loss : 0.1442
	speed: 0.036469s/iter; left time: 3094.424162s
	iters: 1528, epoch: 6 | train_loss : 0.1210
	speed: 0.036069s/iter; left time: 3046.716355s
	iters: 1910, epoch: 6 | train_loss : 0.1735
	speed: 0.036433s/iter; left time: 3063.521053s
data: {'predict': array([174.0429164 , 180.15427215, 176.99910041, ..., 127.14462588,
       127.01513916, 127.35084422]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:32:39] [32mIntermediate result: 0.21606837213039398  (Index 5)[0m
Epoch: 6 | cost time: 241.51790142059326 | valid_loss: 0.21606837213039398 | valid_loss_true: 10.364819580485811
Pretest loss in this epoch: 21.435724586549807
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.1259
	speed: 0.488894s/iter; left time: 40921.887804s
	iters: 764, epoch: 7 | train_loss : 0.1503
	speed: 0.037624s/iter; left time: 3134.836459s
	iters: 1146, epoch: 7 | train_loss : 0.1170
	speed: 0.038769s/iter; left time: 3215.483976s
	iters: 1528, epoch: 7 | train_loss : 0.1376
	speed: 0.035539s/iter; left time: 2933.960747s
	iters: 1910, epoch: 7 | train_loss : 0.1467
	speed: 0.037068s/iter; left time: 3046.035308s
data: {'predict': array([173.74546151, 177.62304828, 175.62054881, ..., 126.31587068,
       126.16981787, 126.52915462]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:36:43] [32mIntermediate result: 0.21210207045078278  (Index 6)[0m
Epoch: 7 | cost time: 244.00442814826965 | valid_loss: 0.21210207045078278 | valid_loss_true: 10.190847159273764
Pretest loss in this epoch: 20.798349189843215
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.1501
	speed: 0.493694s/iter; left time: 40380.252337s
	iters: 764, epoch: 8 | train_loss : 0.1772
	speed: 0.041105s/iter; left time: 3346.323357s
	iters: 1146, epoch: 8 | train_loss : 0.1375
	speed: 0.040566s/iter; left time: 3286.948724s
	iters: 1528, epoch: 8 | train_loss : 0.2190
	speed: 0.041054s/iter; left time: 3310.829642s
	iters: 1910, epoch: 8 | train_loss : 0.1608
	speed: 0.040760s/iter; left time: 3271.550498s
data: {'predict': array([178.22338773, 179.90028553, 176.99613596, ..., 126.6063594 ,
       126.31329477, 126.66165868]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:41:01] [32mIntermediate result: 0.21356019377708435  (Index 7)[0m
Epoch: 8 | cost time: 257.2526168823242 | valid_loss: 0.21356019377708435 | valid_loss_true: 10.251056684633713
Pretest loss in this epoch: 21.1809623054389
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.1177
	speed: 0.504535s/iter; left time: 40302.767144s
	iters: 764, epoch: 9 | train_loss : 0.1182
	speed: 0.038221s/iter; left time: 3038.541629s
	iters: 1146, epoch: 9 | train_loss : 0.1608
	speed: 0.035182s/iter; left time: 2783.483466s
	iters: 1528, epoch: 9 | train_loss : 0.1276
	speed: 0.039364s/iter; left time: 3099.357879s
	iters: 1910, epoch: 9 | train_loss : 0.1316
	speed: 0.040927s/iter; left time: 3206.714750s
data: {'predict': array([176.13977907, 178.3664232 , 176.06495982, ..., 126.37053604,
       126.07029016, 126.35820578]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:45:10] [32mIntermediate result: 0.21243691444396973  (Index 8)[0m
Epoch: 9 | cost time: 249.8001742362976 | valid_loss: 0.21243691444396973 | valid_loss_true: 10.19559710535682
Pretest loss in this epoch: 21.11209082914513
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.1576
	speed: 0.504223s/iter; left time: 39314.261203s
	iters: 764, epoch: 10 | train_loss : 0.1273
	speed: 0.041287s/iter; left time: 3203.352000s
	iters: 1146, epoch: 10 | train_loss : 0.1680
	speed: 0.040424s/iter; left time: 3120.943485s
	iters: 1528, epoch: 10 | train_loss : 0.1703
	speed: 0.040454s/iter; left time: 3107.873440s
	iters: 1910, epoch: 10 | train_loss : 0.1423
	speed: 0.039897s/iter; left time: 3049.807236s
data: {'predict': array([177.75381979, 179.48528211, 176.85824526, ..., 126.51052808,
       126.25133816, 126.56440296]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:49:22] [32mIntermediate result: 0.21276409924030304  (Index 9)[0m
Epoch: 10 | cost time: 251.10245609283447 | valid_loss: 0.21276409924030304 | valid_loss_true: 10.216212258103813
Pretest loss in this epoch: 21.087598434398178
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.1634
	speed: 0.494094s/iter; left time: 37580.268948s
	iters: 764, epoch: 11 | train_loss : 0.1031
	speed: 0.038205s/iter; left time: 2891.211313s
	iters: 1146, epoch: 11 | train_loss : 0.1693
	speed: 0.037783s/iter; left time: 2844.900956s
	iters: 1528, epoch: 11 | train_loss : 0.1368
	speed: 0.038703s/iter; left time: 2899.376101s
	iters: 1910, epoch: 11 | train_loss : 0.1169
	speed: 0.038736s/iter; left time: 2887.037336s
data: {'predict': array([178.51952822, 179.5151297 , 176.96308698, ..., 126.51994184,
       126.18852409, 126.43524978]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:53:27] [32mIntermediate result: 0.21264050900936127  (Index 10)[0m
Epoch: 11 | cost time: 245.9341220855713 | valid_loss: 0.21264050900936127 | valid_loss_true: 10.205365853948749
Pretest loss in this epoch: 21.125309682806492
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.1449
	speed: 0.491027s/iter; left time: 36408.682172s
	iters: 764, epoch: 12 | train_loss : 0.1431
	speed: 0.041697s/iter; left time: 3075.817428s
	iters: 1146, epoch: 12 | train_loss : 0.1629
	speed: 0.041984s/iter; left time: 3080.968430s
	iters: 1528, epoch: 12 | train_loss : 0.1018
	speed: 0.042370s/iter; left time: 3093.077686s
	iters: 1910, epoch: 12 | train_loss : 0.1215
	speed: 0.040234s/iter; left time: 2921.789610s
data: {'predict': array([178.20788853, 179.58088072, 176.92982646, ..., 126.62492248,
       126.34369661, 126.63370089]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:57:43] [32mIntermediate result: 0.21320122480392456  (Index 11)[0m
Epoch: 12 | cost time: 255.06676983833313 | valid_loss: 0.21320122480392456 | valid_loss_true: 10.236209360515613
Pretest loss in this epoch: 21.093691799726443
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0852
	speed: 0.497431s/iter; left time: 35932.916825s
	iters: 764, epoch: 13 | train_loss : 0.0819
	speed: 0.035428s/iter; left time: 2545.648650s
	iters: 1146, epoch: 13 | train_loss : 0.1060
	speed: 0.038187s/iter; left time: 2729.350033s
	iters: 1528, epoch: 13 | train_loss : 0.1527
	speed: 0.039687s/iter; left time: 2821.363050s
	iters: 1910, epoch: 13 | train_loss : 0.1859
	speed: 0.039701s/iter; left time: 2807.225065s
data: {'predict': array([178.8386002 , 179.88940365, 177.12159063, ..., 126.65203902,
       126.31581356, 126.58543477]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:01:47] [32mIntermediate result: 0.21286645531654358  (Index 12)[0m
Epoch: 13 | cost time: 244.2569100856781 | valid_loss: 0.21286645531654358 | valid_loss_true: 10.220102652071883
Pretest loss in this epoch: 20.999129413438748
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.1072
	speed: 0.489511s/iter; left time: 34425.320075s
	iters: 764, epoch: 14 | train_loss : 0.1293
	speed: 0.039186s/iter; left time: 2740.795040s
	iters: 1146, epoch: 14 | train_loss : 0.1774
	speed: 0.039297s/iter; left time: 2733.605546s
	iters: 1528, epoch: 14 | train_loss : 0.0727
	speed: 0.040527s/iter; left time: 2803.664672s
	iters: 1910, epoch: 14 | train_loss : 0.2010
	speed: 0.039465s/iter; left time: 2715.095842s
data: {'predict': array([177.84464877, 179.78807922, 177.06863386, ..., 126.63865668,
       126.28969621, 126.57903483]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:05:55] [32mIntermediate result: 0.21339327096939087  (Index 13)[0m
Epoch: 14 | cost time: 247.72354817390442 | valid_loss: 0.21339327096939087 | valid_loss_true: 10.24490838725981
Pretest loss in this epoch: 21.088846881804255
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.1867
	speed: 0.487947s/iter; left time: 33382.913409s
	iters: 764, epoch: 15 | train_loss : 0.1066
	speed: 0.039362s/iter; left time: 2677.886194s
	iters: 1146, epoch: 15 | train_loss : 0.1219
	speed: 0.037824s/iter; left time: 2558.852476s
	iters: 1528, epoch: 15 | train_loss : 0.1130
	speed: 0.039585s/iter; left time: 2662.822284s
	iters: 1910, epoch: 15 | train_loss : 0.1354
	speed: 0.038703s/iter; left time: 2588.759312s
data: {'predict': array([178.91800574, 180.27049499, 177.37169046, ..., 126.50228206,
       126.2595031 , 126.57723106]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:10:00] [32mIntermediate result: 0.21341420710086823  (Index 14)[0m
Epoch: 15 | cost time: 245.63234448432922 | valid_loss: 0.21341420710086823 | valid_loss_true: 10.241223051614616
Pretest loss in this epoch: 21.025101641292473
Early stop with best valid_loss: 0.21341420710086823
[2024-03-11 20:10:00] [32mFinal result: 0.21210207045078278[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力 --target_cols 1效蒸发器汽室压力 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力', target_cols='1效蒸发器汽室压力', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 20:10:06.114012: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 20:10:06.114071: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 20:10:06.115824: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 20:10:06.126610: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 20:10:07.431661: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1效原液换热前温度,1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力
	iters: 382, epoch: 1 | train_loss : 0.2384
	speed: 0.047758s/iter; left time: 4545.048558s
	iters: 764, epoch: 1 | train_loss : 0.3049
	speed: 0.037728s/iter; left time: 3576.085961s
	iters: 1146, epoch: 1 | train_loss : 0.1639
	speed: 0.039575s/iter; left time: 3736.106990s
	iters: 1528, epoch: 1 | train_loss : 0.2206
	speed: 0.038858s/iter; left time: 3653.555642s
	iters: 1910, epoch: 1 | train_loss : 0.2331
	speed: 0.039345s/iter; left time: 3684.275086s
data: {'predict': array([0.46514019, 0.46653592, 0.46736075, ..., 0.44058232, 0.44050202,
       0.4405343 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:14:25] [32mIntermediate result: 0.2731418311595917  (Index 0)[0m
Epoch: 1 | cost time: 250.51962542533875 | valid_loss: 0.2731418311595917 | valid_loss_true: 0.054375134181188015
Pretest loss in this epoch: 0.11606625989929482
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.2351
	speed: 0.498548s/iter; left time: 46493.590806s
	iters: 764, epoch: 2 | train_loss : 0.3107
	speed: 0.038749s/iter; left time: 3598.872602s
	iters: 1146, epoch: 2 | train_loss : 0.2423
	speed: 0.038393s/iter; left time: 3551.131324s
	iters: 1528, epoch: 2 | train_loss : 0.3015
	speed: 0.039775s/iter; left time: 3663.736938s
	iters: 1910, epoch: 2 | train_loss : 0.1900
	speed: 0.038340s/iter; left time: 3516.932318s
data: {'predict': array([0.46409533, 0.46519217, 0.46647661, ..., 0.4414731 , 0.44137327,
       0.44175944]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:18:39] [32mIntermediate result: 0.27048325538635254  (Index 1)[0m
Epoch: 2 | cost time: 253.49909138679504 | valid_loss: 0.27048325538635254 | valid_loss_true: 0.053935005827283757
Pretest loss in this epoch: 0.11530613112740806
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.3012
	speed: 0.508347s/iter; left time: 46435.974903s
	iters: 764, epoch: 3 | train_loss : 0.3373
	speed: 0.038490s/iter; left time: 3501.219761s
	iters: 1146, epoch: 3 | train_loss : 0.1979
	speed: 0.039397s/iter; left time: 3568.665775s
	iters: 1528, epoch: 3 | train_loss : 0.2070
	speed: 0.041485s/iter; left time: 3742.031949s
	iters: 1910, epoch: 3 | train_loss : 0.1936
	speed: 0.042531s/iter; left time: 3820.071630s
data: {'predict': array([0.46301075, 0.4636828 , 0.46518758, ..., 0.44124148, 0.44108141,
       0.4413396 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:22:52] [32mIntermediate result: 0.27123692631721497  (Index 2)[0m
Epoch: 3 | cost time: 253.54027891159058 | valid_loss: 0.27123692631721497 | valid_loss_true: 0.05417410145440565
Pretest loss in this epoch: 0.11569928079027121
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.2192
	speed: 0.500379s/iter; left time: 44751.874142s
	iters: 764, epoch: 4 | train_loss : 0.2995
	speed: 0.035514s/iter; left time: 3162.631036s
	iters: 1146, epoch: 4 | train_loss : 0.1755
	speed: 0.037048s/iter; left time: 3285.108496s
	iters: 1528, epoch: 4 | train_loss : 0.2076
	speed: 0.037981s/iter; left time: 3353.362735s
	iters: 1910, epoch: 4 | train_loss : 0.2037
	speed: 0.039360s/iter; left time: 3460.016651s
data: {'predict': array([0.46591964, 0.46593836, 0.46622606, ..., 0.44162575, 0.44153203,
       0.44176359]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:26:59] [32mIntermediate result: 0.26959747076034546  (Index 3)[0m
Epoch: 4 | cost time: 246.71050930023193 | valid_loss: 0.26959747076034546 | valid_loss_true: 0.05399043787055387
Pretest loss in this epoch: 0.11479800697698578
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.2172
	speed: 0.499203s/iter; left time: 43692.753753s
	iters: 764, epoch: 5 | train_loss : 0.2363
	speed: 0.042562s/iter; left time: 3708.938468s
	iters: 1146, epoch: 5 | train_loss : 0.1892
	speed: 0.041450s/iter; left time: 3596.282378s
	iters: 1528, epoch: 5 | train_loss : 0.1899
	speed: 0.038699s/iter; left time: 3342.810760s
	iters: 1910, epoch: 5 | train_loss : 0.2173
	speed: 0.039286s/iter; left time: 3378.504652s
data: {'predict': array([0.46659418, 0.46663248, 0.46602346, ..., 0.44133285, 0.4411988 ,
       0.44145618]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:31:13] [32mIntermediate result: 0.2699716091156006  (Index 4)[0m
Epoch: 5 | cost time: 254.37773609161377 | valid_loss: 0.2699716091156006 | valid_loss_true: 0.05401097701746663
Pretest loss in this epoch: 0.11511295457916844
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.2526
	speed: 0.501099s/iter; left time: 42901.049159s
	iters: 764, epoch: 6 | train_loss : 0.1774
	speed: 0.037831s/iter; left time: 3224.439667s
	iters: 1146, epoch: 6 | train_loss : 0.2201
	speed: 0.036874s/iter; left time: 3128.747223s
	iters: 1528, epoch: 6 | train_loss : 0.2426
	speed: 0.035624s/iter; left time: 3009.087645s
	iters: 1910, epoch: 6 | train_loss : 0.2760
	speed: 0.034626s/iter; left time: 2911.528844s
data: {'predict': array([0.4670273 , 0.46684223, 0.46651928, ..., 0.44131401, 0.44120891,
       0.44145256]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:35:20] [32mIntermediate result: 0.2704889476299286  (Index 5)[0m
Epoch: 6 | cost time: 246.4873378276825 | valid_loss: 0.2704889476299286 | valid_loss_true: 0.05409290996732597
Pretest loss in this epoch: 0.11524059142090673
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.1983
	speed: 0.500027s/iter; left time: 41853.762434s
	iters: 764, epoch: 7 | train_loss : 0.2511
	speed: 0.038230s/iter; left time: 3185.322702s
	iters: 1146, epoch: 7 | train_loss : 0.2031
	speed: 0.038919s/iter; left time: 3227.876653s
	iters: 1528, epoch: 7 | train_loss : 0.2436
	speed: 0.038363s/iter; left time: 3167.172824s
	iters: 1910, epoch: 7 | train_loss : 0.1953
	speed: 0.039456s/iter; left time: 3242.309458s
data: {'predict': array([0.4670295 , 0.46711741, 0.46692382, ..., 0.44164171, 0.44150929,
       0.44174691]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:39:30] [32mIntermediate result: 0.270175039768219  (Index 6)[0m
Epoch: 7 | cost time: 250.53121781349182 | valid_loss: 0.270175039768219 | valid_loss_true: 0.05407558622916052
Pretest loss in this epoch: 0.1150804679384197
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.1938
	speed: 0.497885s/iter; left time: 40723.010432s
	iters: 764, epoch: 8 | train_loss : 0.2343
	speed: 0.037625s/iter; left time: 3063.048820s
	iters: 1146, epoch: 8 | train_loss : 0.2177
	speed: 0.037272s/iter; left time: 3020.042152s
	iters: 1528, epoch: 8 | train_loss : 0.3113
	speed: 0.036203s/iter; left time: 2919.609013s
	iters: 1910, epoch: 8 | train_loss : 0.2539
	speed: 0.033751s/iter; left time: 2708.976561s
data: {'predict': array([0.4672861 , 0.46713986, 0.46685805, ..., 0.44149749, 0.44135297,
       0.44164581]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:43:30] [32mIntermediate result: 0.2693417966365814  (Index 7)[0m
Epoch: 8 | cost time: 239.68601536750793 | valid_loss: 0.2693417966365814 | valid_loss_true: 0.05398067847702031
Pretest loss in this epoch: 0.11486383641677564
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.2007
	speed: 0.487185s/iter; left time: 38916.785060s
	iters: 764, epoch: 9 | train_loss : 0.2399
	speed: 0.038897s/iter; left time: 3092.273005s
	iters: 1146, epoch: 9 | train_loss : 0.2490
	speed: 0.039793s/iter; left time: 3148.327978s
	iters: 1528, epoch: 9 | train_loss : 0.2254
	speed: 0.038705s/iter; left time: 3047.469189s
	iters: 1910, epoch: 9 | train_loss : 0.2017
	speed: 0.039401s/iter; left time: 3087.148611s
data: {'predict': array([0.46785417, 0.46771942, 0.46752212, ..., 0.44183513, 0.44173588,
       0.44192684]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:47:37] [32mIntermediate result: 0.2685948312282562  (Index 8)[0m
Epoch: 9 | cost time: 247.2059543132782 | valid_loss: 0.2685948312282562 | valid_loss_true: 0.05375698139195957
Pretest loss in this epoch: 0.1145789492606915
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.2029
	speed: 0.489435s/iter; left time: 38161.223441s
	iters: 764, epoch: 10 | train_loss : 0.2128
	speed: 0.039186s/iter; left time: 3040.401978s
	iters: 1146, epoch: 10 | train_loss : 0.2914
	speed: 0.038139s/iter; left time: 2944.540985s
	iters: 1528, epoch: 10 | train_loss : 0.2967
	speed: 0.037876s/iter; left time: 2909.757483s
	iters: 1910, epoch: 10 | train_loss : 0.2039
	speed: 0.037379s/iter; left time: 2857.301201s
data: {'predict': array([0.46742101, 0.46730013, 0.46708649, ..., 0.44160573, 0.44145483,
       0.44160754]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:51:43] [32mIntermediate result: 0.27022820711135864  (Index 9)[0m
Epoch: 10 | cost time: 246.08456206321716 | valid_loss: 0.27022820711135864 | valid_loss_true: 0.0541095035581867
Pretest loss in this epoch: 0.11510877056714734
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.2375
	speed: 0.495013s/iter; left time: 37650.174243s
	iters: 764, epoch: 11 | train_loss : 0.2179
	speed: 0.042214s/iter; left time: 3194.635427s
	iters: 1146, epoch: 11 | train_loss : 0.2510
	speed: 0.041889s/iter; left time: 3154.032890s
	iters: 1528, epoch: 11 | train_loss : 0.2119
	speed: 0.041718s/iter; left time: 3125.202619s
	iters: 1910, epoch: 11 | train_loss : 0.1795
	speed: 0.038471s/iter; left time: 2867.288128s
data: {'predict': array([0.4673592 , 0.46727409, 0.46713617, ..., 0.44218758, 0.44209757,
       0.44217768]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:55:56] [32mIntermediate result: 0.2696346342563629  (Index 10)[0m
Epoch: 11 | cost time: 252.79505896568298 | valid_loss: 0.2696346342563629 | valid_loss_true: 0.05401582937530755
Pretest loss in this epoch: 0.11491170081811435
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.2355
	speed: 0.493225s/iter; left time: 36571.652505s
	iters: 764, epoch: 12 | train_loss : 0.2278
	speed: 0.030787s/iter; left time: 2271.022506s
	iters: 1146, epoch: 12 | train_loss : 0.3058
	speed: 0.038145s/iter; left time: 2799.229228s
	iters: 1528, epoch: 12 | train_loss : 0.1762
	speed: 0.035022s/iter; left time: 2556.683498s
	iters: 1910, epoch: 12 | train_loss : 0.2209
	speed: 0.039408s/iter; left time: 2861.813926s
data: {'predict': array([0.46796094, 0.46764653, 0.4676039 , ..., 0.44193651, 0.44176817,
       0.44200953]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:00:01] [32mIntermediate result: 0.2689969539642334  (Index 11)[0m
Epoch: 12 | cost time: 244.75376796722412 | valid_loss: 0.2689969539642334 | valid_loss_true: 0.053867952746642196
Pretest loss in this epoch: 0.11473092691318922
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.1831
	speed: 0.496734s/iter; left time: 35882.568367s
	iters: 764, epoch: 13 | train_loss : 0.1415
	speed: 0.037605s/iter; left time: 2702.122643s
	iters: 1146, epoch: 13 | train_loss : 0.1895
	speed: 0.038023s/iter; left time: 2717.624614s
	iters: 1528, epoch: 13 | train_loss : 0.2859
	speed: 0.039051s/iter; left time: 2776.167745s
	iters: 1910, epoch: 13 | train_loss : 0.2132
	speed: 0.038814s/iter; left time: 2744.510057s
data: {'predict': array([0.46725171, 0.46699118, 0.46684823, ..., 0.44199186, 0.4418238 ,
       0.44200874]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:04:06] [32mIntermediate result: 0.2700877785682678  (Index 12)[0m
Epoch: 13 | cost time: 245.36824250221252 | valid_loss: 0.2700877785682678 | valid_loss_true: 0.054121086478978585
Pretest loss in this epoch: 0.11502718799765851
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.1835
	speed: 0.490008s/iter; left time: 34460.304868s
	iters: 764, epoch: 14 | train_loss : 0.2755
	speed: 0.038539s/iter; left time: 2695.577462s
	iters: 1146, epoch: 14 | train_loss : 0.1845
	speed: 0.035439s/iter; left time: 2465.225611s
	iters: 1528, epoch: 14 | train_loss : 0.1212
	speed: 0.037010s/iter; left time: 2560.358666s
	iters: 1910, epoch: 14 | train_loss : 0.3623
	speed: 0.038495s/iter; left time: 2648.401733s
data: {'predict': array([0.46786573, 0.46744107, 0.46736228, ..., 0.44201488, 0.44183814,
       0.44208573]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:08:12] [32mIntermediate result: 0.2691101133823395  (Index 13)[0m
Epoch: 14 | cost time: 245.71669149398804 | valid_loss: 0.2691101133823395 | valid_loss_true: 0.053879714532362497
Pretest loss in this epoch: 0.11476425572146924
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.2866
	speed: 0.494167s/iter; left time: 33808.463758s
	iters: 764, epoch: 15 | train_loss : 0.1774
	speed: 0.041267s/iter; left time: 2807.491693s
	iters: 1146, epoch: 15 | train_loss : 0.1632
	speed: 0.042651s/iter; left time: 2885.399087s
	iters: 1528, epoch: 15 | train_loss : 0.1680
	speed: 0.037579s/iter; left time: 2527.907440s
	iters: 1910, epoch: 15 | train_loss : 0.2396
	speed: 0.038802s/iter; left time: 2595.351644s
data: {'predict': array([0.46734854, 0.4669701 , 0.46682401, ..., 0.44232656, 0.44216973,
       0.44236483]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:12:15] [32mIntermediate result: 0.26943403482437134  (Index 14)[0m
Epoch: 15 | cost time: 243.12426137924194 | valid_loss: 0.26943403482437134 | valid_loss_true: 0.05397410505714941
Pretest loss in this epoch: 0.11483025743944672
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.2697
	speed: 0.477547s/iter; left time: 31758.797822s
	iters: 764, epoch: 16 | train_loss : 0.2491
	speed: 0.040204s/iter; left time: 2658.398237s
	iters: 1146, epoch: 16 | train_loss : 0.2365
	speed: 0.039077s/iter; left time: 2568.895751s
	iters: 1528, epoch: 16 | train_loss : 0.2312
	speed: 0.037038s/iter; left time: 2420.735957s
	iters: 1910, epoch: 16 | train_loss : 0.2655
	speed: 0.036429s/iter; left time: 2367.000170s
data: {'predict': array([0.46742997, 0.46695798, 0.4667837 , ..., 0.44233312, 0.44218296,
       0.44236668]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:16:16] [32mIntermediate result: 0.26918187737464905  (Index 15)[0m
Epoch: 16 | cost time: 241.1604290008545 | valid_loss: 0.26918187737464905 | valid_loss_true: 0.05392907899489333
Pretest loss in this epoch: 0.11470114830936452
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.1842
	speed: 0.473279s/iter; left time: 30570.504477s
	iters: 764, epoch: 17 | train_loss : 0.2940
	speed: 0.035940s/iter; left time: 2307.724538s
	iters: 1146, epoch: 17 | train_loss : 0.1619
	speed: 0.038039s/iter; left time: 2427.983658s
	iters: 1528, epoch: 17 | train_loss : 0.2049
	speed: 0.036369s/iter; left time: 2307.488329s
	iters: 1910, epoch: 17 | train_loss : 0.1924
	speed: 0.038175s/iter; left time: 2407.495193s
data: {'predict': array([0.46724949, 0.46675521, 0.46642851, ..., 0.44213382, 0.44195815,
       0.44220049]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:20:15] [32mIntermediate result: 0.2698573172092438  (Index 16)[0m
Epoch: 17 | cost time: 239.12537097930908 | valid_loss: 0.2698573172092438 | valid_loss_true: 0.05405300476360108
Pretest loss in this epoch: 0.11503315706836305
Early stop with best valid_loss: 0.2698573172092438
[2024-03-11 21:20:15] [32mFinal result: 0.2685948312282562[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度 --target_cols 1效原液换热前温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度', target_cols='1效原液换热前温度', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 21:20:21.471607: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 21:20:21.471659: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 21:20:21.473533: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 21:20:21.481885: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 21:20:22.853715: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1效出料温度,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度
	iters: 382, epoch: 1 | train_loss : 0.9229
	speed: 0.046602s/iter; left time: 4435.101447s
	iters: 764, epoch: 1 | train_loss : 0.9613
	speed: 0.037820s/iter; left time: 3584.845670s
	iters: 1146, epoch: 1 | train_loss : 0.7354
	speed: 0.038458s/iter; left time: 3630.601416s
	iters: 1528, epoch: 1 | train_loss : 0.8579
	speed: 0.037795s/iter; left time: 3553.588668s
	iters: 1910, epoch: 1 | train_loss : 0.8456
	speed: 0.035554s/iter; left time: 3329.321310s
data: {'predict': array([ 117.57151523,  117.57151523,  117.57151523, ..., -282.39249197,
       -275.13276053, -278.45982798]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:24:33] [32mIntermediate result: 0.48356640338897705  (Index 0)[0m
Epoch: 1 | cost time: 243.3365433216095 | valid_loss: 0.48356640338897705 | valid_loss_true: 19.11166174523831
Pretest loss in this epoch: 522.9704131507494
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.8305
	speed: 0.485024s/iter; left time: 45232.394358s
	iters: 764, epoch: 2 | train_loss : 1.2588
	speed: 0.038422s/iter; left time: 3568.483965s
	iters: 1146, epoch: 2 | train_loss : 0.9806
	speed: 0.038554s/iter; left time: 3566.048946s
	iters: 1528, epoch: 2 | train_loss : 0.8442
	speed: 0.038772s/iter; left time: 3571.324503s
	iters: 1910, epoch: 2 | train_loss : 0.7460
	speed: 0.036568s/iter; left time: 3354.361748s
data: {'predict': array([ 117.50433965,  117.50433965,  117.50433965, ..., -287.42482851,
       -281.458743  , -283.23047955]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:28:41] [32mIntermediate result: 0.48475775122642517  (Index 1)[0m
Epoch: 2 | cost time: 248.1545648574829 | valid_loss: 0.48475775122642517 | valid_loss_true: 19.178527821013656
Pretest loss in this epoch: 537.9013407557374
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0635
	speed: 0.500477s/iter; left time: 45717.076572s
	iters: 764, epoch: 3 | train_loss : 0.6349
	speed: 0.042442s/iter; left time: 3860.727535s
	iters: 1146, epoch: 3 | train_loss : 0.7418
	speed: 0.041520s/iter; left time: 3760.995712s
	iters: 1528, epoch: 3 | train_loss : 1.1288
	speed: 0.040302s/iter; left time: 3635.242881s
	iters: 1910, epoch: 3 | train_loss : 0.8452
	speed: 0.038661s/iter; left time: 3472.500599s
data: {'predict': array([ 117.52989268,  117.52989268,  117.52989268, ..., -284.39876853,
       -279.48432406, -280.35013523]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:32:54] [32mIntermediate result: 0.4847232401371002  (Index 2)[0m
Epoch: 3 | cost time: 252.2473659515381 | valid_loss: 0.4847232401371002 | valid_loss_true: 19.153092267049274
Pretest loss in this epoch: 531.5637399697914
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.1964
	speed: 0.495375s/iter; left time: 44304.399282s
	iters: 764, epoch: 4 | train_loss : 1.2026
	speed: 0.038741s/iter; left time: 3450.071643s
	iters: 1146, epoch: 4 | train_loss : 1.0979
	speed: 0.033277s/iter; left time: 2950.754951s
	iters: 1528, epoch: 4 | train_loss : 0.7271
	speed: 0.038163s/iter; left time: 3369.382649s
	iters: 1910, epoch: 4 | train_loss : 1.1660
	speed: 0.040601s/iter; left time: 3569.140318s
data: {'predict': array([ 117.53748864,  117.53748864,  117.53748864, ..., -283.66231065,
       -278.52893452, -279.27281957]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:36:58] [32mIntermediate result: 0.4843806326389313  (Index 3)[0m
Epoch: 4 | cost time: 244.55776476860046 | valid_loss: 0.4843806326389313 | valid_loss_true: 19.145531293227045
Pretest loss in this epoch: 529.8718942244808
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.8151
	speed: 0.488068s/iter; left time: 42718.179139s
	iters: 764, epoch: 5 | train_loss : 1.3037
	speed: 0.038380s/iter; left time: 3344.564655s
	iters: 1146, epoch: 5 | train_loss : 0.9123
	speed: 0.038850s/iter; left time: 3370.680642s
	iters: 1528, epoch: 5 | train_loss : 0.8844
	speed: 0.038092s/iter; left time: 3290.390085s
	iters: 1910, epoch: 5 | train_loss : 1.0537
	speed: 0.039804s/iter; left time: 3423.018566s
data: {'predict': array([ 117.50411232,  117.50411232,  117.50411232, ..., -286.90526641,
       -281.75726217, -282.47486939]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:41:05] [32mIntermediate result: 0.4848218858242035  (Index 4)[0m
Epoch: 5 | cost time: 247.25605082511902 | valid_loss: 0.4848218858242035 | valid_loss_true: 19.17875411280654
Pretest loss in this epoch: 538.112811884243
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.1026
	speed: 0.490871s/iter; left time: 42025.460095s
	iters: 764, epoch: 6 | train_loss : 0.8662
	speed: 0.036237s/iter; left time: 3088.518645s
	iters: 1146, epoch: 6 | train_loss : 0.6523
	speed: 0.036220s/iter; left time: 3073.272777s
	iters: 1528, epoch: 6 | train_loss : 1.5683
	speed: 0.036991s/iter; left time: 3124.564185s
	iters: 1910, epoch: 6 | train_loss : 1.3488
	speed: 0.038743s/iter; left time: 3257.730600s
data: {'predict': array([ 117.5188332 ,  117.5188332 ,  117.5188332 , ..., -284.985062  ,
       -279.80953578, -280.85695428]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:45:05] [32mIntermediate result: 0.4850415885448456  (Index 5)[0m
Epoch: 6 | cost time: 239.15468955039978 | valid_loss: 0.4850415885448456 | valid_loss_true: 19.16410087117776
Pretest loss in this epoch: 534.5648838378223
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.8810
	speed: 0.478516s/iter; left time: 40053.219950s
	iters: 764, epoch: 7 | train_loss : 0.6837
	speed: 0.038682s/iter; left time: 3223.046910s
	iters: 1146, epoch: 7 | train_loss : 0.9971
	speed: 0.035405s/iter; left time: 2936.461753s
	iters: 1528, epoch: 7 | train_loss : 0.9015
	speed: 0.035810s/iter; left time: 2956.383945s
	iters: 1910, epoch: 7 | train_loss : 0.9868
	speed: 0.036618s/iter; left time: 3009.091991s
data: {'predict': array([ 117.50169918,  117.50169918,  117.50169918, ..., -286.3431772 ,
       -281.63454432, -282.4017665 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:49:12] [32mIntermediate result: 0.48472660779953003  (Index 6)[0m
Epoch: 7 | cost time: 247.8123426437378 | valid_loss: 0.48472660779953003 | valid_loss_true: 19.181156172367874
Pretest loss in this epoch: 538.5607576616122
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.9174
	speed: 0.501546s/iter; left time: 41022.480985s
	iters: 764, epoch: 8 | train_loss : 0.5282
	speed: 0.035431s/iter; left time: 2884.441872s
	iters: 1146, epoch: 8 | train_loss : 1.0168
	speed: 0.037712s/iter; left time: 3055.688727s
	iters: 1528, epoch: 8 | train_loss : 1.1533
	speed: 0.038519s/iter; left time: 3106.410060s
	iters: 1910, epoch: 8 | train_loss : 0.9877
	speed: 0.041500s/iter; left time: 3330.926679s
data: {'predict': array([ 117.51501616,  117.51501616,  117.51501616, ..., -285.22721767,
       -280.55794499, -281.32799476]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:53:27] [32mIntermediate result: 0.48471707105636597  (Index 7)[0m
Epoch: 8 | cost time: 254.3723201751709 | valid_loss: 0.48471707105636597 | valid_loss_true: 19.16790036305412
Pretest loss in this epoch: 535.5135641715558
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.8555
	speed: 0.515130s/iter; left time: 41149.091101s
	iters: 764, epoch: 9 | train_loss : 1.3825
	speed: 0.041690s/iter; left time: 3314.349586s
	iters: 1146, epoch: 9 | train_loss : 0.8476
	speed: 0.041068s/iter; left time: 3249.185771s
	iters: 1528, epoch: 9 | train_loss : 0.9727
	speed: 0.037666s/iter; left time: 2965.619537s
	iters: 1910, epoch: 9 | train_loss : 1.4440
	speed: 0.042861s/iter; left time: 3358.318187s
data: {'predict': array([ 117.50684179,  117.50684179,  117.50684179, ..., -285.77079553,
       -281.4306932 , -281.89392951]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:57:43] [32mIntermediate result: 0.48452457785606384  (Index 8)[0m
Epoch: 9 | cost time: 256.19665336608887 | valid_loss: 0.48452457785606384 | valid_loss_true: 19.176037172172496
Pretest loss in this epoch: 537.5244962796197
Early stop with best valid_loss: 0.48452457785606384
[2024-03-11 21:57:43] [32mFinal result: 0.48356640338897705[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度 --target_cols 1效出料温度 --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度', target_cols='1效出料温度', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 21:57:49.908166: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 21:57:49.908251: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 21:57:49.910510: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 21:57:49.923249: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 21:57:51.321650: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度
	iters: 382, epoch: 1 | train_loss : 0.9333
	speed: 0.045040s/iter; left time: 4286.378335s
	iters: 764, epoch: 1 | train_loss : 1.0316
	speed: 0.036169s/iter; left time: 3428.381856s
	iters: 1146, epoch: 1 | train_loss : 0.7287
	speed: 0.033334s/iter; left time: 3146.922721s
	iters: 1528, epoch: 1 | train_loss : 0.8600
	speed: 0.035689s/iter; left time: 3355.604340s
	iters: 1910, epoch: 1 | train_loss : 0.8502
	speed: 0.036437s/iter; left time: 3411.962603s
data: {'predict': array([149.28652678, 149.29316584, 149.30079357, ..., 149.01889581,
       149.02160666, 149.02576328]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:01:54] [32mIntermediate result: 0.49218738079071045  (Index 0)[0m
Epoch: 1 | cost time: 235.43906044960022 | valid_loss: 0.49218738079071045 | valid_loss_true: 0.49434275790045684
Pretest loss in this epoch: 13.55345745818846
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.9238
	speed: 0.473108s/iter; left time: 44121.120663s
	iters: 764, epoch: 2 | train_loss : 1.2192
	speed: 0.034298s/iter; left time: 3185.471880s
	iters: 1146, epoch: 2 | train_loss : 0.9658
	speed: 0.035838s/iter; left time: 3314.822931s
	iters: 1528, epoch: 2 | train_loss : 0.8852
	speed: 0.034527s/iter; left time: 3180.353584s
	iters: 1910, epoch: 2 | train_loss : 0.7424
	speed: 0.033550s/iter; left time: 3077.574849s
data: {'predict': array([149.28668133, 149.29599724, 149.30368159, ..., 149.02097566,
       149.02398316, 149.02650283]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:05:51] [32mIntermediate result: 0.49449095129966736  (Index 1)[0m
Epoch: 2 | cost time: 237.5153727531433 | valid_loss: 0.49449095129966736 | valid_loss_true: 0.4938399547065782
Pretest loss in this epoch: 13.562309051461053
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0070
	speed: 0.485104s/iter; left time: 44312.805955s
	iters: 764, epoch: 3 | train_loss : 0.5854
	speed: 0.038453s/iter; left time: 3497.889954s
	iters: 1146, epoch: 3 | train_loss : 0.7618
	speed: 0.035684s/iter; left time: 3232.352194s
	iters: 1528, epoch: 3 | train_loss : 1.0109
	speed: 0.034973s/iter; left time: 3154.585925s
	iters: 1910, epoch: 3 | train_loss : 0.8765
	speed: 0.031791s/iter; left time: 2855.439795s
data: {'predict': array([149.28934393, 149.29484687, 149.30670313, ..., 149.02419982,
       149.03299762, 149.02698765]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:09:45] [32mIntermediate result: 0.48617878556251526  (Index 2)[0m
Epoch: 3 | cost time: 234.11414766311646 | valid_loss: 0.48617878556251526 | valid_loss_true: 0.48567585611341785
Pretest loss in this epoch: 13.564089434555715
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 1.1146
	speed: 0.468824s/iter; left time: 41929.701757s
	iters: 764, epoch: 4 | train_loss : 1.1990
	speed: 0.033792s/iter; left time: 3009.281379s
	iters: 1146, epoch: 4 | train_loss : 1.0945
	speed: 0.037225s/iter; left time: 3300.773684s
	iters: 1528, epoch: 4 | train_loss : 0.6553
	speed: 0.037843s/iter; left time: 3341.162400s
	iters: 1910, epoch: 4 | train_loss : 0.9982
	speed: 0.038658s/iter; left time: 3398.321603s
data: {'predict': array([149.23801632, 149.24320022, 149.25896189, ..., 149.00642327,
       149.01388479, 149.0008779 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:13:37] [32mIntermediate result: 0.4539729952812195  (Index 3)[0m
Epoch: 4 | cost time: 231.50372886657715 | valid_loss: 0.4539729952812195 | valid_loss_true: 0.4521793371070383
Pretest loss in this epoch: 13.568456142670586
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.7510
	speed: 0.459418s/iter; left time: 40210.575886s
	iters: 764, epoch: 5 | train_loss : 1.1964
	speed: 0.033460s/iter; left time: 2915.767289s
	iters: 1146, epoch: 5 | train_loss : 0.8864
	speed: 0.037336s/iter; left time: 3239.336202s
	iters: 1528, epoch: 5 | train_loss : 0.7358
	speed: 0.033913s/iter; left time: 2929.391521s
	iters: 1910, epoch: 5 | train_loss : 1.0571
	speed: 0.036671s/iter; left time: 3153.580368s
data: {'predict': array([149.23598734, 149.24907527, 149.264783  , ..., 149.00987191,
       149.02446795, 149.00241394]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:17:31] [32mIntermediate result: 0.4484993815422058  (Index 4)[0m
Epoch: 5 | cost time: 234.49615788459778 | valid_loss: 0.4484993815422058 | valid_loss_true: 0.44829980711359324
Pretest loss in this epoch: 13.569978657452838
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.0879
	speed: 0.475324s/iter; left time: 40694.382502s
	iters: 764, epoch: 6 | train_loss : 0.7788
	speed: 0.036065s/iter; left time: 3073.915796s
	iters: 1146, epoch: 6 | train_loss : 0.6018
	speed: 0.036494s/iter; left time: 3096.546333s
	iters: 1528, epoch: 6 | train_loss : 1.4698
	speed: 0.035898s/iter; left time: 3032.222999s
	iters: 1910, epoch: 6 | train_loss : 1.2243
	speed: 0.037079s/iter; left time: 3117.823144s
data: {'predict': array([149.20137505, 149.20982791, 149.23421861, ..., 149.00497101,
       149.01525039, 148.98780998]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:21:24] [32mIntermediate result: 0.43501484394073486  (Index 5)[0m
Epoch: 6 | cost time: 232.76405334472656 | valid_loss: 0.43501484394073486 | valid_loss_true: 0.43463660136114635
Pretest loss in this epoch: 13.568673685748315
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.7503
	speed: 0.463662s/iter; left time: 38809.869896s
	iters: 764, epoch: 7 | train_loss : 0.6474
	speed: 0.034784s/iter; left time: 2898.267562s
	iters: 1146, epoch: 7 | train_loss : 0.8462
	speed: 0.035615s/iter; left time: 2953.847259s
	iters: 1528, epoch: 7 | train_loss : 0.7556
	speed: 0.034973s/iter; left time: 2887.263156s
	iters: 1910, epoch: 7 | train_loss : 0.8385
	speed: 0.033884s/iter; left time: 2784.397577s
data: {'predict': array([149.18750242, 149.19282637, 149.2186648 , ..., 148.99769934,
       149.01130001, 148.98262525]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:25:12] [32mIntermediate result: 0.42883315682411194  (Index 6)[0m
Epoch: 7 | cost time: 227.94965982437134 | valid_loss: 0.42883315682411194 | valid_loss_true: 0.42872472687644714
Pretest loss in this epoch: 13.578168033569204
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.8655
	speed: 0.461261s/iter; left time: 37727.452590s
	iters: 764, epoch: 8 | train_loss : 0.4636
	speed: 0.041130s/iter; left time: 3348.385811s
	iters: 1146, epoch: 8 | train_loss : 0.9471
	speed: 0.041492s/iter; left time: 3362.049504s
	iters: 1528, epoch: 8 | train_loss : 1.0168
	speed: 0.040818s/iter; left time: 3291.825468s
	iters: 1910, epoch: 8 | train_loss : 0.8474
	speed: 0.039273s/iter; left time: 3152.240976s
data: {'predict': array([149.17509291, 149.18174902, 149.20891098, ..., 148.99718943,
       149.01051099, 148.97779954]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:29:16] [32mIntermediate result: 0.4425983726978302  (Index 7)[0m
Epoch: 8 | cost time: 243.78292965888977 | valid_loss: 0.4425983726978302 | valid_loss_true: 0.442633387146048
Pretest loss in this epoch: 13.599765597233185
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.7828
	speed: 0.469554s/iter; left time: 37508.465599s
	iters: 764, epoch: 9 | train_loss : 1.1633
	speed: 0.032826s/iter; left time: 2609.661502s
	iters: 1146, epoch: 9 | train_loss : 0.7626
	speed: 0.032272s/iter; left time: 2553.255476s
	iters: 1528, epoch: 9 | train_loss : 0.8314
	speed: 0.030316s/iter; left time: 2386.907229s
	iters: 1910, epoch: 9 | train_loss : 1.2644
	speed: 0.033384s/iter; left time: 2615.736049s
data: {'predict': array([149.15671621, 149.17272339, 149.20987014, ..., 148.99574404,
       149.01541299, 148.9782755 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:32:54] [32mIntermediate result: 0.4254435896873474  (Index 8)[0m
Epoch: 9 | cost time: 217.6491186618805 | valid_loss: 0.4254435896873474 | valid_loss_true: 0.42426961996364265
Pretest loss in this epoch: 13.582908661821236
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 1.0654
	speed: 0.446366s/iter; left time: 34803.132682s
	iters: 764, epoch: 10 | train_loss : 1.2240
	speed: 0.039610s/iter; left time: 3073.287183s
	iters: 1146, epoch: 10 | train_loss : 0.7108
	speed: 0.039456s/iter; left time: 3046.220315s
	iters: 1528, epoch: 10 | train_loss : 0.9746
	speed: 0.039498s/iter; left time: 3034.411105s
	iters: 1910, epoch: 10 | train_loss : 0.9611
	speed: 0.038327s/iter; left time: 2929.755027s
data: {'predict': array([149.13823591, 149.15373383, 149.18865541, ..., 148.98871588,
       149.00322837, 148.96649286]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:36:46] [32mIntermediate result: 0.4169268310070038  (Index 9)[0m
Epoch: 10 | cost time: 232.33426475524902 | valid_loss: 0.4169268310070038 | valid_loss_true: 0.41544792432193267
Pretest loss in this epoch: 13.587955884992574
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.5866
	speed: 0.444552s/iter; left time: 33812.209024s
	iters: 764, epoch: 11 | train_loss : 1.1819
	speed: 0.030223s/iter; left time: 2287.209974s
	iters: 1146, epoch: 11 | train_loss : 0.8787
	speed: 0.031639s/iter; left time: 2382.225600s
	iters: 1528, epoch: 11 | train_loss : 0.9529
	speed: 0.029689s/iter; left time: 2224.079053s
	iters: 1910, epoch: 11 | train_loss : 0.4986
	speed: 0.032722s/iter; left time: 2438.828226s
data: {'predict': array([149.13244341, 149.13796375, 149.17717836, ..., 148.97749568,
       148.99993304, 148.95966003]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:40:22] [32mIntermediate result: 0.40290939807891846  (Index 10)[0m
Epoch: 11 | cost time: 215.77956175804138 | valid_loss: 0.40290939807891846 | valid_loss_true: 0.4009867542986519
Pretest loss in this epoch: 13.58044695597391
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.9507
	speed: 0.446264s/iter; left time: 33089.598563s
	iters: 764, epoch: 12 | train_loss : 0.9477
	speed: 0.041420s/iter; left time: 3055.384986s
	iters: 1146, epoch: 12 | train_loss : 0.8481
	speed: 0.040723s/iter; left time: 2988.390289s
	iters: 1528, epoch: 12 | train_loss : 0.8108
	speed: 0.040269s/iter; left time: 2939.691047s
	iters: 1910, epoch: 12 | train_loss : 0.9259
	speed: 0.036998s/iter; left time: 2686.783189s
data: {'predict': array([149.09845949, 149.11673764, 149.15931974, ..., 148.97033722,
       148.98746844, 148.94887699]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:44:12] [32mIntermediate result: 0.4060618579387665  (Index 11)[0m
Epoch: 12 | cost time: 230.52186250686646 | valid_loss: 0.4060618579387665 | valid_loss_true: 0.40442465191806876
Pretest loss in this epoch: 13.583751321755456
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.4419
	speed: 0.438159s/iter; left time: 31651.257341s
	iters: 764, epoch: 13 | train_loss : 0.5991
	speed: 0.036064s/iter; left time: 2591.360380s
	iters: 1146, epoch: 13 | train_loss : 0.7396
	speed: 0.035331s/iter; left time: 2525.181441s
	iters: 1528, epoch: 13 | train_loss : 0.7564
	speed: 0.035074s/iter; left time: 2493.410723s
	iters: 1910, epoch: 13 | train_loss : 0.5844
	speed: 0.037936s/iter; left time: 2682.401111s
data: {'predict': array([149.08830006, 149.10370449, 149.14628057, ..., 148.96651294,
       148.98481486, 148.94377226]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:47:57] [32mIntermediate result: 0.39116328954696655  (Index 12)[0m
Epoch: 13 | cost time: 224.53657913208008 | valid_loss: 0.39116328954696655 | valid_loss_true: 0.38946709015343356
Pretest loss in this epoch: 13.574250909681355
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-12.pth
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.8172
	speed: 0.446812s/iter; left time: 31422.506546s
	iters: 764, epoch: 14 | train_loss : 1.0202
	speed: 0.038287s/iter; left time: 2677.979184s
	iters: 1146, epoch: 14 | train_loss : 0.8574
	speed: 0.037312s/iter; left time: 2595.474826s
	iters: 1528, epoch: 14 | train_loss : 0.6695
	speed: 0.039464s/iter; left time: 2730.102465s
	iters: 1910, epoch: 14 | train_loss : 1.1877
	speed: 0.039382s/iter; left time: 2709.434413s
data: {'predict': array([149.07083545, 149.0919473 , 149.13578145, ..., 148.96468926,
       148.98128677, 148.93885575]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:51:46] [32mIntermediate result: 0.3937976658344269  (Index 13)[0m
Epoch: 14 | cost time: 229.18044805526733 | valid_loss: 0.3937976658344269 | valid_loss_true: 0.39264826983753354
Pretest loss in this epoch: 13.581719979596512
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.8727
	speed: 0.442744s/iter; left time: 30290.349064s
	iters: 764, epoch: 15 | train_loss : 0.8749
	speed: 0.031262s/iter; left time: 2126.829953s
	iters: 1146, epoch: 15 | train_loss : 0.7069
	speed: 0.030156s/iter; left time: 2040.113712s
	iters: 1528, epoch: 15 | train_loss : 0.4778
	speed: 0.029825s/iter; left time: 2006.307891s
	iters: 1910, epoch: 15 | train_loss : 0.5649
	speed: 0.030511s/iter; left time: 2040.777260s
data: {'predict': array([149.04577682, 149.07217843, 149.11891816, ..., 148.9524842 ,
       148.96961635, 148.93159662]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:55:15] [32mIntermediate result: 0.38804274797439575  (Index 14)[0m
Epoch: 15 | cost time: 209.33158254623413 | valid_loss: 0.38804274797439575 | valid_loss_true: 0.38690565969566326
Pretest loss in this epoch: 13.586201473274658
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 1.3042
	speed: 0.432340s/iter; left time: 28752.322487s
	iters: 764, epoch: 16 | train_loss : 1.1544
	speed: 0.041737s/iter; left time: 2759.720525s
	iters: 1146, epoch: 16 | train_loss : 0.8279
	speed: 0.042823s/iter; left time: 2815.209794s
	iters: 1528, epoch: 16 | train_loss : 0.5543
	speed: 0.039786s/iter; left time: 2600.363037s
	iters: 1910, epoch: 16 | train_loss : 0.8401
	speed: 0.039389s/iter; left time: 2559.368369s
data: {'predict': array([149.04524342, 149.07394705, 149.12030504, ..., 148.95009404,
       148.97051246, 148.9304044 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 22:59:15] [32mIntermediate result: 0.39039644598960876  (Index 15)[0m
Epoch: 16 | cost time: 240.20560026168823 | valid_loss: 0.39039644598960876 | valid_loss_true: 0.38937599571045395
Pretest loss in this epoch: 13.589233582800304
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.5820
	speed: 0.460591s/iter; left time: 29750.980896s
	iters: 764, epoch: 17 | train_loss : 0.9139
	speed: 0.036214s/iter; left time: 2325.330759s
	iters: 1146, epoch: 17 | train_loss : 0.7930
	speed: 0.033885s/iter; left time: 2162.854486s
	iters: 1528, epoch: 17 | train_loss : 0.8026
	speed: 0.035701s/iter; left time: 2265.099544s
	iters: 1910, epoch: 17 | train_loss : 0.9396
	speed: 0.037730s/iter; left time: 2379.434170s
data: {'predict': array([149.03514797, 149.06517596, 149.11352608, ..., 148.94357716,
       148.96638618, 148.92700503]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:03:03] [32mIntermediate result: 0.3835425078868866  (Index 16)[0m
Epoch: 17 | cost time: 227.2046501636505 | valid_loss: 0.3835425078868866 | valid_loss_true: 0.3825517933893824
Pretest loss in this epoch: 13.585095304280134
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-16.pth
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.8524
	speed: 0.453149s/iter; left time: 28404.306651s
	iters: 764, epoch: 18 | train_loss : 0.5436
	speed: 0.039271s/iter; left time: 2446.569079s
	iters: 1146, epoch: 18 | train_loss : 0.6772
	speed: 0.039914s/iter; left time: 2471.406883s
	iters: 1528, epoch: 18 | train_loss : 1.1686
	speed: 0.038095s/iter; left time: 2344.183842s
	iters: 1910, epoch: 18 | train_loss : 0.9339
	speed: 0.042423s/iter; left time: 2594.322471s
data: {'predict': array([149.03617294, 149.06652496, 149.11718414, ..., 148.94703592,
       148.97135646, 148.9299619 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:06:56] [32mIntermediate result: 0.38615983724594116  (Index 17)[0m
Epoch: 18 | cost time: 233.66175484657288 | valid_loss: 0.38615983724594116 | valid_loss_true: 0.3852760555831001
Pretest loss in this epoch: 13.587034565895566
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.6206
	speed: 0.448652s/iter; left time: 27265.020926s
	iters: 764, epoch: 19 | train_loss : 0.6325
	speed: 0.035869s/iter; left time: 2166.095029s
	iters: 1146, epoch: 19 | train_loss : 0.5595
	speed: 0.030670s/iter; left time: 1840.434652s
	iters: 1528, epoch: 19 | train_loss : 0.8679
	speed: 0.031326s/iter; left time: 1867.797603s
	iters: 1910, epoch: 19 | train_loss : 0.6749
	speed: 0.032817s/iter; left time: 1944.178743s
data: {'predict': array([149.01884828, 149.05030213, 149.10171727, ..., 148.9366634 ,
       148.96100811, 148.92184091]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:11:01] [32mIntermediate result: 0.3777775466442108  (Index 18)[0m
Epoch: 19 | cost time: 245.0031132698059 | valid_loss: 0.3777775466442108 | valid_loss_true: 0.37701439803566295
Pretest loss in this epoch: 13.584953951652713
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-18.pth
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 1.1098
	speed: 0.514378s/iter; left time: 30276.292992s
	iters: 764, epoch: 20 | train_loss : 1.0256
	speed: 0.040540s/iter; left time: 2370.721656s
	iters: 1146, epoch: 20 | train_loss : 0.8391
	speed: 0.038944s/iter; left time: 2262.514467s
	iters: 1528, epoch: 20 | train_loss : 0.8601
	speed: 0.040520s/iter; left time: 2338.559189s
	iters: 1910, epoch: 20 | train_loss : 0.6897
	speed: 0.041346s/iter; left time: 2370.454354s
data: {'predict': array([149.0151021 , 149.05009271, 149.10194413, ..., 148.94042371,
       148.96344987, 148.92249144]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:15:57] [32mIntermediate result: 0.38639917969703674  (Index 19)[0m
Epoch: 20 | cost time: 295.59933066368103 | valid_loss: 0.38639917969703674 | valid_loss_true: 0.3856359395703737
Pretest loss in this epoch: 13.591850731966336
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 1.1185
	speed: 0.615788s/iter; left time: 35068.491287s
	iters: 764, epoch: 21 | train_loss : 0.7256
	speed: 0.040975s/iter; left time: 2317.807877s
	iters: 1146, epoch: 21 | train_loss : 0.3638
	speed: 0.041338s/iter; left time: 2322.578931s
	iters: 1528, epoch: 21 | train_loss : 0.5998
	speed: 0.040891s/iter; left time: 2281.839191s
	iters: 1910, epoch: 21 | train_loss : 1.0725
	speed: 0.040808s/iter; left time: 2261.605909s
data: {'predict': array([149.00846682, 149.04243107, 149.09361873, ..., 148.93758779,
       148.95917765, 148.91881441]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:21:11] [32mIntermediate result: 0.3813650906085968  (Index 20)[0m
Epoch: 21 | cost time: 314.09361934661865 | valid_loss: 0.3813650906085968 | valid_loss_true: 0.38056128751884216
Pretest loss in this epoch: 13.589672676344815
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.6161
	speed: 0.656467s/iter; left time: 36130.639621s
	iters: 764, epoch: 22 | train_loss : 1.0792
	speed: 0.041433s/iter; left time: 2264.549348s
	iters: 1146, epoch: 22 | train_loss : 0.7645
	speed: 0.039543s/iter; left time: 2146.183892s
	iters: 1528, epoch: 22 | train_loss : 1.1679
	speed: 0.039616s/iter; left time: 2134.997949s
	iters: 1910, epoch: 22 | train_loss : 1.0278
	speed: 0.043610s/iter; left time: 2333.565281s
data: {'predict': array([149.00845305, 149.04144193, 149.09340335, ..., 148.93782149,
       148.95936578, 148.91877953]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:26:45] [32mIntermediate result: 0.3806522488594055  (Index 21)[0m
Epoch: 22 | cost time: 333.7799334526062 | valid_loss: 0.3806522488594055 | valid_loss_true: 0.3798302769743167
Pretest loss in this epoch: 13.588661408246024
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.8169
	speed: 0.709410s/iter; left time: 37688.816427s
	iters: 764, epoch: 23 | train_loss : 1.0965
	speed: 0.038801s/iter; left time: 2046.560609s
	iters: 1146, epoch: 23 | train_loss : 0.7831
	speed: 0.038077s/iter; left time: 1993.809018s
	iters: 1528, epoch: 23 | train_loss : 0.6186
	speed: 0.038295s/iter; left time: 1990.628066s
	iters: 1910, epoch: 23 | train_loss : 1.0173
	speed: 0.038845s/iter; left time: 2004.369169s
data: {'predict': array([149.00699411, 149.04077999, 149.09107316, ..., 148.93611176,
       148.95788819, 148.91742083]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:31:30] [32mIntermediate result: 0.3824848532676697  (Index 22)[0m
Epoch: 23 | cost time: 285.5963933467865 | valid_loss: 0.3824848532676697 | valid_loss_true: 0.3817060165064663
Pretest loss in this epoch: 13.592455872511962
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 1.0422
	speed: 0.593566s/iter; left time: 30400.058267s
	iters: 764, epoch: 24 | train_loss : 0.8495
	speed: 0.040155s/iter; left time: 2041.227028s
	iters: 1146, epoch: 24 | train_loss : 0.8165
	speed: 0.039874s/iter; left time: 2011.720281s
	iters: 1528, epoch: 24 | train_loss : 0.5848
	speed: 0.039955s/iter; left time: 2000.521849s
	iters: 1910, epoch: 24 | train_loss : 0.5715
	speed: 0.040472s/iter; left time: 2010.965513s
data: {'predict': array([149.00433905, 149.03910459, 149.08975683, ..., 148.93598289,
       148.95734883, 148.91634507]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:37:13] [32mIntermediate result: 0.3830035328865051  (Index 23)[0m
Epoch: 24 | cost time: 342.5785183906555 | valid_loss: 0.3830035328865051 | valid_loss_true: 0.38229673692028254
Pretest loss in this epoch: 13.591623815365024
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 0.7629
	speed: 0.741588s/iter; left time: 36563.972595s
	iters: 764, epoch: 25 | train_loss : 0.8381
	speed: 0.044580s/iter; left time: 2180.963932s
	iters: 1146, epoch: 25 | train_loss : 1.2075
	speed: 0.044057s/iter; left time: 2138.568825s
	iters: 1528, epoch: 25 | train_loss : 0.9365
	speed: 0.041763s/iter; left time: 2011.287063s
	iters: 1910, epoch: 25 | train_loss : 0.6828
	speed: 0.043543s/iter; left time: 2080.372572s
data: {'predict': array([148.99961484, 149.03550104, 149.08706621, ..., 148.93337775,
       148.95621977, 148.91559053]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:42:19] [32mIntermediate result: 0.37815991044044495  (Index 24)[0m
Epoch: 25 | cost time: 306.2038974761963 | valid_loss: 0.37815991044044495 | valid_loss_true: 0.3774460068056911
Pretest loss in this epoch: 13.589039818939012
Adjusting learning rate of group 0 to 1.7198e-06.
	iters: 382, epoch: 26 | train_loss : 0.8502
	speed: 0.618015s/iter; left time: 29290.207540s
	iters: 764, epoch: 26 | train_loss : 0.8226
	speed: 0.039253s/iter; left time: 1845.383875s
	iters: 1146, epoch: 26 | train_loss : 0.7415
	speed: 0.040511s/iter; left time: 1889.012486s
	iters: 1528, epoch: 26 | train_loss : 0.8098
	speed: 0.041328s/iter; left time: 1911.319166s
	iters: 1910, epoch: 26 | train_loss : 0.9078
	speed: 0.040409s/iter; left time: 1853.397282s
data: {'predict': array([148.99635003, 149.03274936, 149.08423499, ..., 148.93160888,
       148.95469903, 148.91444185]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:47:30] [32mIntermediate result: 0.37544840574264526  (Index 25)[0m
Epoch: 26 | cost time: 310.72314715385437 | valid_loss: 0.37544840574264526 | valid_loss_true: 0.3746917097532726
Pretest loss in this epoch: 13.587557717904586
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-25.pth
Adjusting learning rate of group 0 to 1.4618e-06.
	iters: 382, epoch: 27 | train_loss : 1.0696
	speed: 0.656782s/iter; left time: 29872.420979s
	iters: 764, epoch: 27 | train_loss : 0.6541
	speed: 0.039813s/iter; left time: 1795.592399s
	iters: 1146, epoch: 27 | train_loss : 1.2851
	speed: 0.040516s/iter; left time: 1811.837048s
	iters: 1528, epoch: 27 | train_loss : 0.8197
	speed: 0.040953s/iter; left time: 1815.748306s
	iters: 1910, epoch: 27 | train_loss : 0.9014
	speed: 0.040945s/iter; left time: 1799.733033s
data: {'predict': array([148.99187271, 149.02916411, 149.08078335, ..., 148.92981637,
       148.9520099 , 148.91222917]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:52:30] [32mIntermediate result: 0.3741592764854431  (Index 26)[0m
Epoch: 27 | cost time: 299.6689250469208 | valid_loss: 0.3741592764854431 | valid_loss_true: 0.3734536975191083
Pretest loss in this epoch: 13.587701796286728
Chepoint Saved at:  ./checkpoints/halfreg/patchtst/alumina_patchtst/STANDALONE/checkpoint-26.pth
Adjusting learning rate of group 0 to 1.2425e-06.
	iters: 382, epoch: 28 | train_loss : 0.5529
	speed: 0.622628s/iter; left time: 27129.164502s
	iters: 764, epoch: 28 | train_loss : 0.7938
	speed: 0.038565s/iter; left time: 1665.601958s
	iters: 1146, epoch: 28 | train_loss : 1.0757
	speed: 0.038672s/iter; left time: 1655.453703s
	iters: 1528, epoch: 28 | train_loss : 0.9802
	speed: 0.037785s/iter; left time: 1603.074309s
	iters: 1910, epoch: 28 | train_loss : 0.7103
	speed: 0.039473s/iter; left time: 1659.586936s
data: {'predict': array([148.99549348, 149.03260193, 149.08414037, ..., 148.93152882,
       148.95474849, 148.91386744]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:57:38] [32mIntermediate result: 0.3799097537994385  (Index 27)[0m
Epoch: 28 | cost time: 308.37018942832947 | valid_loss: 0.3799097537994385 | valid_loss_true: 0.37927831005794316
Pretest loss in this epoch: 13.59243523831779
Adjusting learning rate of group 0 to 1.0562e-06.
	iters: 382, epoch: 29 | train_loss : 1.0826
	speed: 0.656284s/iter; left time: 27341.466169s
	iters: 764, epoch: 29 | train_loss : 0.7204
	speed: 0.043685s/iter; left time: 1803.290298s
	iters: 1146, epoch: 29 | train_loss : 0.8258
	speed: 0.043344s/iter; left time: 1772.636158s
	iters: 1528, epoch: 29 | train_loss : 0.8039
	speed: 0.040738s/iter; left time: 1650.512978s
	iters: 1910, epoch: 29 | train_loss : 0.8793
	speed: 0.041140s/iter; left time: 1651.063764s
data: {'predict': array([148.99561299, 149.03234575, 149.08455069, ..., 148.9318888 ,
       148.95543712, 148.914174  ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:02:45] [32mIntermediate result: 0.37775006890296936  (Index 28)[0m
Epoch: 29 | cost time: 306.8723747730255 | valid_loss: 0.37775006890296936 | valid_loss_true: 0.3771031006019183
Pretest loss in this epoch: 13.590217276575387
Adjusting learning rate of group 0 to 8.9774e-07.
	iters: 382, epoch: 30 | train_loss : 0.9451
	speed: 0.629227s/iter; left time: 25011.760017s
	iters: 764, epoch: 30 | train_loss : 0.7873
	speed: 0.040403s/iter; left time: 1590.592124s
	iters: 1146, epoch: 30 | train_loss : 0.6070
	speed: 0.039927s/iter; left time: 1556.577141s
	iters: 1528, epoch: 30 | train_loss : 1.0600
	speed: 0.040877s/iter; left time: 1577.999693s
	iters: 1910, epoch: 30 | train_loss : 0.8143
	speed: 0.040478s/iter; left time: 1547.160082s
data: {'predict': array([148.99386872, 149.0306458 , 149.08273266, ..., 148.93137825,
       148.95473746, 148.91348442]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:07:14] [32mIntermediate result: 0.3775462210178375  (Index 29)[0m
Epoch: 30 | cost time: 269.5780761241913 | valid_loss: 0.3775462210178375 | valid_loss_true: 0.3768925491920888
Pretest loss in this epoch: 13.590351677040928
Adjusting learning rate of group 0 to 7.6308e-07.
	iters: 382, epoch: 31 | train_loss : 0.8756
	speed: 0.543599s/iter; left time: 20569.234584s
	iters: 764, epoch: 31 | train_loss : 1.2017
	speed: 0.037597s/iter; left time: 1408.252488s
	iters: 1146, epoch: 31 | train_loss : 0.6266
	speed: 0.038475s/iter; left time: 1426.466703s
	iters: 1528, epoch: 31 | train_loss : 0.6369
	speed: 0.037704s/iter; left time: 1383.472631s
	iters: 1910, epoch: 31 | train_loss : 0.9038
	speed: 0.036371s/iter; left time: 1320.652429s
data: {'predict': array([148.9919541 , 149.02871925, 149.08142782, ..., 148.9308172 ,
       148.95425122, 148.91311238]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:11:30] [32mIntermediate result: 0.3752906024456024  (Index 30)[0m
Epoch: 31 | cost time: 255.5663104057312 | valid_loss: 0.3752906024456024 | valid_loss_true: 0.3746382369802288
Pretest loss in this epoch: 13.58874156123163
Adjusting learning rate of group 0 to 6.4861e-07.
	iters: 382, epoch: 32 | train_loss : 0.8627
	speed: 0.518977s/iter; left time: 18645.791142s
	iters: 764, epoch: 32 | train_loss : 0.7932
	speed: 0.038357s/iter; left time: 1363.434419s
	iters: 1146, epoch: 32 | train_loss : 1.1760
	speed: 0.037347s/iter; left time: 1313.254095s
	iters: 1528, epoch: 32 | train_loss : 0.9321
	speed: 0.037914s/iter; left time: 1318.716594s
	iters: 1910, epoch: 32 | train_loss : 0.7933
	speed: 0.037999s/iter; left time: 1307.149956s
data: {'predict': array([148.99138168, 149.02838872, 149.08112497, ..., 148.93096293,
       148.95427961, 148.91293026]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:15:56] [32mIntermediate result: 0.376220166683197  (Index 31)[0m
Epoch: 32 | cost time: 265.6354458332062 | valid_loss: 0.376220166683197 | valid_loss_true: 0.37556244326818133
Pretest loss in this epoch: 13.589734834239698
Adjusting learning rate of group 0 to 5.5132e-07.
	iters: 382, epoch: 33 | train_loss : 0.9119
	speed: 0.545435s/iter; left time: 18554.046148s
	iters: 764, epoch: 33 | train_loss : 0.7258
	speed: 0.038645s/iter; left time: 1299.832795s
	iters: 1146, epoch: 33 | train_loss : 0.8593
	speed: 0.038405s/iter; left time: 1277.087823s
	iters: 1528, epoch: 33 | train_loss : 0.7906
	speed: 0.038971s/iter; left time: 1281.015095s
	iters: 1910, epoch: 33 | train_loss : 0.5113
	speed: 0.039231s/iter; left time: 1274.584237s
data: {'predict': array([148.9904312 , 149.02772368, 149.08046685, ..., 148.92989526,
       148.95307853, 148.91211874]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:20:36] [32mIntermediate result: 0.37662917375564575  (Index 32)[0m
Epoch: 33 | cost time: 280.4473285675049 | valid_loss: 0.37662917375564575 | valid_loss_true: 0.3759855855110868
Pretest loss in this epoch: 13.590507561062617
Adjusting learning rate of group 0 to 4.6862e-07.
	iters: 382, epoch: 34 | train_loss : 0.6954
	speed: 0.579368s/iter; left time: 18601.204446s
	iters: 764, epoch: 34 | train_loss : 0.6713
	speed: 0.040251s/iter; left time: 1276.907728s
	iters: 1146, epoch: 34 | train_loss : 1.1105
	speed: 0.040050s/iter; left time: 1255.256698s
	iters: 1528, epoch: 34 | train_loss : 0.7002
	speed: 0.040310s/iter; left time: 1247.996777s
	iters: 1910, epoch: 34 | train_loss : 0.4481
	speed: 0.039931s/iter; left time: 1220.998292s
data: {'predict': array([148.99027861, 149.02756266, 149.08045847, ..., 148.92963787,
       148.95327882, 148.91223105]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:25:19] [32mIntermediate result: 0.37638550996780396  (Index 33)[0m
Epoch: 34 | cost time: 282.42499685287476 | valid_loss: 0.37638550996780396 | valid_loss_true: 0.37573506510359067
Pretest loss in this epoch: 13.590438111527419
Adjusting learning rate of group 0 to 3.9833e-07.
	iters: 382, epoch: 35 | train_loss : 0.7298
	speed: 0.578840s/iter; left time: 17478.077169s
	iters: 764, epoch: 35 | train_loss : 0.8243
	speed: 0.039415s/iter; left time: 1175.066649s
	iters: 1146, epoch: 35 | train_loss : 0.9050
	speed: 0.040812s/iter; left time: 1201.127132s
	iters: 1528, epoch: 35 | train_loss : 0.6707
	speed: 0.040837s/iter; left time: 1186.279729s
	iters: 1910, epoch: 35 | train_loss : 0.9367
	speed: 0.040311s/iter; left time: 1155.586870s
data: {'predict': array([148.98905379, 149.02635399, 149.07934664, ..., 148.92896032,
       148.95269517, 148.91173779]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:30:23] [32mIntermediate result: 0.3752495348453522  (Index 34)[0m
Epoch: 35 | cost time: 304.3193635940552 | valid_loss: 0.3752495348453522 | valid_loss_true: 0.3745812848262377
Pretest loss in this epoch: 13.589639570181994
Early stop with best valid_loss: 0.3752495348453522
[2024-03-12 00:30:23] [32mFinal result: 0.3741592764854431[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
