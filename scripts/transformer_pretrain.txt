model_id: alumina_transformer_STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='pretrain', model_id='alumina_transformer_STANDALONE', log_path='log', checkpoints='./checkpoints/', key=None, trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset.csv', datetime_col='dtime', feature_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度', target_cols='5效5闪到调配槽后循环母液Nk,5效5闪到调配槽后循环母液ak/Rp,6效出料密度,5闪出料密度,57效循环母液进料温度,57效循环母液进料密度,冷凝器出汽压力,5效5闪蒸发母液去循环母液调配槽总流量,1效蒸发器汽温,1效蒸发器汽室压力,1效原液换热前温度,1效出料温度,2效蒸发器汽温,2效蒸发器汽室压力,2效原液换热前温度,3效蒸发器汽温,3效蒸发器汽室压力,3效原液换热前温度,4效蒸发器汽温,4效蒸发器汽室压力,4效原液换热前温度,5效蒸发器汽温,5效蒸发器汽室压力,5效原液换热前温度,5效循环母液进料流量,6效蒸发器汽温,6效蒸发器汽室压力,6效原液换热前温度,原液闪蒸器循环母液进料流量,原液闪蒸器出料温度,原液闪蒸器蒸汽压力,7效原液换热前温度,7效蒸发器汽温,7效蒸发器汽室压力,1闪出料温度,2闪出料温度,3闪出料温度,4闪出料温度,5闪出料温度,5闪去循环母液调配槽密度,5闪去循环母液调配槽流量,新蒸汽进料压力,新蒸汽进料流量,新蒸汽进料温度,循环上水温度,循环上水流量,循环下水温度,原液闪蒸器循环母液进料阀开度,1效出料阀门开度,1闪出料阀开度,3闪出料阀开度,4闪出料阀开度,2效到1效泵开度,4效到3效泵开度,5效到4效泵开度,6效出料出料泵开度', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=512, n_heads=8, e_layers=1, d_layers=1, d_ff=2048, hidden_dim=256, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, use_gpu=True, hpo='nni')
Use GPU... cuda:0
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start pretraining : alumina_transformer_STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 1.2773
	speed: 0.575056s/iter; left time: 54727.469232s
	iters: 764, epoch: 1 | train_loss : 0.8597
	speed: 0.578457s/iter; left time: 54830.234043s
	iters: 1146, epoch: 1 | train_loss : 0.8931
	speed: 0.582806s/iter; left time: 55019.802896s
	iters: 1528, epoch: 1 | train_loss : 1.4162
	speed: 0.577648s/iter; left time: 54312.209811s
	iters: 1910, epoch: 1 | train_loss : 0.7433
	speed: 0.581954s/iter; left time: 54494.787524s
testset is mistaken
Traceback (most recent call last):
  File "/workspace/qiuyunzhong/TSFramework/main_nni.py", line 108, in <module>
    main(params)
  File "/workspace/qiuyunzhong/TSFramework/main_nni.py", line 85, in main
    forecasting_model.prefit()
  File "/workspace/qiuyunzhong/TSFramework/factory/forecasting.py", line 121, in prefit
    valid_loss = self.eval(epoch)
  File "/workspace/qiuyunzhong/TSFramework/factory/forecasting.py", line 219, in eval
    eval_result = self.eval_metric(predict_outputs, target_outputs, epoch)
  File "/workspace/qiuyunzhong/TSFramework/factory/alumina_transformer_forecasting.py", line 72, in eval_metric
    raise Exception('testset is mistaken')
Exception: testset is mistaken
Truth Value Shape:
 torch.Size([146, 30, 56])
Eval Output Shape:
 torch.Size([146, 30, 1])
Traceback (most recent call last):
  File "/workspace/qiuyunzhong/TSFramework/main_nni.py", line 108, in <module>
    main(params)
  File "/workspace/qiuyunzhong/TSFramework/main_nni.py", line 85, in main
    forecasting_model.prefit()
  File "/workspace/qiuyunzhong/TSFramework/factory/forecasting.py", line 121, in prefit
    valid_loss = self.eval(epoch)
  File "/workspace/qiuyunzhong/TSFramework/factory/forecasting.py", line 219, in eval
    eval_result = self.eval_metric(predict_outputs, target_outputs, epoch)
  File "/workspace/qiuyunzhong/TSFramework/factory/alumina_transformer_forecasting.py", line 72, in eval_metric
    raise Exception('testset is mistaken')
Exception: testset is mistaken
